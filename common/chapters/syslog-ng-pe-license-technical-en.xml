<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article SYSTEM "../../xml-stylesheet/pdf/dtd/docbookx.dtd"
 [  
 <!ENTITY % entities SYSTEM "../../syslog-ng-admin-guide/syslog-ng-entities.ent">
 %entities;]> 
<article>
    <articleinfo>
        <title>The &product; License Technical Guideline</title>
        <corpname>&fullvendor;</corpname>
        <keywordset>
            <keyword>versioning policy, support period</keyword>
        </keywordset>
        <subjectset>
            <subject>
                <subjectterm>versioning policy, support period</subjectterm>
            </subject>
        </subjectset>
        <copyright>
            <year><?dbtimestamp format="Y"?></year>
            <holder>&fullvendor;</holder>
        </copyright>
        <edition>Second</edition>
        <pubdate>Publication date <?dbtimestamp?></pubdate>
        <abstract>
            <para>The &product; License Technical Guideline</para>
        </abstract>
        <mediaobject>
            <imageobject role="html">
                <imagedata format="GIF" fileref="bb_star.gif"/>
            </imageobject>
            <imageobject role="fo">
                <imagedata format="GIF" fileref="&logo;/bb_star.gif" contentwidth="7cm"/>
            </imageobject>
        </mediaobject>
    </articleinfo>
    <section>
        <title>The &product; License Technical Guideline</title>
        <para>The &product; Licenses can be limited by two factors:</para>
    <itemizedlist>
        <listitem><para>The maximum number of log source hosts (LSH), for details, see <xref linkend="limit_lsh"/>.</para></listitem>
        <listitem><para>The maximum number of used processors (CPU cores), for details, see <xref linkend="limit_cpu"/>.</para></listitem>
    </itemizedlist>
    <section id="limit_lsh">
        <title>Limit on the maximum number of Log Source Host (LSH)</title>
        <para>The first licensing option for &product; is based on the number of Log Source Hosts.</para>
        <para>A Log Source Host (LSH) is defined as any host or server computers including virtual machines, active or passive networking devices from which a &vendor; &product; in server, relay, or client mode receives log messages.</para>
        <para>The &product; application has three distinct modes of operation: Client, Server, and Relay.</para>
        <para>Client mode is defined as the mode of operation in which &product; collects local logs generated by the host and forwards them through a network connection to the central &abbrev; server, a relay, or other network destination.</para>
        <para>Relay mode is defined as the mode of operation in which &product; receives and forwards logs through the network from Log Source Hosts which are defined as host or server computers including virtual machines, active or passive networking devices.</para>
        <para>Server mode is defined as the mode of operation in which &product; acts as a central log-collecting server receiving messages through a network connection.</para>
        <example>
            <title/>
            <para>The &abbrev; is installed in server mode on a logserver</para>
            <itemizedlist>
                <listitem><para>45 servers with &abbrev; installed in client mode send logs to the logserver with &abbrev; installed</para></listitem>
                <listitem><para>45 networks devices without &abbrev; installed send log messages to the logserver with &abbrev; installed</para></listitem>
            </itemizedlist>
            <para>The &product; license for 100 LSH is required as there are 91 LSH in this configuration.</para>
        </example>
        <example>
            <title/>
            <para>The &abbrev; is installed in server mode on a logserver</para>
            <itemizedlist>
                <listitem><para>45 servers with &abbrev; installed in client mode send logs to the logserver with &abbrev; installed</para></listitem>
                <listitem><para>45 networks devices without &abbrev; installed send log messages to the logserver with &abbrev; installed</para></listitem>
                <listitem><para>100 servers with &abbrev; installed send log messages to a logserver without &abbrev; installed</para></listitem>
            </itemizedlist>
            <para>The &product; license for 200 LSH is required as there are 191 LSH in this configuration.</para>
        </example>
        <example>
            <title/>
            <para>The &abbrev; is installed in server mode on a logserver</para>
            <itemizedlist>
                <listitem><para>45 servers with &abbrev; installed in client mode send logs to the logserver with &abbrev; installed</para></listitem>
                <listitem><para>5 servers with &abbrev; installed in relay mode send logs to the logserver with &abbrev; installed</para></listitem>
                <listitem><para>45 networks devices without &abbrev; installed send log messages to the logserver with &abbrev; installed</para></listitem>
                <listitem><para>100 servers with &abbrev; installed send log messages to a logserver without &abbrev; installed</para></listitem>
            </itemizedlist>
            <para>The &product; license for 200 LSH is required as there are 196 LSH in this configuration.</para>
        </example>
        <note><para>Log Source Host based licenses have a CPU core processing limit which is explained below.</para></note>
    </section>
    
        <section id="limit_cpu">
        <title>Limit on the maximum number of used processors (CPU cores)</title>
        <para>The latest version of &product; supports multi-thread processing. The technical limitation of the maximum number of processors (CPU cores) is based on the number of worker-threads started by &product; when processing log messages. syslog-ng has a main thread that is always running, and a number of worker threads that process messages.  Certain processes run on threads, designated as writer-threads, that are independent of both main and worker-threads. Under CPU core based licensing, the maximum number of worker-threads is set in the license file. As writer-threads are initiated independently, the license limitation is not valid for them.</para>   
        <note><para>The &product; does not set any limitation on how the log server Operating System uses processors or how CPU-time is distributed between all running worker-threads. Hence, the availability of CPUs or cores in a given machine, physical or virtual, is transparent to &product;. If multi-threading is enabled, &product; will initiate worker-threads until the worker-thread limit is reached.</para></note>
        <para>In the license file required to operate &product; in server mode, the Max-processors value is listed as one of the following:</para>
        <itemizedlist>
            <listitem><para><parameter>-1</parameter>: maximum number of worker threads is unlimited</para></listitem>
            <listitem><para><parameter>0</parameter>: maximum number of worker threads is 2 (default value for LSH license)</para></listitem>
            <listitem><para><parameter>X</parameter>: maximum number of worker threads is X</para></listitem>
        </itemizedlist>
        <para>For details on multi-thread processing in &abbrev;, see <ulink url="http://www.balabit.com/sites/default/files/documents/syslog-ng-pe-4.2-guides/syslog-ng-pe-v4.2-guide-admin-en.html/index.html-single.html#chapter-multithreading">Multithreading and scaling in &abbrev;</ulink>.</para>
        <para>Licensing examples of CPU core limits:</para>
        <example>
            <title/>
            <para>The &product; is installed on a machine with 2 CPUs, each with 2 cores. Under the Log Source Host based license, 2 worker-threads are enabled. In this case, syslog-ng can run on maximum 3 cores concurrently, as it runs 1 main thread and a maximum of 2 worker-threads (depending on the configuration).</para>
        </example>
        <example>
            <title/>
            <para>The &product; is installed on a machine with 2 CPUs, each with 2 cores. Under the Log Source Host based license, 2 worker-threads are enabled. In this case, &abbrev; can run on maximum 3 cores concurrently, as it runs 1 main thread and a maximum of 2 worker-threads (depending on the configuration).</para>
        </example>
        <example>
            <title/>
            <para>The &product; is installed on a machine with 4 CPUs, each with 2 cores. Under the Log Source Host base license, 2 worker-threads are enabled. However, &abbrev; is writing messages to the logstore and SQL destinations. In this case, 5 CPU cores can be used for processing.</para>
            <itemizedlist>
                <listitem><para>1 main thread</para></listitem>
                <listitem><para>2 worker-threads (depending on configuration)</para></listitem>
                <listitem><para>1 thread for writing logstores</para></listitem>
                <listitem><para>1 thread for writing SQL destination</para></listitem>
            </itemizedlist>
            <para>Writing logstores requires 2 threads in practice: 1 worker thread to write the journal (for details on journal files, see <ulink url="http://www.balabit.com/sites/default/files/documents/syslog-ng-pe-4.2-guides/syslog-ng-pe-v4.2-guide-admin-en.html/index.html-single.html#concepts_logstore_journal">Journal files</ulink>), 1 thread independent from the worker threads to write the actual logstore.</para>
        </example>
        <example>
            <title/>
            <para>The &product; is installed on a machine with 8 CPUs, each with 2 cores. The user has purchased an 8 CPU core license. 8 worker-threads are enabled. However, &abbrev; is writing messages to the logstore and SQL destinations. In this case, 11 CPU cores can be used for processing.</para>
            <itemizedlist>
                <listitem><para>1 main thread</para></listitem>
                <listitem><para>8 worker-threads (depending on configuration)</para></listitem>
                <listitem><para>1 thread for writing logstores</para></listitem>
                <listitem><para>1 thread for writing SQL destination</para></listitem>
            </itemizedlist>
            <para>Writing logstores requires 2 threads in practice: 1 worker thread to write the journal (for details on journal files, see <ulink url="http://www.balabit.com/sites/default/files/documents/syslog-ng-pe-4.2-guides/syslog-ng-pe-v4.2-guide-admin-en.html/index.html-single.html#concepts_logstore_journal">Journal files</ulink>), 1 thread independent from the worker threads to write the actual logstore.</para>
        </example>
    </section>
    </section>
    
</article>
