<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE article PUBLIC "-//OASIS//DTD DocBook XML V4.4//EN"
 "/usr/share/xml/docbook/schema/dtd/4.4/docbookx.dtd"
  [<!ENTITY logo "http://share.balabit/tt/images/logos">
  <!ENTITY % entities SYSTEM "../syslog-ng-admin-guide/syslog-ng-entities.ent">
  %entities;
  ]
 >
<article id="syslog-ng-guide-whatsnew">
        <articleinfo>
                <title>What is new in &product; &version;</title>
                <corpname>&vendor;</corpname>
                <keywordset>
                        <keyword>&product;, &abbrev;, SSH, RDP, VNC, Telnet, Citrix ICA, 4-eyes, audit,
                                record</keyword>
                </keywordset>
                <subjectset>
                        <subject>
                                <subjectterm>&product; &version; features</subjectterm>
                        </subject>
                </subjectset>
                <copyright>
                        <year>2000-2011</year>
                        <holder>&vendor;</holder>
                </copyright>
                <edition>First</edition>
                <pubdate>January 18, 2011</pubdate>
                <mediaobject>
                        <imageobject role="html">
                                <imagedata format="GIF" fileref="bb_star.gif"/>
                        </imageobject>
                        <imageobject role="fo">
                                <imagedata format="GIF" fileref="&logo;/bb_star.gif" contentwidth="7cm"/>
                        </imageobject>
                </mediaobject>
        </articleinfo>
        <section id="preface">
                <title>Preface</title>
                <para>Welcome to &product; (&abbrev;) version &version; and thank you
                        for choosing our product. This document describes the new features and most
                        important changes since the latest release of &abbrev;. The main aim of
                        this paper is to aid system administrators in planning the migration to the
                        new version of &abbrev;. The following sections describe the news and
                        highlights of &abbrev; &version;, including &abbrev; version 3.1 and &abbrev; 3.2.</para>
                <para>This document covers the &product; &version; product. </para>
                <para>As of October 2009 &vendor; has introduced the following support policy:</para>
                <itemizedlist>
                        <listitem>
                                <para>Stable versions, denoted by a two-digit version number ending
                                        with .0 (for example 2.0 or 3.0): Stable branches are supported
                                        for at least 1 year, but no more than 2 stable versions of a
                                        product are supported at a time. Maintenance releases to the
                                        stable branch will contain only bugfixes.</para>
                        </listitem>
                        <listitem>
                                <para>Feature versions, denoted by two-digit version number ending
                                        with a non-zero version number (for example 3.1, 3.2 and onwards):
                                        Feature branches will contain enhancements and new features,
                                        presumably 1-3 new feature per release. Only the last of the
                                        feature releases is supported (for example when a new feature
                                        release comes out, the last one becomes unsupported), and
                                        the last feature release becomes the new stable
                                release.</para>
                        </listitem>
                </itemizedlist>
                <note>
                        <para>Releases of the feature branch are tested just like the stable
                                releases; they are not "unstable" development snapshots. The
                                difference between earlier major releases and current feature
                                releases is the smaller number of features contained in a release,
                                and the shorter support periods. If an unstable snapshot or
                                alpha/beta/rc release will be released for public testing, it will
                                be always marked explicitly as such.</para>
                </note>
                <warning>
                        <para>Downgrading from a feature release to an earlier (and thus
                                unsupported) feature release, or to the stable release is not
                                supported: this means that once you upgrade a system from a stable
                                release (for example 1.0) to a feature release (for example 1.1), you will have
                                to keep upgrading to the new feature releases until the next stable
                                version release (for example 2.0) is published, or risk using an
                                unsupported product.</para>
                </warning>
        </section>
        <section id="new-protocols">
                <title>New supported platforms</title>
                <para>&abbrev; now supports the following operating systems and platforms:</para>
                <itemizedlist>
                        <listitem><para>Solaris 9 on x86</para></listitem>
                        <listitem><para>Tru64 5.1b on Alpha</para></listitem>
                        <listitem><para>HP-UX 11v2 on Itanium64</para></listitem>
                        <listitem><para>Legacy Linux systems including RedHat Enterprise Linux 2 and
                                Debian potato on x86, as well as RedHat Enterprise Linux 3,
                                Debian sarge on x86 and x86_64.</para></listitem>
                        <listitem><para>AIX 6.1 on PowerPC
                        </para></listitem>
                        <listitem><para>FreeBSD 7.1 and 8.0  i386 and amd64
                        </para></listitem>
                        <listitem><para>RHEL 6.0 and SLES 11.1 on i386 and amd64 
                        </para></listitem>
                        <listitem><para>Solaris 8, Solaris 9, and Solaris 10 on SPARC64</para></listitem>
                        <listitem><para>Although not explicitly supported, but in general syslog-ng should
                                run on other legacy Linux systems as well that have at least glibc
                                version 2.1.3 (x86) or glibc version 2.3.2 (x86_64).</para></listitem>
                </itemizedlist>
        </section>
        <section>
                <title>New features</title>
                <itemizedlist>
                        <listitem><para>The extended timestamp format of Cisco IOS is now supported, including
                                sequence numbers and the NTP synchronicity indicator. The sequence
                                number of such messages is available in the $SEQNUM macro.</para></listitem>
                        <listitem><para>The syslog-ng Premium Edition 4.0 application supports client-side
                                failover to reduce the risk of message loss. For details, see Section
                                2.15, Client-side failover in The syslog-ng Premium Edition 4.0
                                Administrator Guide.</para></listitem>
                        <listitem><para>The syslog-ng Premium Edition 4.0 can handle multi-line log messages
                                (for example, Tomcat logs) more efficiently. For details, see the
                                descriptions of the multi-line-prefix() and multi-line-garbage()
                                options in Section 6.1.2, file() in The syslog-ng Premium Edition 4.0
                                Administrator Guide.</para></listitem>
                        <listitem><para>Multi-line messages can be automatically indented using the new
                                $(indent-multi-line $MESSAGE) expression in a destination template.</para></listitem>
                        <listitem><para>The lgstool application is available for Microsoft Windows platforms
                                as well. Note that the recover function of lgstool is available only
                                on Linux/UNIX. Available <ulink url="http://www.balabit.com/downloads/files/syslog-ng/premium-edition/4.0.1/setups/win32/"> here</ulink>.</para></listitem>
                        <listitem><para>The installer automatically installs the current HTML version of The
                                syslog-ng Premium Edition 4.0 Administrator Guide under the
                                /opt/syslog-ng/share/docs/admin-guide directory.</para></listitem>
                        <listitem><para>When reading a log message from file and forwarding the message using 
                                the IETF-syslog message format, syslog-ng PE automatically adds meta
                                information about the source file into the 'file@18372.4' SDATA block. 
                                The metadata includes the name and size of the file, as well as the 
                                file position the message was read from.
                        </para></listitem>
                        <listitem><para>The functionality of syslog-ng's internal MARK messages has been 
                                reworked and extended. In syslog-ng Premium Edition 4.0, it is 
                                possible to set different operation modes for MARK messages, for 
                                example, to disable them altogether, or send them only to destinations 
                                where there was no traffic, and so on. For details, see The syslog-ng 
                                Premium Edition 4.0 Administrator Guide.
                        </para></listitem>
                        <listitem><para>Pattern databases:</para>
                        <itemizedlist>
                                <listitem><para>Support for pattern database V2 and V3 formats. The V3 format has
                                        support for tagging messages, adding static name-value pairs, and
                                        also for including automatic test messages in the pattern database.
                                        See The syslog-ng 4.0 Premium Edition Administrator Guide for
                                        details.</para></listitem>
                                <listitem><para>The DOUBLE parser has been renamed to FLOAT.</para></listitem>
                                <listitem><para>The NUMBER parser can parse hexadecimal numbers as well.</para></listitem>
                                <listitem><para>It is possible to set multiple characters (a stopstring) instead of a
                                        single character in the ESTRING parser.</para></listitem>
                                <listitem><para>Log messages can be tagged. Tags can be assigned to log messages as
                                        they enter syslog-ng: either by the source driver or via patterndb.
                                        Later these tags can be used for efficient filtering using the tags()
                                        filter option. Messages are automatically tagged with the name of the
                                        source group in the ".source.name" format.</para></listitem>
                        </itemizedlist>
                        </listitem>
                        <listitem><para>Message statistics</para>
                                <itemizedlist>
                                        <listitem><para>The dynamic counters used for statistics with static ones. That way,
                                                statistics can be retained across syslog-ng reloads (but not when
                                                syslog-ng is restarted). Retaining statistics can be enabled using
                                                the 'stat_reset()' option.</para></listitem>
                                        <listitem><para>Statistics can be collected for sender hosts, sources and
                                                destinations, facilities and severities, pattern database classes and
                                                rule IDs, as well as tags.</para></listitem>
                                </itemizedlist>
                        </listitem>
                        <listitem><para>Logstore</para>
                                <itemizedlist>
                                        <listitem><para>Logstore files can be encrypted with multiple keys.</para></listitem>
                                        <listitem><para>The cipher and digest algorithms used in encrypting the logstore
                                                files can be specified.</para></listitem>
                                        <listitem><para>Timestamp policy OIDs can be specified using the 'timestamp_policy()'
                                                option. The OID is included in the timestamping request sent to the
                                                Timestamping Authority.</para></listitem>
                                        <listitem><para>The logcat utility has been renamed to lgstool.</para></listitem>
                                </itemizedlist>
                        </listitem>
                        <listitem><para>SQL destinations</para>
                                <itemizedlist>
                                        <listitem><para>Auto-incremented columns are now supported. This must be specified in
                                                the 'indexes()' option of the destination's SQL schema like:
                                                indexes("id int not null auto_increment primary key").</para></listitem>
                                        <listitem><para>SQL INSERT statements were not formatted properly when the schema
                                                used default values. This has been corrected.</para></listitem>
                                        <listitem><para>Oracle databases do not handle index names longer than 30 characters.
                                                In such cases, syslog-ng uses the MD5 hash of the name index.</para></listitem>
                                        <listitem><para>If an index used with an Oracle destination starts with a digit, an
                                                'I' character is automatically prefixed to the ID. This solves a
                                                problem experienced with Oracle 10 destinations.</para></listitem>
                                        <listitem><para>By default, syslog-ng PE commits every log message to the target 
                                                database individually. When the 'explicit-commits' option is enabled, 
                                                messages are committed in batches. This improves the performance, but 
                                                results in some latency, as the messages are not immediately sent to 
                                                the database. The size and frequency of batched commits can be set 
                                                using the 'flush_lines' and 'flush_timeout' parameters.</para></listitem>
                                        <listitem><para>If inserting a log message into the database fails for some reason, 
                                                syslog-ng PE now attempts to insert the log message again. The 
                                                maximal number of retry attempts can be set using the 
                                                'retry_sql_inserts' parameter.
                                        </para></listitem>
                                </itemizedlist>
                        </listitem>
                        <listitem><para>Loggen</para>
                                <itemizedlist><listitem><para>Loggen can send log messages can be sent using SSL connections.</para></listitem>
                                <listitem><para>Messages can be read from a text file.</para></listitem></itemizedlist></listitem>
                </itemizedlist>
                
        </section>
        
        <section>
                <title>Stability and performance improvements</title>
                <itemizedlist>
                        <listitem><para>The contents of the disk buffer are stored even if syslog-ng crashes.</para></listitem>
                        <listitem><para>Until now, if syslog-ng crashed, it resent the contents of the
                                monitored file sources. Now, the position of the last processed
                                message is stored even in case of a crash.</para></listitem>
                        <listitem><para>The syslog-ng application uses journals to keep logstore files
                                consistent even if syslog-ng crashes. For details, see 2.8.1. Journal
                                files in The syslog-ng Premium Edition 4.0 Administrator Guide.</para></listitem>
                        <listitem><para>The performance of writing messages to logstore files has
                                approximately doubled.</para></listitem>
                        <listitem><para>Non-standard and non-portable facility codes (range 10-15) are now
                                properly recognized.</para></listitem>
                        <listitem><para>The version of the syslog-ng configuration file is properly
                                recognized even if it contains whitespace between the 'version'
                                string and the version number. Comments and empty lines before the version mark are accepted.</para></listitem>
                        <listitem><para>Warnings and error messages related to logstore files include the
                                name of the affected logstore file.</para></listitem>
                </itemizedlist>
                
        </section>
        <section>
                <title>New macros and utilities</title>
                <itemizedlist>
                        <listitem><para>Two new macros ($HOUR12, $AMPM) are available to format timestamps in
                                an Oracle-compatible way. The $HOUR12 macro returns the hour of the
                                day on a 0-12 scale, while the $AMPM macro returns AM for hours before
                                mid day and PM for hours after mid day.</para></listitem>
                        <listitem><para>A new macro called $TAGS is available which expands to a list of
                                comma-separated message tags. For details on using message tags, see
                                4.6.3. Tagging messages in The syslog-ng Premium Edition 4.0
                                Administrator Guide.</para></listitem>
                        <listitem><para>A new command-line utility called syslog-ng-ctl is available for
                                the run-time control of syslog-ng. It can display message-related
                                statistics on-demand, and enable/disable the debug, verbose and
                                trace modes of syslog-ng to help troubleshooting.</para></listitem>
                        <listitem><para>A new command-line utility called 'pdbtool' is available to manage
                                pattern database files. It can convert files using the old V1 or V2
                                database format to the latest V3 format, merge multitple pattern
                                database files into one, and test patterns matching a specific
                                message. See the pdbtool manual page in Appendix A of
                                The syslog-ng 4.0 Premium Edition Administrator Guide for details.</para></listitem>
                </itemizedlist>
                
        </section>
        <section>
                <title>Other changes</title>
                <itemizedlist>
                        <listitem><para>The default port numbers used by syslog-ng have changed to make them
                                consistent with the relevant RFCs. Until now, the syslog() drivers
                                used port 601 by default. Starting with this version, syslog-ng uses
                                the following default ports for the syslog() destination and source
                                drivers:
                                <itemizedlist>
                                        <listitem><para>514 for syslog over UDP</para></listitem>
                                        <listitem><para>601 for syslog over TCP</para></listitem>
                                        <listitem><para>6514 for syslog over TLS</para></listitem>
                                </itemizedlist>

                                <warning><para>If you used the syslog() driver with the default ports, adjust your
                                configuration when upgrading to avoid data loss. </para></warning></para></listitem>
                        <listitem><para>The behavior of handling the message header has changed: earlier
                                versions stored the parsed header by default, and stored the original
                                header only if the store-legacy-msghdr flag was enabled. Starting
                                with syslog-ng PE 3.2 the original incoming header of the log message
                                is stored in the $MSGHDR macro by default, the original (3.0 and 3.1)
                                behavior of MSGHDR macro can be restored by using
                                dont-store-legacy-msghdr flag. </para></listitem>
                        <listitem><para>Added support for Cisco ASA timestamps.</para></listitem>
                        <listitem><para>The syslog-ng application keeps the message queue when receiving a
                                SIGHUP signal.</para></listitem>
                        <listitem><para>Support for PCRE regular expressions in now available on every
                                supported platform.</para></listitem>
                </itemizedlist>
                
        </section>
</article>
