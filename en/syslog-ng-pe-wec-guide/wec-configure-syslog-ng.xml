<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  [
  <!ENTITY % entities SYSTEM "../shared/syslog-ng-entities.ent">
  %entities;
  ]
 >
<procedure xml:id="wec-configure-syslog-ng" xmlns="http://docbook.org/ns/docbook">
    <title>Configure &abbrev;</title>
    <formalpara>
        <title>Prerequisites:</title>
        <para/>
    </formalpara>
    <para>&product; version 7.0.6</para>
    <formalpara>
        <title>Purpose:</title>
        <para/>
    </formalpara>
    <para>To enable &abbrev; to read and accept Windows events, you need to configure a source called <parameter>windowsevent()</parameter> for this purpose.</para>
    <formalpara>
        <title>Steps:</title>
        <para/>
    </formalpara>
    <step>
        <para>Ensure that the default <userinput>5986</userinput> TCP port is accessible from &wecabbrev;, as it is the &wec; that will initiate the event forwarding subscription toward the &abbrev; server.</para>
    </step>
    <step>
        <para>Configure the <parameter>windowsevent()</parameter> source.</para>
        <synopsis>source s_wec {
    windowsevent();
};</synopsis>
        <para>The <parameter>windowsevent()</parameter> source takes the following options:</para>
        <itemizedlist>
            <listitem>
                <para><parameter>unix-domain-socket()</parameter>: The path to the Unix domain socket to read messages from.</para>
                <para>The default value is <userinput>/opt/syslog-ng/var/run/wec.sock</userinput>.</para>
            </listitem>
            <listitem>
                <para><parameter>prefix()</parameter>: The prefix that you wish to append to the key-value pairs.</para>
                <para>The default value is <userinput>".windowsevent."</userinput>. </para>
                <para>If you want to send Windows event logs to SDATA, then set <parameter>prefix(".SDATA.")</parameter>. This can be useful, for example, when you forward Windows event logs to a &ssb;.</para>
            </listitem>
        </itemizedlist>
        <para>For more information on the <parameter>windowsevent()</parameter> source, see <olink targetdoc="syslog-ng-pe-guide-admin" targetptr="source-windowsevent"/>.</para>
    </step>
    <step>
        <para>Define a complete log path in <filename>syslog-ng.conf</filename> to enable the <parameter>windowsevent()</parameter> source, <userinput>s_wec</userinput>. Otherwise, the &wecabbrev; process will not run (connection refused).</para>
        <para>For example:</para>
        <synopsis>source s_wec {
    windowsevent();  
};

log {
  source(s_wec);

  destination {
    file("/var/log/example.log" template("$(format-json --scope dot-nv-pairs)\n"));
  };
};</synopsis>
    </step>
</procedure>
