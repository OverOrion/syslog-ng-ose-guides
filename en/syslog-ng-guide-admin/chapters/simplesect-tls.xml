<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter
 [  <!ENTITY % entities SYSTEM "../../shared/syslog-ng-entities.ent">
 %entities;]>
<simplesect xml:id="simplesect-tls" xmlns="http://docbook.org/ns/docbook">
    <title>tls-required()</title>
    <indexterm>
        <primary>tls-required()</primary>
    </indexterm>
    <indexterm>
        <primary>tls_required()</primary>
    </indexterm>
    <informaltable frame="topbot" colsep="0" rowsep="0">
        <tgroup cols="2">
            <tbody>
                <row>
                    <entry>Type: <?dbhtml bgcolor="#D4D6EB" ?>
                    </entry>
                    <entry>yes, optional, no</entry>
                </row>
                <row>
                    <entry>Default: <?dbhtml bgcolor="#D4D6EB" ?>
                    </entry>
                    <entry>optional</entry>
                </row>
            </tbody>
        </tgroup>
    </informaltable>
    <para><emphasis role="bold">Description:</emphasis> Determines whether STARTTLS is to be used during communication. If the option is set to <userinput>yes</userinput>, you must also configure the <parameter>tls()</parameter> option to specify other parameters of the TLS connection (for example, the authentication of the server and the client).</para>
    <para>The <parameter>tls-required()</parameter> option can be used in source and destination drivers as well.</para>
    <para>For example, if you configure <userinput>tls-required(yes)</userinput> on server side and <userinput>tls-required(no)</userinput> on client side, the connection is dropped. If one of them is set to <userinput>optional</userinput>, the configuration of the other side will decide if TLS is used or not. If both sides are set to <userinput>optional</userinput>, and the <parameter>tls()</parameter> option is properly configured, TLS encryption will be used. The following table summarizes the possible options and their results.</para>
    <para>Note that the various parameters of the <parameter>tls()</parameter> option are considered in the connection only if the <parameter>tls-required()</parameter> settings of the peers result in <userinput>TLS-encryption</userinput> in the following table. In other words: the <parameter>tls-required()</parameter> option of <trademark>RLTP</trademark> determines if TLS should be used at all, while the <parameter>peer-verify()</parameter> option of the <parameter>tls()</parameter>setting determines if the TLS connection can be actually established.</para>
    <informaltable>
        <tgroup cols="5">
            <colspec colnum="1" colname="col1"/>
            <colspec colnum="2" colname="col2" colwidth="0.5*"/>
            <colspec colnum="3" colname="col3"/>
            <colspec colnum="4" colname="col4"/>
            <colspec colnum="5" colname="col5"/>
            <thead>
                <row>
                    <entry namest="col1" nameend="col2" morerows="1"/>
                    <entry namest="col3" nameend="col5" align="center">tls-required() setting on the server</entry>
                </row>
                <row>
                    <entry align="center"> yes </entry>
                    <entry align="center"> no </entry>
                    <entry align="center"> optional </entry>
                </row>
            </thead>
            <tbody>
                <row>
                    <entry morerows="2" rotate="1" valign="middle">
                        <?dbhtml bgcolor="#D4D6EB" ?>
                        <?dbfo bgcolor="#D4D6EB" ?><emphasis role="bold">tls-required() setting on the client</emphasis>
                    </entry>
                    <entry align="center">
                        <?dbhtml bgcolor="#D4D6EB" ?>
                        <?dbfo bgcolor="#D4D6EB" ?><emphasis role="bold">yes</emphasis>
                    </entry>
                    <entry> TLS-encryption </entry>
                    <entry> rejected connection </entry>
                    <entry> TLS-encryption </entry>
                </row>
                <row>
                    <entry align="center">
                        <?dbhtml bgcolor="#D4D6EB" ?>
                        <?dbfo bgcolor="#D4D6EB" ?><emphasis role="bold">no</emphasis>
                    </entry>
                    <entry> rejected connection </entry>
                    <entry> unencrypted connection </entry>
                    <entry> unencrypted connection </entry>
                </row>
                <row>
                    <entry align="center">
                        <?dbhtml bgcolor="#D4D6EB" ?>
                        <?dbfo bgcolor="#D4D6EB" ?><emphasis role="bold">optional</emphasis>
                    </entry>
                    <entry> TLS-encryption </entry>
                    <entry> unencrypted connection </entry>
                    <entry> TLS-encryption if the <parameter>tls()</parameter> option is set, unencrypted connection otherwise </entry>
                </row>
            </tbody>
        </tgroup>
    </informaltable>
    <para>Setting <userinput>tls-required(optional)</userinput> on your server allows you to receive both encrypted and unencrypted connections on the same port.</para>
</simplesect>
