<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter
 [
 <!ENTITY % entities SYSTEM "../../shared/syslog-ng-entities.ent">
%entities;
]>
<section xml:id="source-windowsevent" xmlns="http://docbook.org/ns/docbook">
    <title><parameter>windowsevent</parameter>: Collecting Windows event logs</title>
    <indexterm>
        <primary>source drivers</primary>
        <secondary><parameter>windowsevent()</parameter> driver</secondary>
    </indexterm>
    <para>Event log messages collected by the &wec; for &abbrev; use this special source. To collect Windows event log messages, include this source in one of your source statements.</para>
    <para>The &wec; tool for &abbrev; collects the log messages of Windows-based hosts in Unix datagram sockets, and then forwards them to a &abbrev; server over HTTPS (using TLS encryption and mutual authentication). &abbrev; reads the log messages using the <parameter>windowsevent()</parameter> source, and then parses the logs into key-value paris using the <link linkend="xml-parser">XML parser</link>.</para>
    <para>For more information, see <olink targetdoc="syslog-ng-pe-wec-guide"/>.</para>
    <formalpara>
        <title>Declaration:</title>
        <para/>
    </formalpara>
    <synopsis>source s_wec {
    windowsevent(
      prefix(".windowsevent.")
      unix-domain-socket("`syslog-ng-root`/var/run/wec.sock")
    );
};</synopsis>
    <section xml:id="options-windowsevent">
        <title><parameter>windowsevent()</parameter> source options</title>
        <para>The <parameter>windowsevent()</parameter> driver has the following options:</para>
        <simplesect>
            <title>prefix()</title>
            <indexterm type="parameter">
                <primary>prefix()</primary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="40pt"/>
                    <tbody>
                        <row>
                            <entry>Type: <?dbhtml bgcolor="#D4D6EB" ?>
<?dbfo bgcolor="#D4D6EB" ?>
                            </entry>
                            <entry>string</entry>
                        </row>
                        <row>
                            <entry>Default: <?dbhtml bgcolor="#D4D6EB" ?>
<?dbfo bgcolor="#D4D6EB" ?>
                            </entry>
                            <entry>".windowsevent."</entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><emphasis role="bold">Description:</emphasis> The prefix that you wish to append to the key-value pairs.</para>
            <para>If you want to send Windows event logs to SDATA, then set <parameter>prefix(".SDATA.")</parameter>. This can be useful, for example, when you forward Windows event logs to a &ssb;.</para>
        </simplesect>
        <simplesect>
            <title>unix-domain-socket()</title>
            <indexterm type="parameter">
                <primary>unix-domain-socket()</primary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="40pt"/>
                    <tbody>
                        <row>
                            <entry>Type: <?dbhtml bgcolor="#D4D6EB" ?>
<?dbfo bgcolor="#D4D6EB" ?>
                            </entry>
                            <entry>string</entry>
                        </row>
                        <row>
                            <entry>Default: <?dbhtml bgcolor="#D4D6EB" ?>
<?dbfo bgcolor="#D4D6EB" ?>
                            </entry>
                            <entry>/opt/syslog-ng/var/run/wec.sock</entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><emphasis role="bold">Description:</emphasis> The path to the Unix domain socket to read messages from.</para>
        </simplesect>
    </section>
</section>
