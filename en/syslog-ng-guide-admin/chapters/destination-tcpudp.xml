<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE section
 [  <!ENTITY % entities SYSTEM "../../common/syslog-ng-entities.ent">
 %entities;]>
<section xml:id="configuring-destinations-tcpudp" xmlns="http://docbook.org/ns/docbook" version="5.0">
	<title>Sending messages to a remote log server using the legacy BSD-syslog protocol (tcp(), udp() drivers)</title>
	<indexterm>
		<primary>destination drivers</primary>
		<secondary><parameter>tcp()</parameter> driver</secondary>
	</indexterm>
	<indexterm>
		<primary>destination drivers</primary>
		<secondary><parameter>tcp6()</parameter> driver</secondary>
	</indexterm>
	<indexterm>
		<primary>destination drivers</primary>
		<secondary><parameter>udp()</parameter> driver</secondary>
	</indexterm>
	<indexterm>
		<primary>destination drivers</primary>
		<secondary><parameter>udp6()</parameter> driver</secondary>
	</indexterm>
	<xi:include href="../../common/wnt/note-use-network-driver.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
	<para>To convert your existing <parameter>tcp()</parameter>, <parameter>tcp6()</parameter>, <parameter>udp()</parameter>, <parameter>udp6()</parameter> source drivers to use the <parameter>network()</parameter> driver, see <xref linkend="destination-tcpudp-to-network"/>.</para>

	<para>The <parameter>tcp()</parameter>, <parameter>tcp6()</parameter>, <parameter>udp()</parameter>, and <parameter>udp6()</parameter> drivers send messages to another host (for example a syslog-ng server or relay) on the local intranet or internet using the UDP or TCP protocol. The <parameter>tcp6()</parameter> and <parameter>udp6()</parameter> drivers use the IPv6 network protocol.</para>
	<para>All four drivers have a single required parameter specifying the destination host address, where messages should be sent.</para>

	<para>The <parameter>udp()</parameter> and <parameter>udp6()</parameter> drivers automatically send multicast packets if a multicast destination address is specified. The <parameter>tcp()</parameter> and <parameter>tcp6()</parameter> drivers do not support multicasting.</para>
	<formalpara>
		<title>Declaration:</title>
		<para/>
	</formalpara>
	<synopsis>tcp(host [options]);
udp(host [options]);
tcp6(host [options]);
udp6(host [options]);</synopsis>
	<example xml:id="example-destination-tcpudp">
		<title>Using the tcp() driver</title>
		<synopsis>destination d_tcp { tcp("10.1.2.3" port(1999) localport(999)); };</synopsis>
		<para>If name resolution is configured, the hostname of the target server can be used as well.</para>
		<synopsis>destination d_tcp { tcp("target_host" port(1999) localport(999)); };</synopsis>
		<para>To send messages using the IETF-syslog message format without using the IETF-syslog protocol, enable the <parameter>syslog-protocol</parameter> flag:</para>
		<synopsis>destination d_tcp { tcp("10.1.2.3" port(1999) flags(syslog-protocol) ); };</synopsis>
		<para>(For details on how to use the IETF-syslog protocol, see <xref linkend="reference-destination-syslog-chapter"/>.)</para>
		<para>Using an IPv6 address:</para>
		<synopsis>tcp6("fd00:abcd:4321:2:20c:29ff:fea8:9671" port(514));</synopsis>
	</example>
	<section xml:id="reference-destination-tcpudp">
		<title>tcp(), tcp6(), udp(), and udp6() destination options</title>
		<indexterm>
			<primary>destination drivers</primary>
			<secondary><parameter>tcp()</parameter> driver</secondary>
		</indexterm>
		<indexterm>
			<primary>destination drivers</primary>
			<secondary><parameter>tcp6()</parameter> driver</secondary>
		</indexterm>
		<indexterm>
			<primary>destination drivers</primary>
			<secondary><parameter>udp()</parameter> driver</secondary>
		</indexterm>
		<indexterm>
			<primary>destination drivers</primary>
			<secondary><parameter>udp6()</parameter> driver</secondary>
		</indexterm>
		<xi:include href="../../common/wnt/note-use-network-driver.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
	<para>To convert your existing <parameter>tcp()</parameter>, <parameter>tcp6()</parameter>, <parameter>udp()</parameter>, <parameter>udp6()</parameter> source drivers to use the <parameter>network()</parameter> driver, see <xref linkend="destination-tcpudp-to-network"/>.</para>
		<para>This driver sends messages to another host on the local intranet or internet according to RFC3164 using the UDP or TCP protocol. The <parameter>tcp6()</parameter> and <parameter>udp6()</parameter> drivers use the IPv6 network protocol.</para>
		<note>
			<para>When using IPv6 destination addresses, always enclose the address between double-quotes:</para>
			<synopsis>tcp6("fd00:abcd:4321:2:20c:29ff:fea8:9671" port(514));</synopsis>
		</note>
		<para xml:id="table-destination-tcp-options">These destinations have the following options:</para>
		<simplesect condition="pe">
			<xi:include href="../../common/chunk/option-destination-diskbuffer.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
		</simplesect>
		<simplesect condition="pe">
			<xi:include href="../../common/chunk/option-destination-failover-servers.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
			<example xml:id="example-failover-server-tcp">
				<title>Specifying failover servers for tcp() destinations</title>
				<para>The following example specifies two failover servers for a simple TCP destination.</para>
				<synopsis>destination d_tcp { tcp("10.1.2.3" port(1999) failover-servers("10.2.3.4", "third-logserver.example.com"); };</synopsis>
				<para>The following example specifies a failover server for a TLS destination.</para>
				<synopsis>destination d_tcp {
         tcp("10.100.20.40" port(8989)
                 failover-servers("10.2.3.4")
                 tls(peer-verify(required-trusted)
                 ca-dir('/opt/syslog-ng/etc/keys/cas/')
                 key-file('/opt/syslog-ng/etc/keys/client-key.pem')
                 cert-file('/opt/syslog-ng/etc/keys/client-pubcert.pem')));
};</synopsis>
			</example>
		</simplesect>
		<simplesect>
			<xi:include href="../../common/chunk/option-destination-flags.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
		</simplesect>
		<simplesect>
			<xi:include href="../../common/chunk/option-destination-flush-lines.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
		</simplesect>
		<simplesect>
			<xi:include href="../../common/chunk/option-destination-flush-timeout.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
		</simplesect>
		<simplesect>
			<xi:include href="../../common/chunk/option-destination-frac-digits.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
		</simplesect>
		<simplesect>
			<xi:include href="../../common/chunk/option-ip-tos.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
		</simplesect>
		<simplesect>
			<xi:include href="../../common/chunk/option-ip-ttl.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
		</simplesect>
		<simplesect>
			<xi:include href="../../common/chunk/option-destination-keep-alive.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
		</simplesect>
		<simplesect>
			<xi:include href="../../common/chunk/option-destination-localip.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
		</simplesect>
		<simplesect>
			<xi:include href="../../common/chunk/option-destination-localport.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
		</simplesect>
		<simplesect condition="pe">
			<xi:include href="../../common/chunk/option-destination-log-disk-fifo-size.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
			<example xml:id="example-diskbuffer">
				<title>Enabling disk-based buffering</title>
				<para>The following example turns on disk-based buffering for the destination. The size of the disk buffer is 4 194 304 bytes (4 megabytes). In a worst-case situation, using the default value of the <parameter>log-msg-size()</parameter> parameter (8192 bytes), this disk buffer can store at least 512 messages. Typical log messages are about 300-500 bytes long, so a disk buffer of 4 megabytes can store over 8000 messages. Set the size of the disk buffer based on the average size and number of messages, and the longest estimated downtime of the server. </para>
				<synopsis>destination d_tcp {
				tcp("10.1.2.3" port(1999) log-disk-fifo-size(4194304)); };</synopsis>
			</example>
		</simplesect>
		<simplesect condition="pe">
			<xi:include href="../../common/chunk/option-destination-mark-freq.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
		</simplesect>
		<simplesect>
			<xi:include href="../../common/chunk/option-destination-mark-mode.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
		</simplesect>
		<simplesect>
			<xi:include href="../../common/chunk/option-destination-port.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
		</simplesect>
		<simplesect>
			<xi:include href="../../common/chunk/option-so-broadcast.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
		</simplesect>
		<simplesect>
			<xi:include href="../../common/chunk/option-source-so-keepalive.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
		</simplesect>
		<simplesect>
			<xi:include href="../../common/chunk/option-destination-so-rcvbuf.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
		</simplesect>
		<simplesect>
			<xi:include href="../../common/chunk/option-so-sndbuf.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
		</simplesect>
		<simplesect condition="pe">
			<xi:include href="../../common/chunk/option-destination-spoof-interface.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
		</simplesect>
		<simplesect>
			<xi:include href="../../common/chunk/option-destination-spoof-source.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
		</simplesect>
		<simplesect>
			<xi:include href="../../common/chunk/option-destination-suppress.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
		</simplesect>
		<simplesect>
			<xi:include href="../../common/chunk/option-destination-template.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
		</simplesect>
		<simplesect>
			<xi:include href="../../common/chunk/option-destination-template-escape.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
		</simplesect>
		<simplesect>
			<xi:include href="../../common/chunk/option-destination-throttle.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
		</simplesect>
		<simplesect>
			<xi:include href="../../common/chunk/option-destination-timezone.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
		</simplesect>
		<simplesect>
			<xi:include href="../../common/chunk/option-tls.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
		</simplesect>
		<simplesect>
			<xi:include href="../../common/chunk/option-destination-ts-format.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
		</simplesect>
	</section>
</section>
