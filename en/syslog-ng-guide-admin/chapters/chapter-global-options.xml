<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter
[
<!ENTITY % entities SYSTEM "../../shared/syslog-ng-entities.ent">
%entities;
]>
<chapter xml:id="chapter-global-options" xmlns="http://docbook.org/ns/docbook" version="5.0">
    <title>Global options of &abbrev;</title>
    <section xml:id="options">
        <title>Configuring global syslog-ng options</title>
        <indexterm significance="preferred">
            <primary>global options</primary>
        </indexterm>
        <xi:include href="../../shared/chunk/para-global-options-intro.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        <xi:include href="../../shared/chunk/synopsis-global-options.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        <xi:include href="../../shared/chunk/example-global-options.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        <para>For a detailed list of the available options, see <xref linkend="reference-options"/>. For important global options and recommendations on their use, see <xref linkend="chapter-examples"/>.</para>
    </section>
    <section xml:id="reference-options">
        <title>Global options</title>
        <indexterm>
            <primary>options</primary>
            <secondary>reference</secondary>
        </indexterm>
        <indexterm>
            <primary>global options</primary>
            <secondary>reference</secondary>
        </indexterm>
        <para>The following options can be specified in the options statement, as described in <xref linkend="options"/>.</para>
        <simplesect xml:id="global-option-bad-hostname">
            <title>bad-hostname()</title>
            <indexterm type="parameter">
                <primary>bad-hostname()</primary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="80pt"/>
                    <tbody>
                        <row>
                            <entry>Accepted values:</entry>
                            <entry>regular expression</entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry>no</entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><emphasis role="bold">Description:</emphasis> A regexp containing hostnames which should not be handled as hostnames.</para>
        </simplesect>
        <simplesect xml:id="global-options-chain-hostnames">
            <title>chain-hostnames()</title>
            <indexterm type="parameter">
                <primary>chain-hostnames()</primary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="80pt"/>
                    <tbody>
                        <row>
                            <entry>Accepted values:</entry>
                            <entry><userinput>yes</userinput> | <userinput>no</userinput>
                            </entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry><userinput>no</userinput>
                            </entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><emphasis role="bold">Description:</emphasis> Enable or disable the chained hostname format. If a client sends the log message directly to the &abbrev; server, the <parameter>chain-hostnames()</parameter> option is enabled on the server, and the client sends a hostname in the message that is different from its DNS hostname (as resolved from DNS by the &abbrev; server), then the server can append the resolved hostname to the hostname in the message (separated with a <userinput>/</userinput> character) when the message is written to the destination.</para>
            <para>For example, consider a client-server scenario with the following hostnames: <parameter>client-hostname-from-the-message</parameter>, <parameter>client-hostname-resolved-on-the-server</parameter>, <parameter>server-hostname</parameter>. The hostname of the log message written to the destination depends on the <parameter>keep-hostname()</parameter> and the <parameter>chain-hostnames()</parameter> options. How <parameter>keep-hostname()</parameter> and <parameter>chain-hostnames()</parameter> options are related is described in the following table.</para>
            <informaltable>
                <tgroup cols="4">
                    <colspec colnum="1" colname="col1"/>
                    <colspec colnum="2" colname="col2" colwidth="0.5*"/>
                    <colspec colnum="3" colname="col3"/>
                    <colspec colnum="4" colname="col4"/>
                    <thead>
                        <row>
                            <entry namest="col1" nameend="col2" morerows="1"/>
                            <entry namest="col3" nameend="col4" align="center">keep-hostname() setting on the server</entry>
                        </row>
                        <row>
                            <entry align="center"> yes </entry>
                            <entry align="center"> no </entry>
                        </row>
                    </thead>
                    <tbody>
                        <row>
                            <entry morerows="1" rotate="1" valign="middle"><emphasis role="bold">chain-hostnames() setting on the server</emphasis>
                            </entry>
                            <entry align="center"><emphasis role="bold">yes</emphasis>
                            </entry>
                            <entry> client-hostname-from-the-message </entry>
                            <entry> client-hostname-from-the-message/client-hostname-resolved-on-the-server </entry>
                        </row>
                        <row>
                            <entry align="center"><emphasis role="bold">no</emphasis>
                            </entry>
                            <entry> client-hostname-from-the-message </entry>
                            <entry> client-hostname-resolved-on-the-server </entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para>If the log message is forwarded to the &abbrev; server via a &abbrev; relay, the hostname depends on the settings of the <parameter>keep-hostname()</parameter> and the <parameter>chain-hostnames()</parameter> options both on the &abbrev; relay and the &abbrev; server.</para>
            <para>For example, consider a client-relay-server scenario with the following hostnames: <parameter>client-hostname-from-the-message</parameter>, <parameter>client-hostname-resolved-on-the-relay</parameter>, <parameter>client-hostname-resolved-on-the-server</parameter>, <parameter>relay-hostname-resolved-on-the-server</parameter>. How <parameter>keep-hostname()</parameter> and <parameter>chain-hostnames()</parameter> options are related is described in the following table.</para>
            <informaltable>
                <tgroup cols="8">
                    <colspec colnum="1" colname="col1"/>
                    <colspec colnum="2" colname="col2" colwidth="0.5*"/>
                    <colspec colnum="3" colname="col3"/>
                    <colspec colnum="4" colname="col4"/>
                    <colspec colnum="5" colname="col5"/>
                    <colspec colnum="6" colname="col6"/>
                    <colspec colnum="7" colname="col7"/>
                    <colspec colnum="8" colname="col8"/>
                    <thead>
                        <row>
                            <entry namest="col1" nameend="col4" morerows="1"/>
                            <entry namest="col5" nameend="col8" align="center">chain-hostnames() setting on the server</entry>
                        </row>
                        <row>
                            <entry namest="col5" nameend="col6" align="center">yes</entry>
                            <entry namest="col7" nameend="col8" align="center">no</entry>
                        </row>
                        <row>
                            <entry namest="col1" nameend="col4" morerows="1"/>
                            <entry namest="col5" nameend="col6" align="center">keep-hostname() setting on the server</entry>
                            <entry namest="col7" nameend="col8" align="center">keep-hostname() setting on the server</entry>
                        </row>
                        <row>
                            <entry namest="col5" nameend="col5" align="center">yes</entry>
                            <entry namest="col6" nameend="col6" align="center">no</entry>
                            <entry namest="col7" nameend="col7" align="center">yes</entry>
                            <entry namest="col8" nameend="col8" align="center">no</entry>
                        </row>
                    </thead>
                    <tbody>
                        <row>
                            <entry morerows="3" rotate="1" valign="middle"><emphasis role="bold">chain-hostnames() setting on the relay</emphasis>
                            </entry>
                            <entry morerows="1" valign="middle"><emphasis role="bold">yes</emphasis>
                            </entry>
                            <entry morerows="1" valign="middle"><emphasis role="bold">keep-hostname() setting on the relay</emphasis>
                            </entry>
                            <entry align="center"><emphasis role="bold">yes</emphasis>
                            </entry>
                            <entry> client-hostname-from-the-message </entry>
                            <entry> client-hostname-from-the-message / relay-hostname-resolved-on-the-server </entry>
                            <entry> client-hostname-from-the-message </entry>
                            <entry morerows="3"> relay-hostname-resolved-on-the-server </entry>
                        </row>
                        <row>
                            <entry align="center"><emphasis role="bold">no</emphasis>
                            </entry>
                            <entry> client-hostname-from-the-message / client-hostname-resolved-on-the-relay </entry>
                            <entry> client-hostname-from-the-message / client-hostname-resolved-on-the-relay / relay-hostname-resolved-on-the-server </entry>
                            <entry> client-hostname-from-the-message / client-hostname-resolved-on-the-relay </entry>
                        </row>
                        <row>
                            <entry morerows="1" valign="middle"><emphasis role="bold">no</emphasis>
                            </entry>
                            <entry morerows="1" valign="middle"><emphasis role="bold">keep-hostname() setting on the relay</emphasis>
                            </entry>
                            <entry align="center"><emphasis role="bold">yes</emphasis>
                            </entry>
                            <entry> client-hostname-from-the-message </entry>
                            <entry> client-hostname-from-the-message / relay-hostname-resolved-on-the-server </entry>
                            <entry> client-hostname-from-the-message </entry>
                        </row>
                        <row>
                            <entry align="center"><emphasis role="bold">no</emphasis>
                            </entry>
                            <entry> client-hostname-resolved-on-the-relay </entry>
                            <entry> client-hostname-resolved-on-the-relay / relay-hostname-resolved-on-the-server </entry>
                            <entry> client-hostname-resolved-on-the-relay </entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <xi:include href="../../shared/chunk/pe-para-chain-hostnames.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect xml:id="global-option-check-hostname">
            <title>check-hostname()</title>
            <indexterm type="parameter">
                <primary>check-hostname()</primary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="80pt"/>
                    <tbody>
                        <row>
                            <entry>Accepted values:</entry>
                            <entry><userinput>yes</userinput> | <userinput>no</userinput>
                            </entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry><userinput>no</userinput>
                            </entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><emphasis role="bold">Description:</emphasis> Enable or disable checking whether the hostname contains valid characters.</para>
        </simplesect>
        <simplesect xml:id="global-option-create-dirs">
            <title>create-dirs()</title>
            <indexterm type="parameter">
                <primary>create-dirs()</primary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="80pt"/>
                    <tbody>
                        <row>
                            <entry>Accepted values:</entry>
                            <entry><userinput>yes</userinput> | <userinput>no</userinput>
                            </entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry><userinput>no</userinput>
                            </entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><emphasis role="bold">Description:</emphasis> Enable or disable directory creation for destination files.</para>
        </simplesect>
        <simplesect xml:id="global-option-custom-domain" condition="pe">
            <title>custom-domain()</title>
            <indexterm>
                <primary>custom-domain()</primary>
            </indexterm>
            <indexterm>
                <primary>custom_domain()</primary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="80pt"/>
                    <tbody>
                        <row>
                            <entry>Accepted values:</entry>
                            <entry>string</entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry><userinput>empty string</userinput>
                            </entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><emphasis role="bold">Description:</emphasis> Use this option to specify a custom domain name that is appended after the short hostname to receive the FQDN. This option affects every outgoing message: eventlog sources, file sources, MARK messages and internal messages of &abbrev;.</para>
            <itemizedlist>
                <listitem>
                    <para>If the hostname is a short hostname, the custom domain name is appended after the hostname (for example <userinput>mypc</userinput> becomes <userinput>mypc.customcompany.local</userinput>).</para>
                </listitem>
                <listitem>
                    <para>If the hostname is an FQDN, the domain name part is replaced with the custom domain name (for example if the FQDN in the forwarded message is <userinput>mypc.mycompany.local</userinput> and the custom domain name is <userinput>customcompany.local</userinput>, the hostname in the outgoing message becomes <userinput>mypc.customcompany.local</userinput>).</para>
                </listitem>
            </itemizedlist>
        </simplesect>
        <simplesect xml:id="global-option-dir-group">
            <title>dir-group()</title>
            <indexterm type="parameter">
                <primary>dir-group()</primary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="80pt"/>
                    <tbody>
                        <row>
                            <entry>Accepted values:</entry>
                            <entry>groupid</entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry>root</entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><emphasis role="bold">Description:</emphasis> The default group for newly created directories.</para>
        </simplesect>
        <simplesect xml:id="global-option-dir-owner">
            <title>dir-owner()</title>
            <indexterm type="parameter">
                <primary>dir-owner()</primary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="80pt"/>
                    <tbody>
                        <row>
                            <entry>Accepted values:</entry>
                            <entry>userid</entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry>root</entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><emphasis role="bold">Description:</emphasis> The default owner of newly created directories.</para>
        </simplesect>
        <simplesect xml:id="global-option-dir-perm">
            <title>dir-perm()</title>
            <indexterm type="parameter">
                <primary>dir-perm()</primary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="80pt"/>
                    <tbody>
                        <row>
                            <entry>Accepted values:</entry>
                            <entry>permission value</entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry>0700</entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <xi:include href="../../shared/chunk/option-description-destination-file-dir-perm.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect xml:id="global-option-dns-cache">
            <title>dns-cache()</title>
            <indexterm type="parameter">
                <primary>dns-cache()</primary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="80pt"/>
                    <tbody>
                        <row>
                            <entry>Accepted values:</entry>
                            <entry><userinput>yes</userinput> | <userinput>no</userinput>
                            </entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry><userinput>yes</userinput>
                            </entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><emphasis role="bold">Description:</emphasis> Enable or disable DNS cache usage.</para>
            <note>
                <xi:include href="../../shared/chunk/p-keep-hostname.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
            </note>
        </simplesect>
        <simplesect xml:id="global-option-dns-cache-expired">
            <title>dns-cache-expire()</title>
            <indexterm type="parameter">
                <primary>dns-cache-expire()</primary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="80pt"/>
                    <tbody>
                        <row>
                            <entry>Accepted values:</entry>
                            <entry>number</entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry>3600</entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><emphasis role="bold">Description:</emphasis> Number of seconds while a successful lookup is cached.</para>
        </simplesect>
        <simplesect xml:id="global-option-dns-cache-expire-failed">
            <title>dns-cache-expire-failed()</title>
            <indexterm type="parameter">
                <primary>dns-cache-expire-failed()</primary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="80pt"/>
                    <tbody>
                        <row>
                            <entry>Accepted values:</entry>
                            <entry>number</entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry>60</entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><emphasis role="bold">Description:</emphasis> Number of seconds while a failed lookup is cached.</para>
        </simplesect>
        <simplesect xml:id="global-option-dns-cache-hosts">
            <title>dns-cache-hosts()</title>
            <indexterm type="parameter">
                <primary>dns-cache-hosts()</primary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="80pt"/>
                    <tbody>
                        <row>
                            <entry>Accepted values:</entry>
                            <entry>filename</entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry>unset</entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><emphasis role="bold">Description:</emphasis> Name of a file in <filename>/etc/hosts</filename> format that contains static IP-&gt;hostname mappings. Use this option to resolve hostnames locally without using a DNS. Note that any change to this file triggers a reload in syslog-ng and is instantaneous.</para>
        </simplesect>
        <simplesect xml:id="global-option-dns-cache-size">
            <title>dns-cache-size()</title>
            <indexterm type="parameter">
                <primary>dns-cache-size()</primary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="80pt"/>
                    <tbody>
                        <row>
                            <entry>Accepted values:</entry>
                            <entry>number of hostnames</entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry>1007</entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><emphasis role="bold">Description:</emphasis> Number of hostnames in the DNS cache.</para>
        </simplesect>
        <simplesect xml:id="global-option-file-template">
            <title>file-template()</title>
            <indexterm type="parameter">
                <primary>file-template()</primary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="80pt"/>
                    <tbody>
                        <row>
                            <entry>Accepted values:</entry>
                            <entry>string</entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry/>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><emphasis role="bold">Description:</emphasis> Specifies a template that file-like destinations use by default. For example:</para>
            <synopsis>template t_isostamp { template("$ISODATE $HOST $MSGHDR$MSG\n"); };

options { file-template(t_isostamp); };</synopsis>
        </simplesect>
        <simplesect xml:id="global-option-flush-lines">
            <title>flush-lines()</title>
            <indexterm type="parameter">
                <primary>flush-lines()</primary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="80pt"/>
                    <tbody>
                        <row>
                            <entry>Accepted values:</entry>
                            <entry>number</entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry>100</entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <xi:include href="../../shared/chunk/option-description-destination-flush-lines.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect xml:id="global-option-flush-timeout">
            <title>flush-timeout()</title>
            <indexterm type="parameter">
                <primary>flush-timeout()</primary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="80pt"/>
                    <tbody>
                        <row>
                            <entry>Accepted values:</entry>
                            <entry>time in milliseconds</entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry>10000</entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><emphasis role="bold">Description:</emphasis> Specifies the time syslog-ng waits for lines to accumulate in its output buffer. For more information, see the <parameter>flush-lines()</parameter> option.</para>
        </simplesect>
        <simplesect xml:id="global-option-frac-digits">
            <xi:include href="../../shared/chunk/option-destination-frac-digits.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect xml:id="global-option-group">
            <title>group()</title>
            <indexterm type="parameter">
                <primary>group()</primary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="80pt"/>
                    <tbody>
                        <row>
                            <entry>Accepted values:</entry>
                            <entry>groupid</entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry>root</entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><emphasis role="bold">Description:</emphasis> The default group of output files. By default, syslog-ng changes the privileges of accessed files (for example <filename>/dev/null</filename>) to <userinput>root.root 0600</userinput>. To disable modifying privileges, use this option with the <userinput>-1</userinput> value.</para>
        </simplesect>
        <simplesect>
            <title>jvm-options()</title>
            <indexterm type="parameter">
                <primary>jvm-options()</primary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="40pt"/>
                    <tbody>
                        <row>
                            <entry>Type:</entry>
                            <entry>list</entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry>N/A</entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><emphasis role="bold">Description:</emphasis> Specify the Java Virtual Machine (JVM) settings of your Java destination from the &abbrev; configuration file.</para>
            <para>For example:</para>
            <synopsis>jvm-options("-Xss1M -XX:+TraceClassLoading")</synopsis>
        </simplesect>
        <simplesect xml:id="global-option-keep-hostname">
            <xi:include href="../../shared/chunk/option-source-keep-hostname.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect xml:id="global-option-keep-timestamp">
            <xi:include href="../../shared/chunk/option-source-keep-timestamp.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect xml:id="global-option-log-fifo-size">
            <title>log-fifo-size()</title>
            <indexterm type="parameter">
                <primary>log-fifo-size()</primary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="80pt"/>
                    <tbody>
                        <row>
                            <entry>Accepted values:</entry>
                            <entry>number (messages)</entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry>10000</entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><emphasis role="bold">Description:</emphasis> The number of messages that the output queue can store.</para>
        </simplesect>
        <simplesect xml:id="global-option-log-msg-size">
            <title>log-msg-size()</title>
            <indexterm type="parameter">
                <primary>log-msg-size()</primary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="80pt"/>
                    <tbody>
                        <row>
                            <entry>Accepted values:</entry>
                            <entry>number (bytes)</entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry>65536</entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <xi:include href="../../shared/chunk/option-description-log-msg-size.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect>
            <title>mark() (DEPRECATED)</title>
            <indexterm type="parameter">
                <primary>mark()</primary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="80pt"/>
                    <tbody>
                        <row>
                            <entry>Accepted values:</entry>
                            <entry>number</entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry>1200</entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><emphasis role="bold">Description:</emphasis> The <parameter>mark-freq()</parameter> option is an alias for the deprecated <parameter>mark()</parameter> option. This is retained for compatibility with syslog-ng version 1.6.x.</para>
        </simplesect>
        <simplesect xml:id="global-options-mark-freq">
            <xi:include href="../../shared/chunk/option-destination-mark-freq.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect xml:id="global-options-mark-mode">
            <xi:include href="../../shared/chunk/option-destination-mark-mode.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect xml:id="global-option-normalize-hostnames">
            <xi:include href="../../shared/chunk/option-source-normalize-hostnames.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect xml:id="global-option-typecasting-on-error">
            <title>on-error()</title>
            <indexterm type="parameter">
                <primary>on-error()</primary>
            </indexterm>
            <indexterm>
                <primary>type-casting</primary>
            </indexterm>
            <indexterm>
                <primary>typecasting</primary>
                <see>type-casting</see>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="80pt"/>
                    <tbody>
                        <row>
                            <entry>Accepted values:</entry>
                            <entry>
                                <para>drop-message|drop-property|fallback-to-string|</para>
                                <para>silently-drop-message|silently-drop-property|silently-fallback-to-string</para>
                            </entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry>drop-message</entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <xi:include href="../../shared/chunk/option-description-destination-on-error.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect xml:id="global-option-owner">
            <title>owner()</title>
            <indexterm type="parameter">
                <primary>owner()</primary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="80pt"/>
                    <tbody>
                        <row>
                            <entry>Accepted values:</entry>
                            <entry>userid</entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry>root</entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><emphasis role="bold">Description:</emphasis> The default owner of output files. By default, syslog-ng changes the privileges of accessed files (for example <filename>/dev/null</filename>) to <userinput>root.root 0600</userinput>. To disable modifying privileges, use this option with the <userinput>-1</userinput> value.</para>
        </simplesect>
        <simplesect xml:id="global-option-pass-unix-credentials">
            <title>pass-unix-credentials()</title>
            <indexterm type="parameter">
                <primary>pass-unix-credentials()</primary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="80pt"/>
                    <tbody>
                        <row>
                            <entry>Accepted values:</entry>
                            <entry>yes|no</entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry>yes</entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><emphasis role="bold">Description:</emphasis> Enable &abbrev; to collect UNIX credential information (that is, the PID, user ID, and group of the sender process) for messages received using UNIX domain sockets. Available only in <phrase condition="pe">&product; 5 F5</phrase><phrase condition="ose">&product; 3.7</phrase> and later. Note that collecting UNIX credential information from sockets in high traffic environments can be resource intensive, therefore <parameter>pass-unix-credentials()</parameter> can be disabled globally, or separately for each source.</para>
        </simplesect>
        <simplesect xml:id="global-option-perm">
            <title>perm()</title>
            <indexterm type="parameter">
                <primary>perm()</primary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="80pt"/>
                    <tbody>
                        <row>
                            <entry>Accepted values:</entry>
                            <entry>permission value</entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry>0600</entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><emphasis role="bold">Description:</emphasis> The default permission for output files. By default, syslog-ng changes the privileges of accessed files (for example <filename>/dev/null</filename>) to <userinput>root.root 0600</userinput>. To disable modifying privileges, use this option with the <userinput>-1</userinput> value.</para>
        </simplesect>
        <simplesect xml:id="global-option-proto-template">
            <title>proto-template()</title>
            <indexterm type="parameter">
                <primary>proto-template()</primary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="80pt"/>
                    <tbody>
                        <row>
                            <entry>Accepted values:</entry>
                            <entry>name of a template</entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry>The default message format of the used protocol</entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><emphasis role="bold">Description:</emphasis> Specifies a template that protocol-like destinations (for example, network() and syslog()) use by default. For example:</para>
            <synopsis>template t_isostamp { template("$ISODATE $HOST $MSGHDR$MSG\n"); };

options { proto-template(t_isostamp); };</synopsis>
        </simplesect>
        <simplesect xml:id="global-option-recv-time-zone">
            <title>recv-time-zone()</title>
            <indexterm type="parameter">
                <primary>recv-time-zone()</primary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="80pt"/>
                    <tbody>
                        <row>
                            <entry>Accepted values:</entry>
                            <entry>name of the timezone, or the timezone offset</entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry>local timezone</entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><emphasis role="bold">Description:</emphasis> Specifies the time zone associated with the incoming messages, if not specified otherwise in the message or in the source driver. For details, see also <xref linkend="timezone-handling"/> and <xref linkend="example-timezones"/>.</para>
            <xi:include href="../../shared/chunk/para-timezone-format.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect xml:id="global-option-send-time-zone">
            <xi:include href="../../shared/chunk/option-destination-send-timezone.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
            <xi:include href="../../shared/chunk/para-timezone-format.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect xml:id="global-option-stats-freq">
            <title>stats-freq()</title>
            <indexterm type="parameter">
                <primary>stats-freq()</primary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="80pt"/>
                    <tbody>
                        <row>
                            <entry>Accepted values:</entry>
                            <entry>number</entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry>600</entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><emphasis role="bold">Description:</emphasis> The period between two STATS messages in seconds. STATS are log messages sent by syslog-ng, containing statistics about dropped log messages. Set to <userinput>0</userinput> to disable the STATS messages.</para>
        </simplesect>
        <simplesect xml:id="global-option-stats-level">
            <title>stats-level()</title>
            <indexterm type="parameter">
                <primary>stats-level()</primary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="80pt"/>
                    <tbody>
                        <row>
                            <entry>Accepted values:</entry>
                            <entry><userinput>0</userinput> | <userinput>1</userinput> | <userinput>2</userinput> | <userinput>3</userinput>
                            </entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry><userinput>0</userinput>
                            </entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><emphasis role="bold">Description:</emphasis> Specifies the detail of statistics syslog-ng collects about the processed messages.</para>
            <xi:include href="../../shared/chunk/option-stats-level-description.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
            <para>Note that level 2 and 3 increase the memory requirements and CPU load. For details on message statistics, see <xref linkend="chapter-log-statistics"/>.</para>
        </simplesect>
        <simplesect xml:id="global-option-stats-max-dynamics">
            <title>stats-max-dynamics()</title>
            <indexterm type="parameter">
                <primary>stats-max-dynamics()</primary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="80pt"/>
                    <tbody>
                        <row>
                            <entry>Accepted values:</entry>
                            <entry>number</entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry><userinput>N/A</userinput>
                            </entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><emphasis role="bold">Description:</emphasis> To avoid performance issues or even overloading &abbrev; (for example, if a script starts to send logs from different IP addresses to &abbrev;), you might want to limit the number of registered dynamic counters in the message statistics. For details on message statistics, see <xref linkend="chapter-log-statistics"/>.</para>
            <itemizedlist>
                <listitem>
                    <formalpara>
                        <title>Unlimited dynamic counters:</title>
                        <para/>
                    </formalpara>
                    <para>If you do not use this option, dynamic counters will not be limited. This can be useful in cases where you are extremely interested in dynamic counters, and use these statistics extensively.</para>
                    <warning>
                        <para>In some cases, there might be even millions of dynamic counters</para>
                    </warning>
                </listitem>
                <listitem>
                    <formalpara>
                        <title>Limited dynamic counter clusters:</title>
                        <para/>
                    </formalpara>
                    <para>To limit dynamic counters, enter a number, and only a maximum of &lt;number&gt; counters will be registered in the statistics.</para>
                    <para>In practice, this means dynamic counter clusters. A program name produces one dynamic counter cluster, that can include several counters, such as <parameter>processed</parameter>, <parameter>stamp</parameter>, and so on.</para>
                    <example>
                        <title>Limiting dynamic counter clusters 1</title>
                        <para>If you set <parameter>stats-max-dynamics()</parameter> to <userinput>1</userinput>, and 2 programs send messages, only one of these programs will be tracked in the dynamic counters, but it will have more than one counters.</para>
                    </example>
                    <example>
                        <title>Limiting dynamic counter clusters 2</title>
                        <para>If you have 500 clients, and set <parameter>stats-max-dynamics()</parameter> to <userinput>1000</userinput>, you will have enough number of counters reserved for these clients, but at the same time, you limit the use of your resources and therefore protect your system from being overloaded.</para>
                    </example>
                </listitem>
                <listitem>
                    <formalpara>
                        <title>No dynamic counters:</title>
                        <para/>
                    </formalpara>
                    <para>To disable dynamic counters completely, set the value of this option to <userinput>0</userinput>. This is the recommended value if you do not use statistics, or if you are not interested in dynamic counters in particular (for example, the number of logs arriving from programs).</para>
                </listitem>
            </itemizedlist>
            <note>
                <para>If you set a lower value to <parameter>stats-max-dynamics()</parameter> (or, any limiting value, if this option has not been configured before) and restart &abbrev;, the changes will only be applied after <parameter>stats-freq()</parameter> time has passed. That is, the previously allocated dynamic clusters will only be removed after this time.</para>
            </note>
        </simplesect>
        <simplesect>
            <title>sync() or sync-freq() (DEPRECATED)</title>
            <indexterm type="parameter">
                <primary>sync() or sync-freq() (DEPRECATED)</primary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="80pt"/>
                    <tbody>
                        <row>
                            <entry>Accepted values:</entry>
                            <entry>number (messages)</entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry>0</entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><emphasis role="bold">Description:</emphasis> Obsolete aliases for <parameter>flush-lines()</parameter></para>
        </simplesect>
        <simplesect xml:id="global-option-threaded">
            <title>threaded()</title>
            <indexterm type="parameter">
                <primary>threaded()</primary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="80pt"/>
                    <tbody>
                        <row>
                            <entry>Accepted values:</entry>
                            <entry>yes|no</entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry>yes</entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><emphasis role="bold">Description:</emphasis> Enable &abbrev; to run in multithreaded mode and use multiple CPUs. Available only in <phrase condition="pe">&product; 4 F1</phrase><phrase condition="ose">&product; 3.3</phrase> and later. Note that setting <userinput>threaded(no)</userinput> does not mean that &abbrev; will use only a single thread. For details, see <xref linkend="chapter-multithreading"/>.</para>
        </simplesect>
        <simplesect xml:id="global-option-time-reap">
            <title>time-reap()</title>
            <indexterm type="parameter">
                <primary>time-reap()</primary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="80pt"/>
                    <tbody>
                        <row>
                            <entry>Accepted values:</entry>
                            <entry>number (seconds)</entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry>60</entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><emphasis role="bold">Description:</emphasis> The time to wait in seconds before an idle destination file is closed. Note that only destination files having macros in their filenames are closed automatically.</para>
        </simplesect>
        <simplesect xml:id="global-option-time-reopen">
            <xi:include href="../../shared/chunk/option-source-time-reopen.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect>
            <title>time-sleep() (DEPRECATED)</title>
            <indexterm type="parameter">
                <primary>time-sleep() (DEPRECATED)</primary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="80pt"/>
                    <tbody>
                        <row>
                            <entry>Accepted values:</entry>
                            <entry>number</entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry>0</entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><emphasis role="bold">Description:</emphasis> The time to wait in milliseconds between each invocation of the <parameter>poll()</parameter> iteration.</para>
        </simplesect>
        <simplesect xml:id="global-option-use-timezone">
            <xi:include href="../../shared/chunk/option-destination-timezone.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect xml:id="global-option-ts-format">
            <title>ts-format()</title>
            <indexterm type="parameter">
                <primary>ts-format()</primary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="80pt"/>
                    <tbody>
                        <row>
                            <entry>Accepted values:</entry>
                            <entry><userinput>rfc3164</userinput> | <userinput>bsd</userinput> | <userinput>rfc3339</userinput> | <userinput>iso</userinput>
                            </entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry><userinput>rfc3164</userinput>
                            </entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><emphasis role="bold">Description:</emphasis> Specifies the timestamp format used when syslog-ng itself formats a timestamp and nothing else specifies a format (for example: <parameter>STAMP</parameter> macros, internal messages, messages without original timestamps). For details, see also <xref linkend="example-timezones"/>.</para>
            <para>By default, timestamps include only seconds. To include fractions of a second (for example, milliseconds) use the <parameter>frac-digits()</parameter> option. For details, see <xref linkend="global-option-frac-digits"/>.</para>
            <xi:include href="../../shared/wnt/note-ts-format-network.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect xml:id="global-option-use-dns">
            <xi:include href="../../shared/chunk/option-source-use-dns.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect xml:id="global-option-use-fqdn">
            <xi:include href="../../shared/chunk/option-source-use-fqdn.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect xml:id="global-option-use-rcptid">
            <title>use-rcptid()<phrase condition="pe"> (DEPRECATED)</phrase>
            </title>
            <indexterm type="parameter">
                <primary>use-rcptid()</primary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="80pt"/>
                    <tbody>
                        <row>
                            <entry>Accepted values:</entry>
                            <entry>yes | no</entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry>no</entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <xi:include href="../../shared/chunk/option-description-use-rcptid.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
            <para condition="pe">This option is deprecated, use the <parameter>use-uniqid()</parameter> option instead.</para>
        </simplesect>
        <simplesect xml:id="global-use-uniqid">
            <title>use-uniqid()</title>
            <indexterm>
                <primary>use-uniqid()</primary>
            </indexterm>
            <indexterm>
                <primary>use_uniqid()</primary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="80pt"/>
                    <tbody>
                        <row>
                            <entry>Accepted values:</entry>
                            <entry><userinput>yes</userinput> | <userinput>no</userinput>
                            </entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry><userinput>no</userinput>
                            </entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><emphasis role="bold">Description:</emphasis> This option enables generating a globally unique ID. It is generated from the HOSTID and the RCPTID in the format of HOSTID@RCPTID. It has a fixed length: 16+@+8 characters. You can include the unique ID in the message by using the macro. For details, see <xref linkend="macro-uniqid"/>.</para>
            <para>Enabling this option automatically generates the HOSTID. The HOSTID is a persistent, 32-bits-long cryptographically secure pseudo random number, that belongs to the host that the syslog-ng is running on. If the persist file is damaged, the HOSTID might change.</para>
            <para>Enabling this option automatically enables the RCPTID functionality. For details, see <xref linkend="macro-rcptid"/></para>
        </simplesect>
    </section>
</chapter>
