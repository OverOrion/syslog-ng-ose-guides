<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE article
  [<!ENTITY % entities SYSTEM "../common/syslog-ng-entities.ent">
  %entities;
  ]
 >
<article xml:id="syslog-ng-guide-quickstart-win" xml:lang="en-EN" xmlns="http://docbook.org/ns/docbook" version="5.0">
	<info>
		<title>Windows Quick Start Guide for &product; &version;</title>
		<orgname>&vendor;</orgname>
		<keywordset>
			<keyword>syslog-ng, &product;, &abbrev;, logging, log collection, syslog-ng documentation, syslog-ng configuration, syslog-ng manual, system logging, eventlog collection, central log server, log management, &docgithash;</keyword>
		</keywordset>
		<subjectset>
			<subject>
				<subjectterm>&product; &version; features</subjectterm>
			</subject>
		</subjectset>
		<xi:include href="../xml-stylesheet/common/common.xml" xmlns:xi="http://www.w3.org/2001/XInclude" xpointer="common_copyright_bb"/>
		<pubdate><?dbtimestamp?></pubdate>
		<xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="../xml-stylesheet/common/common.xml" xpointer="common_logo_bb"/>
	</info>

	<section xml:id="introduction">
		<title>Introduction</title>
		<para>The syslog-ng application is a flexible and highly scalable system logging application that is ideal for creating centralized and trusted logging solutions.</para>
		<xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="../syslog-ng-guide-admin/chapters/chapter-concepts.xml" xpointer="para-philosophy-intro"/>

		<section xml:id="modes_of_operation">
			<title>Modes of operation</title>
			<xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="../syslog-ng-guide-admin/chapters/chapter-concepts.xml" xpointer="para-modes-of-operation-intro"/>
			<xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="../syslog-ng-guide-admin/chapters/chapter-concepts.xml" xpointer="para-modes-of-operation-server"/>
			<xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="../syslog-ng-guide-admin/chapters/chapter-concepts.xml" xpointer="para-modes-of-operation-client"/>
			<xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="../syslog-ng-guide-admin/chapters/chapter-concepts.xml" xpointer="para-modes-of-operation-relay"/>
		</section>

		<section xml:id="scope">
			<title>Scope</title>
			<para>This guide contains instructions for setting up &product; (PE) for evaluation. It covers server and client installation on Windows.</para>
			<para>In addition, basic configuration options are provided for reliable transfer protocol, macros in filenames, storing messages in encrypted files, and configuring syslog-ng to act as a relay.</para>
			<para>This guide is intended as a quick introduction. For evaluating syslog-ng PE in scenarios which exceed the single client-to-server complexity (including, but not limited to usage in domain hosts, complex networks, productive environments, and load testing), refer to <olink targetdoc="syslog-ng-pe-guide-admin"/>.</para>
		</section>

		<section xml:id="supported_platforms">
			<title>Supported platforms</title>
			<para>The list of supported platforms is available here:</para>
			<para><link xmlns:ns1="http://www.w3.org/1999/xlink" ns1:href="http://www.balabit.com/network-security/syslog-ng/central-syslog-server/specifications">http://www.balabit.com/network-security/syslog-ng/central-syslog-server/specifications</link>.</para>
			<para>For Windows, the &agent; application is available for all Windows releases starting with Windows XP, including the 64-bit versions of the operating system.</para>
		</section>
	</section>

	<section xml:id="installation">
		<title>Installation</title>

		<section xml:id="prerequisites">
			<title>Prerequisites</title>
			<para>The installers are available via <link xmlns:ns1="http://www.w3.org/1999/xlink" ns1:href="https://www.balabit.com/mybalabit">MyBalabit</link>. In addition to the installers, a <link xmlns:ns1="http://www.w3.org/1999/xlink" ns1:href="https://www.balabit.com/mybalabit/company-licenses">valid license</link> is required to install the &abbrev; server. Contact your sales representative for access and license files.</para>

			<section xml:id="downloading_linux">
				<title>Downloading the server installer</title>
				<para>Obtain the &product; installer from MyBalaBit:</para>

				<procedure>
					<step>
						<para>Navigate to <guimenu>Downloads > All files > syslog-ng> premium edition</guimenu></para>
					</step>
					<step>
						<para>Choose the latest available version (5.0.2 is used as an example)</para>
					</step>
					<step>
						<para>Download the 32-bit or 64-bit installer, depending on your server's architecture:</para>
						<itemizedlist>
							<listitem>
								<para>For the 32-bit installer, navigate to <guimenu>Setups > win32</guimenu> and download <filename>syslog-ng-premium-edition-5.0.2-win32.exe</filename></para>
							</listitem>
							<listitem>
								<para>For the 64-bit installer, navigate to <guimenu>Setups > win64</guimenu> and download <filename>syslog-ng-premium-edition-5.0.2-win64.exe</filename></para>
							</listitem>
						</itemizedlist>
					</step>
				</procedure>

				<para>The binaries include all required libraries and dependencies of syslog-ng. These components are installed in the <filename>C:\Program Files\syslog-ng</filename> directory by default.</para>
				<para>The installer can reuse existing configuration and license files. Following installation, sample configuration files are also available in the <filename>etc</filename> subfolder.</para>
			</section>

			<section xml:id="downloading_windows">
				<title>Downloading the client installer (Windows Agent)</title>
				<para>Obtain the &agent; installer from MyBalaBit:</para>

				<procedure>
					<step>
						<para>Navigate to <guimenu>Downloads > All files > syslog-ng > syslog-ng-agent</guimenu></para>
					</step>
					<step>
						<para>Choose the latest available version (5.0.2 is used as an example)</para>
					</step>
					<step>
						<para>Navigate to <guimenu>Setups > win32</guimenu> and download <filename>syslog-ng-agent-5.0.2-setup.exe</filename></para>
					</step>
				</procedure>

				<para>Regardless of the path name, the installer contains both the 32-bit and the 64-bit binaries.</para>
				<formalpara xml:id="installing_dotnet">
					<title>Installing the .NET framework</title>
					<para/>
				</formalpara>
				<para>The installer requires Microsoft .NET framework. The following versions of the framework are supported: 2.0, 3.0, or 3.5. This affects the following platforms:</para>
				<itemizedlist>
					<listitem>
						<para>Windows XP and Windows 2003 Server: These platforms either do not contain the .NET framework, or come with an earlier, unsupported version. Install any of the supported versions.</para>
					</listitem>
					<listitem>
						<para>Windows 8 and Windows 2012 Server: These platforms come with a more recent version of the .NET framework. To ensure compatibility, install any of the supported versions.</para>
					</listitem>
				</itemizedlist>
				<para>For further details, see <olink targetdoc="syslog-ng-windows-agent-guide-admin" targetptr="windows-install-standalone"/>.</para>
			</section>
		</section>

		<section xml:id="installing_server">
			<title>Installing the &abbrev; server</title>
			<para>Running &product; in server mode requires a license file. The license determines how many individual hosts can connect to the server. You can obtain the license from your sales representative.</para>

			<procedure>
				<step>
					<para>Copy the installer and <filename>license.txt</filename> file to the server</para>
				</step>
				<step>
					<para>Execute the installer</para>
				</step>
				<step>
					<para>Select <guimenu>Next</guimenu> on the Welcome screen, and accept the EULA</para>
				</step>
				<step>
					<para>Select <guimenu>Install syslog-ng Premium Edition</guimenu> and choose <guimenu>Next</guimenu> (the other option will simply unpack syslog-ng without registering it as a service)</para>
				</step>
				<step>
					<para>Keep the default installation path and choose <guimenu>Next</guimenu></para>
				</step>
				<step>
					<para>Navigate to the license file (<filename>license.txt</filename>) and choose <guimenu>Next</guimenu></para>
				</step>
				<step>
					<para>A pre-prepared configuration is displayed. Skip this step by choosing <guimenu>Next</guimenu></para>
				</step>
				<step>
					<para>Click <guimenu>Install</guimenu> to start the installation. Wait for the process to finish, then choose <guimenu>Close</guimenu></para>
				</step>
				<step>
					<para>Configure the server using the sample configuration file:</para>
					<substeps>
						<step>
							<para>Navigate to <filename>C:\Program Files\syslog-ng\etc</filename></para>
						</step>
						<step>
							<para>Copy <filename>syslog-ng-eventlog-to-file-sample.conf</filename> to <filename>syslog-ng.conf</filename></para>
						</step>
						<step>
							<para>The sample configuration file is configured to store logs in the <filename>C:\tmp</filename> temporary folder.</para>
							<para>Create the <filename>C:\tmp</filename> temporary folder for storing logs.</para>
						</step>
					</substeps>
				</step>
				<step>
					<para>Start syslog-ng as an administrator:</para>
					<substeps>
						<step>
							<para>In the Start menu, navigate to <guimenu>All Programs > syslog-ng Premium Edition</guimenu></para>
						</step>
						<step>
							<para>Right-click <filename>syslog-ng</filename>, and choose <guimenu>Run as Administrator</guimenu></para>
							<formalpara>
								<title>Expected outcome</title>
								<para/>
							</formalpara>
							<para>&abbrev; is started, and logs appear in <filename>C:\tmp\eventlog_to_file_example.txt</filename>.</para>
						</step>
					</substeps>
				</step>
				<step>
					<para><emphasis>Validating the installation</emphasis></para>
					<para>Test remote logging:</para>
					<substeps>
						<step>
							<para>Log out and log in again</para>
						</step>
						<step>
							<para>Verify that the logout and login events are in the, and they include your username</para>
							<formalpara>
								<title>Expected outcome</title>
								<para/>
							</formalpara>
							<para>Your username is displayed in the log.</para>
						</step>
					</substeps>
				</step>
			</procedure>
		</section>

		<section>
			<title>Preparing for the client installation</title>
			<para>To verify the client installation, a new network source must be added to the &abbrev; configuration:</para>

			<procedure>
				<step>
					<para>Open the <filename>C:\Program Files\syslog-ng\etc\syslog-ng.conf</filename> configuration file for editing</para>
				</step>
				<step>
					<para>Add the following snippet to the end of the file:</para>
					<synopsis>source s_network {
	syslog();
};
	
destination d_nettofile {
	file('C:\tmp\tcp_to_file_example.txt' flags(no-multi-line));
};
	
log {
	source(s_network);
	destination(d_nettofile);
	flags(flow-control);
};</synopsis>
				</step>
				<step>
					<para>Save the configuration file</para>
				</step>
				<step>
					<para>Restart the syslog-ng service</para>
				</step>
			</procedure>

		</section>

		<section xml:id="installing_client">
			<title>Installing the &abbrev; client</title>
			<para>The following instructions describe the standalone installation, which is configured locally. For more advanced installation options (using domain group policies, installing by group policy), refer to <olink targetdoc="syslog-ng-windows-agent-guide-admin"/>.</para>
			<para>No license file is required to run &abbrev; in client mode.</para>

			<procedure>
				<step>
					<para>Execute the downloaded binary.</para>
				</step>
				<step>
					<para>Accept the EULA.</para>
				</step>
				<step>
					<para>Select the destination folder for &agent;.</para>
				</step>
				<step>
					<para>Choose <guimenu>Stand alone mode</guimenu>.</para>
				</step>
				<step>
					<para>The installer generates a simple configuration. Enter the destination IP of the &abbrev; server:</para>
					<substeps>
						<step>
							<para>Select <guimenu>Destinations</guimenu></para>
						</step>
						<step>
							<para>Double-click <guimenu>Add new server</guimenu></para>
						</step>
						<step>
							<para>Enter the server's IP address</para>
						</step>
						<step>
							<para>Change the port number to <parameter>601</parameter></para>
						</step>
						<step>
							<para>Click <guimenu>OK</guimenu></para>
						</step>
					</substeps>
				</step>
				<step>
					<para>Close the configuration window to finish installation.</para>
				</step>
				<step>
					<para><emphasis>Validating the installation</emphasis></para>
					<para>Test remote logging:</para>
					<substeps>
						<step>
							<para>Log out and back in on the Windows client</para>
						</step>
						<step>
							<para>Verify the server log. On the &abbrev; server, enter the following command:</para>
							<para><command>tail /var/log/messages</command></para>
							<formalpara>
								<title>Expected outcome</title>
								<para/>
							</formalpara>
							<para>The logout and login events are displayed in the log.</para>
						</step>
					</substeps>
				</step>
			</procedure>

		</section>
	</section>

	<section xml:id="configuration">
		<title>Configuring &abbrev;</title>
		<para>The syslog-ng application reads incoming messages and forwards them to the selected <emphasis>destinations</emphasis>. The syslog-ng application can receive messages from files, remote hosts, and other <emphasis>sources</emphasis>.</para>
		<para>Log messages enter syslog-ng in one of the defined sources, and are sent to one or more <emphasis>destinations</emphasis>.</para>
		<para>Sources and destinations are independent objects; <emphasis>log paths</emphasis> define what syslog-ng does with a message, connecting the sources to the destinations. A log path consists of one or more sources and one or more destinations; messages arriving from a source are sent to every destination listed in the log path. A log path defined in syslog-ng is called a <emphasis>log statement</emphasis>.</para>
		<para>There are many other optional elements, like filters, parsers, etc., but in this guide we focus on a core syslog-ng feature: reliable logging.</para>

		<section xml:id="rltp">
			<title><trademark>Reliable Transfer Protocol</trademark></title>

			<xi:include href="../syslog-ng-guide-admin/chapters/chapter-rltp.xml" xpointer="para-rltp-intro" xmlns:xi="http://www.w3.org/2001/XInclude"/>

			<para>To make RLTP work, you have to enable it on the server and on all participating clients as well. In the following example, a minimum working configuration is provided; for additional options, including TLS configuration, refer to <olink targetdoc="syslog-ng-pe-guide-admin" targetptr="chapter-rltp"/>.</para>

			<section xml:id="configuring_server_for_rltp">
				<title>Configuring the syslog-ng PE server for RLTP</title>

				<procedure>
					<step>
						<para>Open the C:\Program Files\syslog-ng\etc\syslog-ng.conf configuration file for editing</para>
					</step>
					<step>
						<para>Replace the line <computeroutput>syslog();</computeroutput> with the following:</para>
						<synopsis>syslog(port(601) transport(rltp(tls_required(no))));</synopsis>
					</step>
					<step>
						<para>Save the file and restart syslog-ng</para>
						<formalpara>
							<title>Expected outcome</title>
							<para/>
						</formalpara>
						<para>The syslog source now supports RLTP protocol as a transport, without TLS support. Declaring the port is necessary, as there is no default port number for RLTP transport.</para>
					</step>
				</procedure>
			</section>

			<section xml:id="configuring_windows_client_for_rltp">
				<title>Configuring syslog-ng Windows clients for RLTP</title>

				<procedure>
					<step>
						<para>From the Start menu, launch the <guimenu>Configure syslog-ng Agent for Windows</guimenu> application</para>
					</step>
					<step>
						<para>Select <guimenu>Destinations</guimenu></para>
					</step>
					<step>
						<para>Right-click the previously configured destination, and choose <guimenu>Properties</guimenu></para>
					</step>
					<step>
						<para>Enable <guimenu>RLTP</guimenu></para>
					</step>
					<step>
						<para>Choose <guimenu>OK</guimenu> to save your changes, and exit from the configuration interface</para>
					</step>
					<step>
						<para>Restart syslog-ng Agent for the new configuration settings to take effect</para>
						<note>
							<para>To restart services, you need Administrator privileges. If you use the <guimenu>Stop syslog-ng Agent</guimenu> and <guimenu>Start syslog-ng Agent</guimenu> options from the Start Menu, remember to right-click and choose the <guimenu>Run as Administrator</guimenu> option.</para>
						</note>
					</step>
				</procedure>
				
				<para>Remote logging can be tested the same way as described in <xref linkend="installing_client"/>.</para>
			</section>
		</section>

		<section xml:id="macros">
			<title>Macros in file names</title>
			<para>On servers where logs of many clients are retained for extended periods of time, log files are usually stored under a directory hierarchy. To help sort incoming log messages to such hierarchies, syslog-ng supports the use of macros. Depending on the needs of your organization, date, source host, or combined solutions can be used.</para>
			<para>In the following example, the file destination on the server is modified to also write messages into a directory structure under <filename>/var/log</filename>, where the first level is the year, the second level is the week of the year, followed by a file name based on the sending host.</para>

			<procedure>
				<step>
					<para>Open the C:\Program Files\syslog-ng\etc\syslog-ng.conf configuration file for editing</para>
				</step>
				<step>
					<para>Locate the block starting with <computeroutput>destination d_nettofile</computeroutput></para>
				</step>
				<step>
					<para>Modify it to look like the following line:</para>
					<synopsis>destination d_nettofile {
	file('C:\tmp\tcp_to_file_example.txt' flags(no-multi-line));
	file('C:\tmp\$YEAR\$WEEK\$HOST-messages' flags(no-multi-line) create_dirs(yes));
};</synopsis>
				</step>
				<step>
					<para>Save the file and restart syslog-ng</para>
					<note>
						<para>Collecting to <filename>C:\tmp\tcp_to_file_example.txt</filename> is left there for your convenience, it can be safely removed. If the related configuration item is removed, the file stays in the folder, but will not be updated.</para>
					</note>
				</step>
			</procedure>
			<para>For more details on macros available in syslog-ng, refer to <olink targetdoc="syslog-ng-pe-guide-admin"/>.</para>
		</section>

		<section xml:id="storing_encryption">
			<title>Storing messages in encrypted files</title>
			<para>The &abbrev; application can store log messages securely in encrypted, compressed and timestamped binary files. Timestamps can be requested from an external Timestamping Authority (TSA).</para>
			<para>Logstore files consist of individual chunks, every chunk can be encrypted, compressed, and timestamped separately. Chunks contain compressed log messages and header information needed for retrieving messages from the logstore file.</para>
			<para>The &abbrev; application generates an SHA-1 hash for every chunk to verify the integrity of the chunk. The hashes of the chunks are chained together to prevent injecting chunks into the logstore file. The &abbrev; application can encrypt the logstore using various algorithms, using the aes128 encryption algorithm in CBC mode and the hmac-sha1 hashing (HMAC) algorithm as default.</para>
			<para>In the following example, a simple logstore destination is added which stores logs with maximum compression.</para>

			<procedure>
				<step>
					<para>Open the C:\Program Files\syslog-ng\etc\syslog-ng.conf configuration file for editing</para>
				</step>
				<step>
					<para>Locate the block starting with <computeroutput>destination d_nettofile</computeroutput></para>
				</step>
				<step>
					<para>Add the following line right below:</para>
					<synopsis>destination d_logstore {
	logstore('C:\tmp\messages.lgs' compress(9) );
};</synopsis>
				</step>
				<step>
					<para>Locate the line containing <computeroutput>destination(d_nettofile)</computeroutput></para>
				</step>
				<step>
					<para>Add the following line right below:</para>
					<synopsis>destination(d_logstore)</synopsis>
				</step>
				<step>
					<para>Restart syslog-ng for the configuration changes to take effect</para>
				</step>
				<step>
					<para><emphasis>Validating the changes</emphasis></para>
					<para>You can verify that logs are arriving to the logstore using the following command:</para>
					<para><command>"C:\Program Files\syslog-ng\bin\lgstool.exe” cat C:\tmp\messages.lgs</command></para>
				</step>
			</procedure>
		</section>

	</section>
	<section xml:id="further-information">
		<title>Further information</title>
		<xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="../xml-stylesheet/common/about-balabit.xml"/>
		<xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="../xml-stylesheet/common/common.xml" xpointer="common_preface_contact_sales"/>
	</section>

</article>
