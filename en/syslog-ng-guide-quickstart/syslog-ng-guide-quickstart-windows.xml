<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE article
  [<!ENTITY % entities SYSTEM "../common/syslog-ng-entities.ent">
  %entities;
  ]
 >
<article xml:id="syslog-ng-guide-quickstart-win" xml:lang="en-EN" xmlns="http://docbook.org/ns/docbook" version="5.0">
    <info>
        <title>Windows Quick Start Guide for &product; &version;</title>
        <orgname>&vendor;</orgname>
        <keywordset>
            <keyword>syslog-ng, &product;, &abbrev;, logging, log collection, syslog-ng documentation, syslog-ng configuration, syslog-ng manual, system logging, eventlog collection, central log server, log management, &docgithash;</keyword>
        </keywordset>
        <subjectset>
            <subject>
                <subjectterm>&product; &version; features</subjectterm>
            </subject>
        </subjectset>
        <xi:include href="../xml-stylesheet/common/common.xml" xmlns:xi="http://www.w3.org/2001/XInclude" xpointer="common_copyright_bb"/>
        <pubdate><?dbtimestamp?></pubdate>
        <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="../xml-stylesheet/common/common.xml" xpointer="common_logo_bb"/>
    </info>

    <section xml:id="introduction">
        <title>Introduction</title>
        <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="chunk/topic-introduction.xml"/>
        <formalpara>
            <title>&product; on Windows:</title>
            <para/>
        </formalpara>
        <para>The &product; on Windows application has most of the features of its Linux/UNIX counterpart, and comes with the same text-based configuration. For limitations specific to the platform, refer to:</para>
        <para><link xmlns:ns1="http://www.w3.org/1999/xlink" ns1:href="https://www.balabit.com/sites/default/files/documents/syslog-ng-pe-5.0-guides/en/syslog-ng-pe-v5.0-guide-admin/html-single/index.html#windows-limitations">The syslog-ng Premium Edition Administrator Guide</link></para>
        <para>Three distinct operation scenarios are available:</para>
        <itemizedlist>
            <listitem>
                <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="../syslog-ng-guide-admin/chapters/chapter-concepts.xml" xpointer="para-modes-of-operation-client"/>
            </listitem>
            <listitem>
                <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="../syslog-ng-guide-admin/chapters/chapter-concepts.xml" xpointer="para-modes-of-operation-server"/>
            </listitem>
            <listitem>
                <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="../syslog-ng-guide-admin/chapters/chapter-concepts.xml" xpointer="para-modes-of-operation-relay"/>
            </listitem>
        </itemizedlist>
        <para>The application determines the mode of operation automatically, based on the license and the configuration file.</para>
        <formalpara>
            <title>syslog-ng Agent for Windows:</title>
            <para/>
        </formalpara>
        <para>A lightweight client alternative to &product; for Windows, the syslog-ng Agent for Windows application can collect and forward log messages to a remote server. It comes with a graphical user interface, and it's easier to deploy to a large number of machines.</para>

        <section xml:id="scope">
            <title>Scope</title>
            <para>This guide contains instructions for setting up &product; (PE) as server and &agent; as client on Windows for evaluation.</para>
            <para>In addition, basic configuration options are provided for reliable transfer protocol, macros in filenames, and storing messages in encrypted files.</para>
            <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="chunk/para-evaluation.xml"/>
        </section>

        <section xml:id="supported_platforms">
            <title>Supported platforms</title>
            <para>The list of supported platforms for syslog-ng PE for Windows and &agent; is available here:</para>
            <para><link xmlns:ns1="http://www.w3.org/1999/xlink" ns1:href="https://www.balabit.com/network-security/syslog-ng/central-syslog-server/specifications">https://www.balabit.com/network-security/syslog-ng/central-syslog-server/specifications</link>.</para>
        </section>
    </section>

    <section xml:id="installation">
        <title>Installation</title>

        <procedure xml:id="installing_server_windowsx">
            <title>Downloading the server installer</title>
            <formalpara>
                <title>Purpose:</title>
                <para/>
            </formalpara>
            <para>To obtain the &product; installer from MyBalaBit, complete the following steps:</para>
            <formalpara>
                <title>Prerequisites:</title>
                <para/>
            </formalpara>
            <para>The installers are available via <link xmlns:ns1="http://www.w3.org/1999/xlink" ns1:href="https://www.balabit.com/mybalabit">MyBalabit</link>. In addition to the installers, a <link xmlns:ns1="http://www.w3.org/1999/xlink" ns1:href="https://www.balabit.com/mybalabit/company-licenses">valid license</link> is required to install the &abbrev; server. Contact your sales representative for access and license files.</para>
            <formalpara>
                <title>Steps:</title>
                <para/>
            </formalpara>
            <step>
                <para>Navigate to <guimenu>Downloads > All files > syslog-ng> premium edition</guimenu></para>
            </step>
            <step>
                <para>Choose the latest available version (5.0.2 is used as an example)</para>
            </step>
            <step>
                <para>Download the 32-bit or 64-bit installer, depending on your server's architecture:</para>
                <itemizedlist>
                    <listitem>
                        <para>For the 32-bit installer, navigate to <guimenu>Setups > win32</guimenu> and download <filename>syslog-ng-premium-edition-5.0.2-win32.exe</filename></para>
                    </listitem>
                    <listitem>
                        <para>For the 64-bit installer, navigate to <guimenu>Setups > win64</guimenu> and download <filename>syslog-ng-premium-edition-5.0.2-win64.exe</filename></para>
                    </listitem>
                </itemizedlist>
                <para>The binaries include all required libraries and dependencies of syslog-ng. These components are installed in the <filename>C:\Program Files\syslog-ng</filename> directory by default.</para>
                <para>The installer can reuse existing configuration and license files. Following installation, sample configuration files are also available in the <filename>etc</filename> subfolder.</para>
            </step>
        </procedure>

        <procedure xml:id="installing_client_windows">
            <title>Downloading the client installer (Windows Agent)</title>
            <formalpara>
                <title>Purpose:</title>
                <para/>
            </formalpara>
            <para>To obtain the &agent; installer from MyBalaBit, complete the following steps:</para>
            <formalpara>
                <title>Prerequisites:</title>
                <para/>
            </formalpara>
            <para>The installers are available via <link xmlns:ns1="http://www.w3.org/1999/xlink" ns1:href="https://www.balabit.com/mybalabit">MyBalabit</link>. In addition to the installers, a <link xmlns:ns1="http://www.w3.org/1999/xlink" ns1:href="https://www.balabit.com/mybalabit/company-licenses">valid license</link> is required to install the &abbrev; server. Contact your sales representative for access and license files.</para>
            <formalpara>
                <title>Steps:</title>
                <para/>
            </formalpara>
            <step>
                <para>Navigate to <guimenu>Downloads > All files > syslog-ng > syslog-ng-agent</guimenu></para>
            </step>
            <step>
                <para>Choose the latest available version (5.0.2 is used as an example)</para>
            </step>
            <step>
                <para>Navigate to <guimenu>Setups > win32</guimenu> and download <filename>syslog-ng-agent-5.0.2-setup.exe</filename></para>
                <para>Regardless of the path name, the installer contains both the 32-bit and the 64-bit binaries.</para>
            </step>
            <step>
                <formalpara xml:id="installing_dotnet">
                    <title>Installing the .NET framework</title>
                    <para/>
                </formalpara>
                <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="chunk/topic-dotnet.xml"/>
            </step>
        </procedure>

        <procedure xml:id="installing_server">
            <title>Installing &product; for Windows as server</title>
            <formalpara>
                <title>Purpose:</title>
                <para/>
            </formalpara>
            <para>To install &product; for Windows as server, complete the following steps:</para>
            <formalpara>
                <title>Prerequisites:</title>
                <para/>
            </formalpara>
            <para>Running &abbrev; in server mode requires a license file. The license determines how many individual hosts can connect to the server. You can obtain the license from your sales representative.</para>
            <formalpara>
                <title>Steps:</title>
                <para/>
            </formalpara>
            <step>
                <para>Copy the installer and <filename>license.txt</filename> file to the server</para>
            </step>
            <step>
                <para>Execute the installer</para>
            </step>
            <step>
                <para>Select <guimenu>Next</guimenu> on the Welcome screen, and accept the EULA</para>
            </step>
            <step>
                <para>Select <guimenu>Install syslog-ng Premium Edition</guimenu> and choose <guimenu>Next</guimenu> (the other option will simply unpack syslog-ng without registering it as a service)</para>
            </step>
            <step>
                <para>Keep the default installation path and choose <guimenu>Next</guimenu></para>
            </step>
            <step>
                <para>Navigate to the license file (<filename>license.txt</filename>) and choose <guimenu>Next</guimenu></para>
            </step>
            <step>
                <para>At this point, existing configurations could be loaded from backup. Skip this step by choosing <guimenu>Next</guimenu></para>
            </step>
            <step>
                <para>Click <guimenu>Install</guimenu> to start the installation. Wait for the process to finish, then choose <guimenu>Close</guimenu></para>
            </step>
            <step>
                <para>Configure the server using the sample configuration file:</para>
                <substeps>
                    <step>
                        <para>Navigate to <filename>C:\Program Files\syslog-ng\etc</filename></para>
                    </step>
                    <step>
                        <para>Copy <filename>syslog-ng-eventlog-to-file-sample.conf</filename> to <filename>syslog-ng.conf</filename></para>
                    </step>
                    <step>
                        <para>The sample configuration file is configured to store logs in the <filename>C:\tmp</filename> temporary folder.</para>
                        <para>Create the <filename>C:\tmp</filename> temporary folder for storing logs.</para>
                    </step>
                </substeps>
            </step>
            <step>
                <para>Start syslog-ng as an administrator:</para>
                <substeps>
                    <step>
                        <para>In the Start menu, navigate to <guimenu>All Programs > syslog-ng Premium Edition</guimenu></para>
                    </step>
                    <step>
                        <para>Right-click <guimenu>Start syslog-ng</guimenu>, and choose <guimenu>Run as Administrator</guimenu></para>
                        <formalpara>
                            <title>Expected outcome</title>
                            <para/>
                        </formalpara>
                        <para>&abbrev; is started, and logs appear in <filename>C:\tmp\eventlog_to_file_example.txt</filename>.</para>
                    </step>
                </substeps>
            </step>
        </procedure>

        <procedure>
            <title>Preparing for the client installation</title>
            <formalpara>
                <title>Purpose:</title>
                <para/>
            </formalpara>
            <para>To verify the client installation, a new network source must be added to the &abbrev; configuration:</para>
            <formalpara>
                <title>Steps:</title>
                <para/>
            </formalpara>
            <step>
                <para>Open the <filename>C:\Program Files\syslog-ng\etc\syslog-ng.conf</filename> configuration file for editing</para>
            </step>
            <step>
                <para>Add the following snippet to the end of the file:</para>
                <synopsis>source s_network {
	syslog();
};

destination d_nettofile {
	file('C:\tmp\tcp_to_file_example.txt' flags(no-multi-line));
};

log {
	source(s_network);
	destination(d_nettofile);
	flags(flow-control);
};</synopsis>
            </step>
            <step>
                <para>Save the configuration file</para>
            </step>
            <step>
                <para>Restart the syslog-ng service</para>
            </step>
        </procedure>

        <procedure xml:id="installing_client">
            <title>Installing the &agent; client</title>
            <formalpara>
                <title>Purpose:</title>
                <para/>
            </formalpara>
            <para>The following instructions describe the standalone installation, which is configured locally. For more advanced installation options (using domain group policies, installing by group policy), refer to <olink targetdoc="syslog-ng-windows-agent-guide-admin"/>.</para>
            <formalpara>
                <title>Prerequisites:</title>
                <para/>
            </formalpara>
            <para>No license file is required to run &abbrev; in client mode.</para>
            <formalpara>
                <title>Steps:</title>
                <para/>
            </formalpara>
            <step>
                <para>Execute the downloaded binary.</para>
            </step>
            <step>
                <para>Accept the EULA.</para>
            </step>
            <step>
                <para>Select the destination folder for &agent;.</para>
            </step>
            <step>
                <para>Choose <guimenu>Stand alone mode</guimenu>.</para>
            </step>
            <step>
                <para>The installer generates a simple configuration. Enter the destination IP of the &abbrev; server:</para>
                <substeps>
                    <step>
                        <para>Select <guimenu>Destinations</guimenu></para>
                    </step>
                    <step>
                        <para>Double-click <guimenu>Add new server</guimenu></para>
                    </step>
                    <step>
                        <para>Enter the server's IP address</para>
                    </step>
                    <step>
                        <para>Change the port number to <parameter>601</parameter></para>
                    </step>
                    <step>
                        <para>Click <guimenu>OK</guimenu></para>
                    </step>
                </substeps>
            </step>
            <step>
                <para>Close the configuration window to finish installation.</para>
            </step>
            <step>
                <para><emphasis>Validating the installation</emphasis></para>
                <para>Test remote logging:</para>
                <substeps>
                    <step>
                        <para>Log out and back in on the Windows client</para>
                    </step>
                    <step>
                        <para>Verify the server log.</para>
                        <formalpara>
                            <title>Expected outcome</title>
                            <para/>
                        </formalpara>
                        <para>On the &abbrev; server, the logout and login events are displayed in the <filename>C:\tmp\tcp_to_file_example.txt</filename> logfile.</para>
                    </step>
                </substeps>
            </step>
        </procedure>
    </section>

    <section xml:id="configuration">
        <title>Configuring &product;</title>
        <para>The syslog-ng application reads incoming messages and forwards them to the selected <emphasis>destinations</emphasis>. The syslog-ng application can receive messages from files, remote hosts, and other <emphasis>sources</emphasis>.</para>
        <para>Log messages enter syslog-ng in one of the defined sources, and are sent to one or more <emphasis>destinations</emphasis>.</para>
        <para>Sources and destinations are independent objects; <emphasis>log paths</emphasis> define what syslog-ng does with a message, connecting the sources to the destinations. A log path consists of one or more sources and one or more destinations; messages arriving from a source are sent to every destination listed in the log path. A log path defined in syslog-ng is called a <emphasis>log statement</emphasis>.</para>
        <para>There are many other optional elements, like filters, parsers, etc., but in this guide we focus on a core syslog-ng feature: reliable logging.</para>
        <note>
            <para>The syslog-ng PE server for Windows can also be installed without a license file. In this case it will act as a client or relay (depending on configuration), but with some additional features compared to syslog-ng Agent for Windows. These features include disk buffer and relay.</para>
            <para>Consult the documentation or a pre-sales engineer for further details.</para>
        </note>

        <section xml:id="rltp">
            <title><trademark>Reliable Transfer Protocol</trademark></title>

            <xi:include href="../syslog-ng-guide-admin/chapters/chapter-rltp.xml" xpointer="para-rltp-intro" xmlns:xi="http://www.w3.org/2001/XInclude"/>

            <para>To make RLTP work, you have to enable it on the server and on all participating clients as well. In the following example, a minimum working configuration is provided; for additional options, including TLS configuration, refer to <olink targetdoc="syslog-ng-pe-guide-admin" targetptr="chapter-rltp"/>.</para>

            <procedure xml:id="configuring_server_for_rltp">
                <title>Configuring the syslog-ng PE server for RLTP</title>
                <formalpara>
                    <title>Purpose:</title>
                    <para/>
                </formalpara>
                <para>To configure the &product; server for RLTP, complete the following steps:</para>
                <formalpara>
                    <title>Steps:</title>
                    <para/>
                </formalpara>
                <step>
                    <para>Open the C:\Program Files\syslog-ng\etc\syslog-ng.conf configuration file for editing</para>
                </step>
                <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="chunk/step-rltp-server.xml"/>
            </procedure>

            <procedure xml:id="configuring_windows_client_for_rltp">
                <title>Configuring &agent; clients for RLTP</title>
                <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="chunk/step-rltp-windows-client.xml"/>
                <step>
                    <para>Remote logging can be tested the same way as described in <xref linkend="installing_client_windows"/>.</para>
                </step>
            </procedure>

        </section>

        <procedure xml:id="macros">
            <title>Macros in file names</title>
            <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="chunk/step-macros-filenames.xml"/>
            <formalpara>
                <title>Steps:</title>
                <para/>
            </formalpara>
            <step>
                <para>Open the C:\Program Files\syslog-ng\etc\syslog-ng.conf configuration file for editing</para>
            </step>
            <step>
                <para>Locate the block starting with <computeroutput>destination d_nettofile</computeroutput></para>
            </step>
            <step>
                <para>Modify it to look like the following line:</para>
                <synopsis>destination d_nettofile {
	file('C:\tmp\tcp_to_file_example.txt' flags(no-multi-line));
	file('C:\tmp\$YEAR\$WEEK\$HOST-messages' flags(no-multi-line) create-dirs(yes));
};</synopsis>
                <para>For more details on macros available in syslog-ng, refer to <olink targetdoc="syslog-ng-pe-guide-admin"/>.</para>
            </step>
            <step>
                <para>Save the file and restart syslog-ng</para>
                <note>
                    <para>Collecting to <filename>C:\tmp\tcp_to_file_example.txt</filename> is left there for your convenience, it can be safely removed. If the related configuration item is removed, the file stays in the folder, but will not be updated.</para>
                </note>
            </step>
        </procedure>

        <procedure xml:id="storing_encryption">
            <title>Storing messages in encrypted files</title>
            <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="chunk/step-encrypted-files.xml"/>
            <formalpara>
                <title>Steps:</title>
                <para/>
            </formalpara>
            <step>
                <para>Open the C:\Program Files\syslog-ng\etc\syslog-ng.conf configuration file for editing</para>
            </step>
            <step>
                <para>Locate the block starting with <computeroutput>destination d_nettofile</computeroutput></para>
            </step>
            <step>
                <para>Add the following line right below:</para>
                <synopsis>destination d_logstore {
	logstore('C:\tmp\messages.lgs' compress(9) );
};</synopsis>
            </step>
            <step>
                <para>Locate the line containing <computeroutput>destination(d_nettofile)</computeroutput></para>
            </step>
            <step>
                <para>Add the following line right below:</para>
                <synopsis>destination(d_logstore)</synopsis>
            </step>
            <step>
                <para>Restart syslog-ng for the configuration changes to take effect</para>
            </step>
            <step>
                <para><emphasis>Validating the changes</emphasis></para>
                <para>You can verify that logs are arriving to the logstore using the following command:</para>
                <para><command>"C:\Program Files\syslog-ng\bin\lgstool.exe” cat C:\tmp\messages.lgs</command></para>
            </step>
        </procedure>

    </section>
    <section xml:id="further-information">
        <title>Further information</title>
        <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="../xml-stylesheet/common/about-balabit.xml"/>
        <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="../xml-stylesheet/common/common.xml" xpointer="common_preface_contact_sales"/>
    </section>

</article>
