<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE article
  [<!ENTITY % entities SYSTEM "../common/syslog-ng-entities.ent">
  %entities;
  ]
 >
<article xml:id="syslog-ng-guide-quickstart" xml:lang="en-EN" xmlns="http://docbook.org/ns/docbook" version="5.0">
    <info>
        <title>Quick Start Guide for &product; &version;</title>
        <orgname>&vendor;</orgname>
        <keywordset>
            <keyword>syslog-ng, &product;, &abbrev;, logging, log collection, syslog-ng documentation, syslog-ng configuration, syslog-ng manual, system logging, eventlog collection, central log server, log management, &docgithash;</keyword>
        </keywordset>
        <subjectset>
            <subject>
                <subjectterm>&product; &version; features</subjectterm>
            </subject>
        </subjectset>
        <xi:include href="../xml-stylesheet/common/common.xml" xmlns:xi="http://www.w3.org/2001/XInclude" xpointer="common_copyright_bb"/>
        <pubdate>
<?dbtimestamp?>
        </pubdate>
        <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="../xml-stylesheet/common/common.xml" xpointer="common_logo_bb"/>
    </info>
    <section xml:id="introduction">
        <title>Introduction</title>
        <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="chunk/topic-introduction.xml"/>
        <section xml:id="modes_of_operation">
            <title>Modes of operation</title>
            <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="../syslog-ng-guide-admin/chapters/chapter-concepts.xml" xpointer="para-modes-of-operation-intro"/>
            <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="../syslog-ng-guide-admin/chapters/chapter-concepts.xml" xpointer="para-modes-of-operation-server"/>
            <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="../syslog-ng-guide-admin/chapters/chapter-concepts.xml" xpointer="para-modes-of-operation-client"/>
            <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="../syslog-ng-guide-admin/chapters/chapter-concepts.xml" xpointer="para-modes-of-operation-relay"/>
        </section>
        <section xml:id="scope">
            <title>Scope</title>
            <para>This guide contains instructions for setting up &product; (PE) for evaluation. It covers server installation in Linux, and client installation on Linux and Windows.</para>
            <para>In addition, basic configuration options are provided for disk buffering, reliable transfer protocol, macros in filenames, storing messages in encrypted files, and configuring syslog-ng to act as a relay.</para>
            <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="chunk/para-evaluation.xml"/>
        </section>
        <section xml:id="supported_platforms">
            <title>Supported platforms</title>
            <para>The list of supported platforms is available here:</para>
            <para><link xmlns:ns1="http://www.w3.org/1999/xlink" ns1:href="https://www.balabit.com/network-security/syslog-ng/central-syslog-server/specifications">https://www.balabit.com/network-security/syslog-ng/central-syslog-server/specifications</link>.</para>
            <para>For Windows, the &agent; application is available for all Windows releases starting with Windows XP, including the 64-bit versions of the operating system.</para>
        </section>
    </section>
    <section xml:id="installation">
        <title>Installation</title>
        <procedure xml:id="downloading_linux">
            <title>Downloading the Linux installer (server and client)</title>
            <formalpara>
                <title>Purpose:</title>
                <para/>
            </formalpara>
            <para>To obtain the &product; installer from MyBalabit, complete the following steps:</para>
            <formalpara>
                <title>Prerequisites:</title>
                <para/>
            </formalpara>
            <para>The installers are available through <link xmlns:ns1="http://www.w3.org/1999/xlink" ns1:href="https://my.balabit.com/">MyBalabit</link>. In addition to the installers, a <link xmlns:ns1="http://www.w3.org/1999/xlink" ns1:href="https://my.balabit.com/">valid license</link> is required to install the &abbrev; server. Contact your sales representative for access and license files.</para>
            <formalpara>
                <title>Steps:</title>
                <para/>
            </formalpara>
            <step>
                <para>Navigate to <guimenu>DOWNLOAD > SYSLOG-NG PREMIUM EDITION</guimenu>.</para>
            </step>
            <step>
                <para>Choose the latest available version (6.0.3 is used as an example):</para>
                <itemizedlist>
                    <listitem><para><emphasis>Release:</emphasis> 6 LTS</para></listitem>
                    <listitem><para><emphasis>Component:</emphasis> syslog-ng Premium Edition</para></listitem>
                    <listitem><para><emphasis>Revision:</emphasis> 6.0.3</para></listitem>
                    <listitem><para><emphasis>Platform:</emphasis> Linux glibc2.3.6</para></listitem>
                </itemizedlist>
            </step>
            <step>
                <para>Click <guimenu>linux glibc2.3.6 amd64</guimenu> to download <filename>syslog-ng-premium-edition-6.0.3-linux-glibc2.3.6-amd64.run</filename>.</para>
                <para>The binaries include all required libraries and dependencies of syslog-ng. These components are installed in the <filename>/opt/syslog-ng</filename> directory.</para>
                <para>The installer can reuse existing configuration and license files, and also generate a simple configuration during the installation process. The syslog-ng.conf file is generated into the <filename>/opt/syslog-ng/etc/</filename> directory during the installatino process. If you want to reuse an existing syslog-ng.conf configuration file, the installer will search for it under this directory as well.</para>
                <note>
                    <para>Existing syslog implementations on Linux systems are replaced during installation.</para>
                </note>
            </step>
        </procedure>
        <procedure xml:id="downloading_windows">
            <title>Downloading the Windows installer (client only)</title>
            <formalpara>
                <title>Purpose:</title>
                <para/>
            </formalpara>
            <para>To obtain the &agent; installer from MyBalaBit, complete the following steps:</para>
            <formalpara>
                <title>Prerequisites:</title>
                <para/>
            </formalpara>
            <para>The installers are available via <link xmlns:ns1="http://www.w3.org/1999/xlink" ns1:href="https://my.balabit.com/">MyBalabit</link>. In addition to the installers, a <link xmlns:ns1="http://www.w3.org/1999/xlink" ns1:href="https://my.balabit.com/">valid license</link> is required to install the &abbrev; server. Contact your sales representative for access and license files.</para>
            <formalpara>
                <title>Steps:</title>
                <para/>
            </formalpara>
            <step>
                <para>Navigate to <guimenu>DOWNLOAD > SYSLOG-NG PREMIUM EDITION</guimenu>.</para>
            </step>
            <step>
                <para>Choose the latest available version (5.0.14 is used as an example):</para>
                <itemizedlist>
                    <listitem><para><emphasis>Release:</emphasis> 5 LTS</para></listitem>
                    <listitem><para><emphasis>Component:</emphasis> syslog-ng Agent for Windows</para></listitem>
                    <listitem><para><emphasis>Revision:</emphasis> 5.0.14</para></listitem>
                    <listitem><para><emphasis>Platform:</emphasis> Select your platform</para></listitem>
                </itemizedlist>
            </step>
            <step>
                <para>Navigate to <guimenu>Setups > win32</guimenu></para>
            </step>
            <step>
                <para>Download <filename>syslog-ng-agent-5.0.14-setup.exe</filename></para>
                <para>Regardless of the path name, the installer contains both the 32-bit and the 64-bit binaries.</para>
            </step>
            <step>
                <formalpara xml:id="installing_dotnet">
                    <title>Installing the .NET framework (Windows only)</title>
                    <para/>
                </formalpara>
                <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="chunk/topic-dotnet.xml"/>
            </step>
        </procedure>
        <procedure xml:id="installing_server_linux">
            <title>Installing the &abbrev; server on Linux</title>
            <formalpara>
                <title>Purpose:</title>
                <para/>
            </formalpara>
            <para>To install &product; in server mode, complete the following steps:</para>
            <formalpara>
                <title>Prerequisites:</title>
                <para/>
            </formalpara>
            <para>Running &product; in server mode requires a license file. The license determines how many individual hosts can connect to the server. You can obtain the license from your sales representative.</para>
            <formalpara>
                <title>Steps:</title>
                <para/>
            </formalpara>
            <step>
                <para>Copy the installer and <filename>license.txt</filename> file to the server.</para>
            </step>
            <step>
                <para>Execute the following command as root:</para>
                <para><command>sh syslog-ng-premium-edition-6.0.3-linux-glibc2.3.6-amd64.run</command></para>
            </step>
            <step>
                <para>Select <guimenu>Continue</guimenu> on the Welcome screen, and accept the EULA.</para>
            </step>
            <step>
                <para>Verify that the system summary is correct.</para>
                <para>If false information is displayed, your platform might not be supported. Abort installation, and if necessary, contact &vendor; for support.</para>
            </step>
            <step>
                <para>Keep the default installation path and register your installation. Existing syslog implementations on the system are replaced.</para>
            </step>
            <step>
                <para>Provide the full path to the license file (<filename>license.txt</filename>).</para>
            </step>
            <step>
                <para>The installer generates a very basic configuration file during the installation process. Provide the following answers for the following questions:</para>
                <informaltable>
                    <tgroup cols="2">
                        <thead>
                            <row>
                                <entry>Question</entry>
                                <entry>Answer</entry>
                            </row>
                        </thead>
                        <tbody>
                            <row>
                                <entry><emphasis>Remote source</emphasis>: Do you want to receive log messages from the network?</entry>
                                <entry><userinput>Yes</userinput></entry>
                            </row>
                            <row>
                                <entry><emphasis>Remote destination</emphasis>: To forward your log messages to a remote server, enter the address of the server and select OK. Otherwise, select Skip.</entry>
                                <entry><userinput>Skip</userinput></entry>
                            </row>
                        </tbody>
                    </tgroup>
                </informaltable>
                <formalpara>
                    <title>Expected outcome</title>
                    <para/>
                </formalpara>
                <para>The installer stops the previously installed syslog implementation, and starts the &abbrev; server.</para>
            </step>
            <step>
                <para><emphasis>Validating the installation</emphasis></para>
                <para>Test local logging:</para>
                <substeps>
                    <step>
                        <para>Issue the following commands as root:</para>
                        <para><command>logger test message</command></para>
                    </step>
                    <step>
                        <para>Verify local log with the following command:</para>
                        <para><command>tail /var/log/messages</command></para>
                        <formalpara>
                            <title>Expected outcome</title>
                            <para/>
                        </formalpara>
                        <para>The<computeroutput>test message</computeroutput>line is displayed in the log.</para>
                    </step>
                </substeps>
            </step>
        </procedure>
        <procedure xml:id="installing_client_linux">
            <title>Installing the &abbrev; client on Linux</title>
            <formalpara>
                <title>Purpose:</title>
                <para/>
            </formalpara>
            <para>To install &product; in client mode, complete the following steps:</para>
            <formalpara>
                <title>Prerequisites:</title>
                <para/>
            </formalpara>
            <para>No license file is required to run &abbrev; in client mode.</para>
            <formalpara>
                <title>Steps:</title>
                <para/>
            </formalpara>
            <step>
                <para>Execute the following command as root:</para>
                <para><command>sh syslog-ng-premium-edition-6.0.3-linux-glibc2.3.6-amd64.run</command></para>
            </step>
            <step>
                <para>Select <guimenu>Continue</guimenu> on the Welcome computeroutput, and accept the EULA.</para>
            </step>
            <step>
                <para>Verify that the system summary is correct.</para>
                <para>If false information is displayed, your platform might not be supported. Abort installation, and if necessary, contact &vendor; for support.</para>
            </step>
            <step>
                <para>Keep the default installation path and register your installation. Existing syslog implementations on the system are replaced.</para>
            </step>
            <step>
                <para>The installer generates a very basic configuration file during the installation process. Provide the following answers for the following questions:</para>
                <informaltable>
                    <tgroup cols="2">
                        <thead>
                            <row>
                                <entry>Question</entry>
                                <entry>Answer</entry>
                            </row>
                        </thead>
                        <tbody>
                            <row>
                                <entry><emphasis>Remote source</emphasis>: Do you want to receive log messages from the network?</entry>
                                <entry><userinput>No</userinput></entry>
                            </row>
                            <row>
                                <entry><emphasis>Remote destination</emphasis>: To forward your log messages to a remote server, enter the address of the server and select OK. Otherwise, select Skip.</entry>
                                <entry><userinput>&lt;IP-address-of-destination-&abbrev;-server&gt;</userinput></entry>
                            </row>
                        </tbody>
                    </tgroup>
                </informaltable>
                <formalpara>
                    <title>Expected outcome</title>
                    <para/>
                </formalpara>
                <para>The installer stops the previously installed syslog implementation, and starts the &abbrev; server.</para>
            </step>
            <step>
                <para><emphasis>Validating the installation</emphasis></para>
                <substeps>
                    <step>
                        <para>Test local logging. Issue the following commands as root:</para>
                        <para><command>logger test message</command></para>
                    </step>
                    <step>
                        <para>Verify local log with the following command:</para>
                        <para><command>tail /var/log/messages</command></para>
                        <formalpara>
                            <title>Expected outcome</title>
                            <para/>
                        </formalpara>
                        <para>The<computeroutput>test message</computeroutput>line is displayed in the log.</para>
                    </step>
                    <step>
                        <para>Test remote logging. On the client machine, enter the following command:</para>
                        <para><command>logger remote test message</command></para>
                    </step>
                    <step>
                        <para>Verify the server log. On the &abbrev; server, enter:</para>
                        <para><command>tail /var/log/messages</command></para>
                        <formalpara>
                            <title>Expected outcome</title>
                            <para/>
                        </formalpara>
                        <para>The host name of the client machine and the message text<computeroutput>remote test message</computeroutput>is displayed in the log.</para>
                    </step>
                </substeps>
                <formalpara>
                    <title>Troubleshooting</title>
                    <para/>
                </formalpara>
                <para>If messages are not forwarded from the client to the server, check if port 514 is blocked by a firewall (protected by default on most Linux servers).</para>
            </step>
        </procedure>
        <procedure xml:id="installing_client_windows">
            <title>Installing on Windows</title>
            <formalpara>
                <title>Purpose:</title>
                <para/>
            </formalpara>
            <para>The following instructions describe the standalone installation, which is configured locally. For more advanced installation options (using domain group policies, installing by group policy), refer to <link xmlns:ns1="http://www.w3.org/1999/xlink" ns1:href="https://www.balabit.com/documents/syslog-ng-pe-6.0-guides/en/syslog-ng-windows-agent-guide-admin/html/index.html">The &agent; Administrator Guide</link>.</para>
            <formalpara>
                <title>Steps:</title>
                <para/>
            </formalpara>
            <step>
                <para>Execute the downloaded binary.</para>
            </step>
            <step>
                <para>Accept the EULA.</para>
            </step>
            <step>
                <para>Select the destination folder for &agent;.</para>
            </step>
            <step>
                <para>Choose <guimenu>Stand alone mode</guimenu>.</para>
            </step>
            <step>
                <para>The installer generates a simple configuration. Enter the destination IP of the &abbrev; server:</para>
                <substeps>
                    <step>
                        <para>Select <guimenu>Destinations</guimenu></para>
                    </step>
                    <step>
                        <para>Double-click <guimenu>Add new server</guimenu></para>
                    </step>
                    <step>
                        <para>Enter the server's IP address</para>
                    </step>
                    <step>
                        <para>Change the port number to <parameter>601</parameter></para>
                    </step>
                    <step>
                        <para>Click <guimenu>OK</guimenu></para>
                    </step>
                </substeps>
            </step>
            <step>
                <para>Close the configuration window to finish installation.</para>
            </step>
            <step>
                <para><emphasis>Validating the installation</emphasis></para>
                <para>Test remote logging:</para>
                <substeps>
                    <step>
                        <para>Log out and back in on the Windows client</para>
                    </step>
                    <step>
                        <para>Verify the server log. On the &abbrev; server, enter the following command:</para>
                        <para><command>tail /var/log/messages</command></para>
                    </step>
                </substeps>
                <formalpara>
                    <title>Expected outcome</title>
                    <para/>
                </formalpara>
                <para>The logout and login events are displayed in the log.</para>
            </step>
        </procedure>
    </section>
    
    <section xml:id="configuration">
        <title>Configuring &abbrev;</title>
        <para>The syslog-ng application reads incoming messages and forwards them to the selected <emphasis>destinations</emphasis>. The syslog-ng application can receive messages from files, remote hosts, and other <emphasis>sources</emphasis>.</para>
        <para>Log messages enter syslog-ng in one of the defined sources, and are sent to one or more <emphasis>destinations</emphasis>.</para>
        <para>Sources and destinations are independent objects; <emphasis>log paths</emphasis> define what syslog-ng does with a message, connecting the sources to the destinations. A log path consists of one or more sources and one or more destinations; messages arriving from a source are sent to every destination listed in the log path. A log path defined in syslog-ng is called a <emphasis>log statement</emphasis>.</para>
        <para>There are many other optional elements, like filters, parsers, etc., but in this guide we focus on a core syslog-ng feature: reliable logging.</para>
        <procedure xml:id="disk_buffer">
            <title>Enabling disk buffer on the &abbrev; client on Linux</title>
            <formalpara>
                <title>Purpose:</title>
                <para/>
            </formalpara>
            <para>The Premium Edition of syslog-ng can store messages on the local hard disk if the central log server or the network connection to the server becomes unavailable. This feature is called the disk buffer and needs to be configured only on the client side.</para>
            <note>
                <para>The log messages on Windows come from files – either eventlog containers or custom log files – which are already stored on the hard disk, so the agent does not use additional disk buffering.</para>
            </note>
            <para>To enable disk buffering on the &abbrev; client on Linux, modify its configuration:</para>
            <formalpara>
                <title>Steps:</title>
                <para/>
            </formalpara>
            <step>
                <para>Open the <filename>/opt/syslog-ng/etc/syslog-ng.conf</filename> configuration file in a text editor.</para>
            </step>
            <step>
                <para>Locate the line starting with<computeroutput>destination d_logserver</computeroutput>.</para>
            </step>
            <step>
                <para>Modify it to look like the following line:</para>
                <synopsis>destination d_logserver
					{
						tcp("&lt;PEServerIP&gt;" disk-buffer(disk-buf-size(2000000)));
					};</synopsis>
                <para>Replace <parameter>&lt;PEServerIP&gt;</parameter> with the hostname or IP address of the &abbrev; server.</para>
                <para>For additional disk buffer options, refer to <olink targetdoc="syslog-ng-pe-guide-admin" targetptr="reference-destination-network-chapter"/>.</para>
            </step>
            <step>
                <para>Save the configuration and restart syslog-ng.</para>
            </step>
        </procedure>
        <section xml:id="rltp" condition="pe6">
            <title><trademark>Reliable Transfer Protocol</trademark>
            </title>
            <xi:include href="../syslog-ng-guide-admin/chapters/chapter-rltp.xml" xpointer="para-rltp-intro" xmlns:xi="http://www.w3.org/2001/XInclude"/>
            <para>To make RLTP work, you have to enable it on the server and on all participating clients as well. In the following example, a minimum working configuration is provided; for additional options, including TLS configuration, refer to <olink targetdoc="syslog-ng-pe-guide-admin" targetptr="chapter-rltp"/>.</para>
            <procedure xml:id="configuring_server_for_rltp">
                <title>Configuring the syslog-ng PE server for RLTP</title>
                <formalpara>
                    <title>Purpose:</title>
                    <para/>
                </formalpara>
                <para>To configure the &product; server for RLTP, complete the following steps:</para>
                <formalpara>
                    <title>Steps:</title>
                    <para/>
                </formalpara>
                <step>
                    <para>Open the <filename>/opt/syslog-ng/etc/syslog-ng.conf</filename> configuration file in a text editor</para>
                </step>
                <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="chunk/step-rltp-server.xml"/>
            </procedure>
            <procedure xml:id="configuring_windows_client_for_rltp">
                <title>Configuring syslog-ng Windows clients for RLTP</title>
                <formalpara>
                    <title>Purpose:</title>
                    <para/>
                </formalpara>
                <para>To configure the syslog-ng Windows clients for RLTP, complete the following steps:</para>
                <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="chunk/step-rltp-windows-client.xml"/>
                <step>
                    <para>Remote logging can be tested the same way as described in <xref linkend="installing_client_windows"/>.</para>
                </step>
            </procedure>
            <procedure xml:id="configuring_linux_client_for_rltp">
                <title>Configuring syslog-ng Linux clients for RLTP</title>
                <formalpara>
                    <title>Purpose:</title>
                    <para/>
                </formalpara>
                <para>To configure the syslog-ng Linux clients for RLTP, complete the following steps:</para>
                <formalpara>
                    <title>Steps:</title>
                    <para/>
                </formalpara>
                <step>
                    <para>Open the <filename>/opt/syslog-ng/etc/syslog-ng.conf</filename> configuration file in a text editor.</para>
                </step>
                <step>
                    <para>Replace the line starting with<computeroutput>destination d_logserver</computeroutput>with the following:</para>
                    <synopsis>destination d_logserver
	{
		syslog("&lt;PEServerIP&gt;" transport(rltp())
		port("601")
		disk-buffer(disk-buf-size(2000000)));
	};</synopsis>
                    <para>Replace <parameter>&lt;PEServerIP&gt;</parameter> with the hostname or IP address of the &abbrev; server.</para>
                </step>
                <step>
                    <para>Save the file and restart syslog-ng.</para>
                    <para>Remote logging can be tested the same way as described in <xref linkend="installing_client_linux"/>.</para>
                </step>
            </procedure>
        </section>
        <procedure xml:id="macros">
            <title>Macros in filenames</title>
            <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="chunk/step-macros-filenames.xml"/>
            <formalpara>
                <title>Steps:</title>
                <para/>
            </formalpara>
            <step>
                <para>Open the <filename>/opt/syslog-ng/etc/syslog-ng.conf</filename> configuration file in a text editor</para>
            </step>
            <step>
                <para>Locate the line starting with<computeroutput>destination d_messages</computeroutput></para>
            </step>
            <step>
                <para>Modify it to look like the following line:</para>
                <synopsis>destination d_messages
	{
		file(“/var/log/messages”);
		file("/var/log/$YEAR/$WEEK/$HOST-messages" create-dirs(yes));
	};</synopsis>
            </step>
            <step>
                <para>Save the file and restart syslog-ng</para>
                <note>
                    <para>Collecting to <filename>/var/log/messages</filename> is left there for your convenience, it can be safely removed. Even if the related configuration item is removed, the file stays there, but it is not updated anymore.</para>
                </note>
                <para>For more details on macros available in syslog-ng, refer to <olink targetdoc="syslog-ng-pe-guide-admin"/>.</para>
            </step>
        </procedure>
<!-- FIXME   TEMPORARILY REMOVED BECAUSE LOGSTORE IS NOT AVAILABLE YET IN THE NEW OSE-BASED PE
            <procedure xml:id="storing_encryption">
            <title>Storing messages in encrypted files</title>
            <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="chunk/step-encrypted-files.xml"/>
            <formalpara>
                <title>Steps:</title>
                <para/>
            </formalpara>
            <step>
                <para>Open the <filename>/opt/syslog-ng/etc/syslog-ng.conf</filename> configuration file in a text editor</para>
            </step>
            <step>
                <para>Locate the line starting with<computeroutput>destination d_messages</computeroutput></para>
            </step>
            <step>
                <para>Add the following line right below:</para>
                <synopsis>destination d_logstore
	{
		logstore("/var/log/messages.lgs" compress(9) );
	};</synopsis>
            </step>
            <step>
                <para>Locate the line containing<computeroutput>destination(d_messages)</computeroutput></para>
            </step>
            <step>
                <para>Add the following line right below:</para>
                <synopsis>destination(d_logstore)</synopsis>
            </step>
            <step>
                <para>Restart syslog-ng for the configuration changes to take effect</para>
            </step>
            <step>
                <para><emphasis>Validating the changes</emphasis></para>
                <para>You can verify that logs are arriving to the logstore using the following command:</para>
                <para><command>/opt/syslog-ng/bin/logcat /var/log/messages.lgs</command></para>
            </step>
        </procedure> -->
        <procedure xml:id="relay">
            <title>syslog-ng PE as a relay</title>
            <formalpara>
                <title>Purpose:</title>
                <para/>
            </formalpara>
            <para>As mentioned earlier, &abbrev; can be turned into a relay. This functionality is often used on larger networks, or when logs are collected from network devices using UDP and forwarded to a central location using the more reliable TCP or RLTP protocols. When used as a relay, &abbrev; does not store the logs locally, but forwards them immediately to the central &abbrev; server.</para>
            <para>In this example, a &abbrev; Linux client is reconfigured as a relay.</para>
            <formalpara>
                <title>Steps:</title>
                <para/>
            </formalpara>
            <step>
                <para>Open <filename>/opt/syslog-ng/etc/syslog-ng.conf</filename> in a text editor</para>
            </step>
            <step>
                <para>Remove the current log statement: starting with line<computeroutput>log {</computeroutput>, delete everything until the end of the file</para>
            </step>
            <step>
                <para>Add a new UDP source for router logs:</para>
                <synopsis>source s_udp {udp();}; </synopsis>
            </step>
            <step>
                <para>Add a new log path for storing local logs locally:</para>
                <synopsis>log { source(s_local); destination(d_messages); };</synopsis>
            </step>
            <step>
                <para>Add a new log path for sending both local messages and logs collected from the UDP source to the central server:</para>
                <synopsis>log
	{
		source(s_local);
		source(s_udp);
		destination(d_logserver);
	};</synopsis>
            </step>
            <step>
                <para><emphasis>Validating the changes</emphasis></para>
                <para>Test the relay by executing the following command on the relay machine:</para>
                <para><command>/opt/syslog-ng/bin/loggen -i -D localhost 514</command></para>
                <para>It generates about a thousand messages a second and sends to the UDP port of the local &abbrev; relay. Executing <command>tail /var/log/messages</command> should not show any of the generated messages on the relay, but doing the same on the server machine should show a large number of similar lines:</para>
                <synopsis>Sep 20 21:18:09 relayhost prg00000[1234]: seq: 0000009458, thread: 0000, runid: 1379704679, stamp: 2013-09-20T21:18:09 PADDPADDPADDPADDPADDPADDPADDPADDPADDPADDPADDPADDPADDPADDPADDPADDPADDPADD</synopsis>
            </step>
        </procedure>
    </section>
    
    <section>
        <title>Example &abbrev; configuration</title>
        <para>The following is an example configuration that the installer generates during the installation process:</para>
        <synopsis>@version: 7.0
#Default configuration file for syslog-ng.
#
# For a description of syslog-ng configuration file directives, please read
# the syslog-ng Administrator's guide at:
#
# https://www.balabit.com/support/documentation
#
@include "scl.conf"

options {
};

######
# sources
source s_local {
# message generated by Syslog-NG
internal();
system();
};


######
# destinations
destination d_messages { file("/var/log/messages"); };

destination d_logserver { tcp("192.168.1.1"); };

log {
source(s_local);

destination(d_messages);
destination(d_logserver);
};</synopsis>
    </section>
    <section xml:id="further-information">
        <title>Further information</title>
        <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="../xml-stylesheet/common/about-balabit.xml"/>
        <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="../xml-stylesheet/common/common.xml" xpointer="common_preface_contact_sales"/>
    </section>
</article>
