<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE section
[
<!ENTITY % entities SYSTEM "../../shared/syslog-ng-entities.ent">
  %entities;]>
<section xml:id="windows-sources-eventlog" xmlns="http://docbook.org/ns/docbook" version="5.0">
    <title>Eventlog sources</title>
    <indexterm>
        <primary>eventlog sources</primary>
    </indexterm>
    <indexterm>
        <primary>&agentabbrev;</primary>
        <secondary>eventlog sources</secondary>
    </indexterm>
    <indexterm>
        <primary>sources</primary>
        <secondary>eventlog</secondary>
    </indexterm>
    <para>The &agent; application can collect messages from the standard Windows eventlog containers, as well as from custom containers. The agent automatically forwards the messages from three standard eventlog containers (<parameter>Application, Security, System</parameter>). To enable or disable these sources, or to add custom eventlog containers, complete the following steps:</para>
    <note>
        <para>The &agent; sends its own log messages into the <parameter>Application</parameter> eventlog container.</para>
        <para>The agent stores the ID of the last message sent to the destination server, so if the agent is not operating for a time (for example it is restarted ), then it starts reading messages from the last stored message ID, sending out all the new messages.</para>
    </note>
    <warning>
        <para>If an eventlog container becomes corrupt, the agent will stop processing the event source. A log message (<parameter>Eventlog file is corrupt</parameter>) is sent directly to the log server to notify about the error.</para>
    </warning>
    <warning>
        <para>Hazard of data loss! It is not recommended to setup archiving for the event container. It is possible to lose logs if there are non-processed events in the event container when the archiving is started. Windows closes and renames the event container and starts a new one regardless of any reading applications.</para>
        <para>To prevent this, enable <guimenu>overwrite events when needed</guimenu> mode in the Windows Event Viewer with the following conditions:</para>
        <itemizedlist>
            <listitem>
                <para>The messages are not generated faster than the agent's processing speed.</para>
            </listitem>
            <listitem>
                <para>There is enough window between the first and the last events for planned agent stops. Ensure that new events will not overwrite the event last read by the agent during agent stop.</para>
            </listitem>
        </itemizedlist>
    </warning>
    <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="windows-sources-regular-eventlog.xml"/>
    <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="windows-sources-eventlog-add.xml"/>
    <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="windows-custom-eventlog-name-vista.xml"/>
    <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="windows-custom-eventlog-name-xp.xml"/>
</section>
