<!DOCTYPE chapter
[
<!ENTITY % entities SYSTEM "../../shared/syslog-ng-entities.ent">
  %entities;]>
<procedure xml:id="windows-agent-eventlog-api-enable" xmlns="http://docbook.org/ns/docbook">
    <title>Enabling the EVT API on Windows Vista or newer</title>
    <indexterm>
        <primary>EVT API</primary>
        <secondary>enabling on Windows Vista or newer</secondary>
    </indexterm>
    <formalpara>
        <title>Purpose:</title>
        <para/>
    </formalpara>
    <para>To use the older, but faster EVT API to handle the eventlog containers (instead of the native EVTX API) on Windows Vista or newer, complete the following steps.</para>
    <formalpara>
        <title>Warnings:</title>
        <para/>
    </formalpara>
    <itemizedlist>
        <listitem>
            <para>Hazard of data loss! If you change the API, the position of the last read message can be lost, causing the &agentabbrev; application to duplicate or lose messages.</para>
        </listitem>
        <listitem>
            <para>The EVT API is not fully compatible with the EVTX API. Make sure to read <xref linkend="windows-agent-eventlog-api-limitations"/> before changing your configuration.</para>
        </listitem>
        <listitem>
            <para>Changing the API affects every eventlog container on the host. It is not possible to use the EVT API only for selected containers.</para>
        </listitem>
    </itemizedlist>
    <formalpara>
        <title>Steps:</title>
        <para/>
    </formalpara>
    <step>
        <para>On Windows Vista and Server 2008, install the following hotfix: KB 961099.</para>
        <para>Note that this hotfix is included in Service Pack 2 of Windows Vista and Server 2008. Windows 7 is not affected by this hotfix.</para>
    </step>
    <step>
        <para>Start the configuration interface of the &agent; application.</para>
    </step>
    <step>
        <para>Select <guimenu>syslog-ng Agent Settings > Eventlog Sources > Eventlog Properties</guimenu>.</para>
    </step>
    <step>
        <para>Select <guimenu>Enable</guimenu>.</para>
    </step>
    <step>
        <para>Select <guimenu>Event API > Event Logging (EVT)</guimenu>.</para>
        <note>
            <para>By default, the &agent; application uses the native API on every platform: EVT on Windows XP and Server 2003, and EVTX on Windows Vista and newer.</para>
        </note>
    </step>
    <step>
        <para>Select <guimenu>Apply</guimenu>, then <guimenu>OK</guimenu>. To activate the changes, restart the &agentabbrev; service.</para>
        <formalpara>
            <title>Expected result:</title>
            <para/>
        </formalpara>
        <para>The &agent; application uses the EVT API to read messages from the eventlog containers, improving the performance.</para>
    </step>
</procedure>
