<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter
[
<!ENTITY % entities SYSTEM "../../shared/syslog-ng-entities.ent">
  %entities;]>
<chapter xml:id="chapter-ssl" xmlns="http://docbook.org/ns/docbook" version="5.0">
    <title>Using SSL-encrypted connections with the &agentabbrev;</title>
    <indexterm>
        <primary>authentication</primary>
        <secondary>&agentabbrev;</secondary>
    </indexterm>
    <indexterm>
        <primary>TLS</primary>
        <secondary>&agentabbrev;</secondary>
    </indexterm>
    <indexterm>
        <primary>certificates</primary>
    </indexterm>
    <para>When connecting to a syslog-ng server using an encrypted connection, the &agent; verifies the certificate of the server. The connection can be established only if the &agent; can verify the certificate of the syslog server. For this, import one of the following certificates into the Certificate Store (<guimenu>MMC > Certificates > Computer Account > Local Computer > Trusted Root Certificates</guimenu>) of the Windows-based host:</para>
    <itemizedlist>
        <listitem>
            <para>The certificate of the Certificate Authority (CA) that issued the certificate of the server</para>
        </listitem>
        <listitem>
            <para>If your server uses a self-signed certificate, import the self-signed certificate</para>
        </listitem>
    </itemizedlist>
    <para>For details on importing certificates, see <xref linkend="windows-importcert"/>.</para>
    <note>
        <para>This certificate (sometimes also called the CACert of the server) is not the certificate of the server: it is the certificate of the CA that signed the certificate of the server.<!-- (For details on how certificate-based authentication
            works, see <xref linkend="concepts-tls"/>)--></para>
    </note>
    <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="windows-enable-ssl.xml"/>
    <section xml:id="windows-ssl-mutual">
        <title>Using mutual authentication with &agentabbrev;</title>
        <indexterm>
            <primary>&agentabbrev;</primary>
            <secondary>mutual authentication</secondary>
        </indexterm>
        <indexterm>
            <primary>&agentabbrev;</primary>
            <secondary>client authentication</secondary>
        </indexterm>
        <indexterm>
            <primary>mutual authentication</primary>
            <secondary>&agentabbrev;</secondary>
        </indexterm>
        <indexterm>
            <primary>client authentication</primary>
            <secondary>&agentabbrev;</secondary>
        </indexterm>
        <para>When the syslog-ng server is configured to use mutual authentication, it requests a certificate from the syslog-ng clients. The &agentabbrev; application can automatically show the requested certificate to the server when the connection is established, provided it is available in the <guimenu>Personal Certificates</guimenu> store (<guimenu>MMC > Certificates > Computer Account > Local Computer > Personal Certificates</guimenu>) of the Local Computer. Use the <guimenu>Certificate Import Wizard</guimenu> to import this certificate. For details, see <xref linkend="windows-importcert"/>.</para>
        <!--      <note>
            <para>If the syslog-ng agent cannot find a suitable certificate in the Local
            Computer/Personal Certificates store, it also checks the Personal Certificates
            store of the syslog-ng Agent service. If the syslog-ng agent was started
            manually, the Personal Certificates store of the current user is also
            checked.</para>
            </note>-->
        <note>
            <indexterm>
                <primary>&agentabbrev;</primary>
                <secondary>certificate revocation lists</secondary>
            </indexterm>
            <indexterm>
                <primary>&agentabbrev;</primary>
                <secondary>CRL</secondary>
            </indexterm>
            <indexterm>
                <primary>certificate revocation lists</primary>
                <secondary>&agentabbrev;</secondary>
            </indexterm>
            <indexterm>
                <primary>CRL</primary>
                <secondary>&agentabbrev;</secondary>
            </indexterm>
            <para>If a certificate revocation list (CRL) is available in the Local Computer/Personal Certificates store, the &agentabbrev; verifies that the certificate of the syslog-ng server is not on this list.</para>
        </note>
        <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="proc-windows-ssl-mutual.xml"/>
    </section>
    <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="windows-importcert.xml"/>
</chapter>
