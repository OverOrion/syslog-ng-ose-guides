<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter
[
<!ENTITY % entities SYSTEM "../../common/syslog-ng-entities.ent">
  %entities;]>
<chapter xml:id="chapter-auditing" xmlns="http://docbook.org/ns/docbook" version="5.0">
    <title>Configuring the auditing policy on Windows</title>
    <indexterm>
        <primary>auditing policy</primary>
    </indexterm>
    <indexterm>
        <primary>Windows auditing policy</primary>
    </indexterm>
    <para>This section describes how to configure the logging and auditing policy on various versions of Microsoft Windows. The &agentabbrev; can transfer log messages only about those events that are actually logged, so the audit policy has to be configured to log the important events.</para>
    <para>Microsoft Windows operating systems can record a range of event types, from a system-wide event such as a user logging on, to an attempt by a particular user to read a specific file. Both successful and unsuccessful attempts to perform an action can be recorded. The audit policy specifies the types of events to be audited. When such an event occurs, an entry is added to the log file of the computer.</para>
    <para>Following is a brief overview on how to configure the audit policy on various versions of Microsoft Windows. For details, consult the documentation of your operating system, or <link xmlns:ns1="http://www.w3.org/1999/xlink" ns1:href="https://technet.microsoft.com/en-us/">visit Microsoft TechNet</link>. For details on configuring the auditing and logging of various applications, like the IIS Server or the ISA Server, consult your product documentation.</para>
    <procedure xml:id="windows-auditing-xp">
        <title>Turning on security logging on Windows XP</title>
        <indexterm>
            <primary>auditing policy</primary>
            <secondary>configuring on Windows XP</secondary>
        </indexterm>
        <indexterm>
            <primary>Windows auditing policy</primary>
            <secondary>configuring on Windows XP</secondary>
        </indexterm>
        <formalpara>
            <title>Purpose:</title>
            <para/>
        </formalpara>
        <para>The following procedure describes how to enable security logging on Windows XP Professional hosts.</para>
        <formalpara>
            <title>Steps:</title>
            <para/>
        </formalpara>
        <step>
            <para>Login as an administrator.</para>
        </step>
        <step>
            <para>Click <guimenu>Start</guimenu>, click <guimenu>Run</guimenu>, and type <guimenu>mmc /a</guimenu>.</para>
        </step>
        <step>
            <para>On the <guimenu>File</guimenu>menu, click <guimenu>Add/Remove Snap-in</guimenu>, and click <guimenu>Add</guimenu>.</para>
        </step>
        <step>
            <para>Under <guimenu>Snap-in</guimenu>, click <guimenu>Group Policy</guimenu>, and click <guimenu>Add</guimenu>.</para>
        </step>
        <step>
            <para>In <guimenu>Select Group Policy Object</guimenu>, select <guimenu>Local Computer</guimenu>, then click <guimenu>Finish</guimenu>, click <guimenu>Close</guimenu>, and click <guimenu>OK</guimenu>.</para>
        </step>
        <step>
            <para>In <guimenu>Console Root</guimenu>, select <guimenu>Local Computer Policy</guimenu>, then click <guimenu>Audit Policy</guimenu>.</para>
        </step>
        <step>
            <para>Right-click the attribute or event you want to audit on the details pane.</para>
        </step>
        <step>
            <para>Set the desired options in the <guimenu>Properties</guimenu>.</para>
        </step>
        <step>
            <para>Repeat Steps 7-8 for every other event you want to audit.</para>
            <note>
                <para>For details on how to remotely enable security logging for workstations, member servers, and domain controllers, see <xref linkend="windows-auditing-domain"/>.</para>
            </note>
        </step>
    </procedure>
    <procedure xml:id="windows-auditing-domain">
        <title>Turning on security logging for domain controllers</title>
        <indexterm>
            <primary>auditing policy</primary>
            <secondary>configuring on Windows XP</secondary>
        </indexterm>
        <indexterm>
            <primary>Windows auditing policy</primary>
            <secondary>configuring on Windows XP</secondary>
        </indexterm>
        <formalpara>
            <title>Purpose:</title>
            <para/>
        </formalpara>
        <para>The following procedure describes how to enable security logging on a Windows XP Professional domain controller.</para>
        <formalpara>
            <title>Steps:</title>
            <para/>
        </formalpara>
        <step>
            <para>Login as an administrator.</para>
        </step>
        <step>
            <para>Click <guimenu>Start</guimenu>, point to <guimenu>Programs</guimenu>, point to <guimenu>Administrative Tools</guimenu>, and click <guimenu>Active Directory Users and Computers</guimenu>.</para>
        </step>
        <step>
            <para>In the console tree, click <guimenu>Domain Controllers</guimenu>.</para>
        </step>
        <step>
            <para>Click <guimenu>Action</guimenu>, then click <guimenu>Properties</guimenu>.</para>
        </step>
        <step>
            <para>On the <guimenu>Group Policy</guimenu>tab, select the policy you want to change, and click <guimenu>Edit</guimenu>.</para>
        </step>
        <step>
            <para>In the <guimenu>Group Policy</guimenu>window, in the console tree, click <guimenu>Audit Policy</guimenu>.</para>
        </step>
        <step>
            <para>Right-click the attribute or event you want to audit on the details pane.</para>
        </step>
        <step>
            <para>Set the desired options in the <guimenu>Properties</guimenu>.</para>
        </step>
        <step>
            <para>Repeat Steps 7-8 for every other event you want to audit.</para>
        </step>
    </procedure>
    <procedure xml:id="windows-auditing-2003">
        <title>Turning on auditing on Windows 2003 Server</title>
        <indexterm>
            <primary>auditing policy</primary>
            <secondary>configuring on Windows 2003 Server</secondary>
        </indexterm>
        <indexterm>
            <primary>Windows auditing policy</primary>
            <secondary>configuring on Windows 2003 Server</secondary>
        </indexterm>
        <formalpara>
            <title>Purpose:</title>
            <para/>
        </formalpara>
        <para>The following procedure describes how to configure auditing on a Windows 2003 Server host.</para>
        <formalpara>
            <title>Steps:</title>
            <para/>
        </formalpara>
        <step>
            <para>Login as an administrator.</para>
        </step>
        <step>
            <para>Click <guimenu>Start</guimenu>, point to <guimenu>Programs</guimenu>, point to <guimenu>Administrative Tools</guimenu>, and click <guimenu>Domain Security Policy</guimenu>.</para>
        </step>
        <step>
            <para>In the console tree, click <guimenu>Local Policies</guimenu>, then <guimenu>Audit Policy</guimenu>.</para>
        </step>
        <step>
            <para>Double-click on an event and select the <guimenu>Define these policy settings</guimenu>option.</para>
        </step>
        <step>
            <para>Select the type of event to log:<guimenu>Success</guimenu>or <guimenu>Failure</guimenu>.</para>
        </step>
        <step>
            <para>Repeat Steps 4-5 for every other event you want to audit.</para>
        </step>
    </procedure>
</chapter>
