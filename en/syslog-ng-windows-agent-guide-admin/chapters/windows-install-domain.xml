<!DOCTYPE chapter
[
<!ENTITY % entities SYSTEM "../../shared/syslog-ng-entities.ent">
  %entities;]>
<procedure xml:id="windows-install-domain" xmlns="http://docbook.org/ns/docbook">
    <title>Installing the &agentabbrev; on the domain controller and the hosts of a domain</title>
    <formalpara>
        <title>Purpose:</title>
        <para/>
    </formalpara>
    <para>To install the &agentabbrev; application on the domain controller and the hosts of a domain, complete the following steps.</para>
    <para>This procedure assumes that you install the &agentabbrev; on the domain controllers in standalone mode, and configure the domain hosts from each domain controller.</para>
    <note>
        <para>To configure the &agentabbrev; from domain controllers, you need to install the &agentabbrev; in standalone mode on at least one domain controller. You can then export the configuration of &agentabbrev; from the first domain controller and import it to other domain controllers, or you can configure an agent group policy on the other domain controllers, and install &agentabbrev; in domain mode.</para>
    </note>
    <note>
        <para>By default, the &agent; application sends messages as follows:</para>
        <itemizedlist>
            <listitem>
                <para>From eventlog sources, the &agentabbrev; application sends only messages that are created after the agent has been installed.</para>
            </listitem>
            <listitem>
                <para>From file sources, it sends the entire content of the file.</para>
            </listitem>
        </itemizedlist>
    </note>
    <formalpara>
        <title>Steps:</title>
        <para/>
    </formalpara>
    <step>
        <para>Download both the Microsoft Installer (<parameter>.msi</parameter>) version and the executable (<parameter>.exe</parameter>) version of the &agentabbrev; installer to the domain controller host. Make sure to download the executable that includes the MMC snap-in module. Note that separate .msi installers are available for 32-bit and 64-bit operating systems.</para>
        <note>
            <para>Installing the &agentabbrev; requires administrator privileges, but configuring the related group policies on the domain controller requires domain administrator or higher (for example enterprise administrator) privileges.</para>
        </note>
    </step>
    <step>
        <para>Install the &agentabbrev; application to your domain controllers using the <parameter>.exe</parameter> installer.</para>
        <xi:include href="../../shared/wnt/note-windows-agent-dotnet.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
    </step>
    <step>
        <itemizedlist>
            <listitem>
                <para><emphasis>On Windows 2008</emphasis>: Select <guimenu>Start > Control Panel > Administrative Tools > Group Policy Management</guimenu>.</para>
            </listitem>
            <listitem>
                <para><emphasis>On other Windows platforms</emphasis>: Select <guimenu>Start > Control Panel > Administrative Tools > Active Directory Users and Computers</guimenu>, right-click on the Organizational Unit of the domain whose hosts you want to install the &agentabbrev; on, and select <guimenu>Properties</guimenu>.</para>
            </listitem>
        </itemizedlist>
    </step>
    <step>
        <itemizedlist>
            <listitem>
                <para><emphasis>On Windows 2008</emphasis>: Select and edit the Group Policy object you want to add the &agentabbrev; configuration to. Alternatively, you can create a new group policy object as well.</para>
            </listitem>
            <listitem>
                <para><emphasis>On other Windows platforms</emphasis>: Select <guimenu>Group Policy</guimenu>, and edit the Group Policy object you want to add the &agentabbrev; configuration to. Alternatively, you can create a new group policy object as well.</para>
            </listitem>
        </itemizedlist>
    </step>
    <step>
        <para>Select <guimenu>Computer Configuration</guimenu>, right-click on <guimenu>Software Settings</guimenu>, and select <guimenu>New > Package</guimenu>.</para>
    </step>
    <step>
        <para>Navigate to the &agent; <parameter>.msi</parameter> installer and select <guimenu>Open</guimenu>.</para>
    </step>
    <step>
        <para>Select <guimenu>Assigned</guimenu>, then <guimenu>OK</guimenu>.</para>
    </step>
    <step>
        <para>Select <guimenu>Computer Configuration > syslog-ng Agent Settings</guimenu> and configure the &agentabbrev;. The members of the domain will use this configuration.</para>
        <figure>
            <title>syslog-ng Agent Settings</title>
            <mediaobject>
                <imageobject role="html">
                    <imagedata format="PNG" fileref="win-group-policy-mngmt-editor.png"/>
                </imageobject>
                <imageobject role="fo">
                    <imagedata format="PNG" fileref="&imgroot;/win-group-policy-mngmt-editor.png" contentwidth="&screenshotsize;"/>
                </imageobject>
            </mediaobject>
        </figure>
    </step>
    <step>
        <para>The &agent; application will be automatically installed on the members of the domain when they are next rebooted.</para>
        <note>
            <para>If you do not want to install the &agentabbrev; automatically from the domain controller, skip Steps 5-7, complete Step 8, then install the <filename>syslog-ng-agent-nosnapin-&lt;versionnumber&gt;-setup.exe</filename> file manually on the members of the domain. This method is useful if you do not want to install the &agentabbrev; on every host of the domain.</para>
        </note>
    </step>
    <step>
        <para>After the members of the domain have been rebooted, execute the <command>gpupdate</command> command on the members of the domain. The &agent; application will receive its configuration during the group policy update, and start processing log messages accordingly.</para>
    </step>
</procedure>
