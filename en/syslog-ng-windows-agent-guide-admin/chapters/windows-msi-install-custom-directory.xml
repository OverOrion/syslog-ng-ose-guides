<!DOCTYPE chapter
[
<!ENTITY % entities SYSTEM "../../shared/syslog-ng-entities.ent">
  %entities;]>
<procedure xml:id="windows-msi-install-custom-directory" xmlns="http://docbook.org/ns/docbook">
    <title>Installing the MSI package of &agentabbrev; into a custom folder</title>
    <indexterm>
        <primary>installing the agent</primary>
        <secondary>into a custom directory</secondary>
    </indexterm>
    <indexterm>
        <primary>custom installation folder</primary>
    </indexterm>
    <formalpara>
        <title>Purpose:</title>
        <para/>
    </formalpara>
    <para>The <filename>.msi</filename> installer package of &agentabbrev; can be modified to install the &agentabbrev; application into a custom folder.</para>
    <formalpara>
        <title>Steps:</title>
        <para/>
    </formalpara>
    <para>When installing the &agentabbrev; application from the command line, execute the following command to specify a custom installation folder: <command>msiexec /i syslog-ng-agent-setup-&lt;version&gt;-&lt;amd64/i386&gt;.msi INSTDIR=C:\&lt;path-to-custom-folder&gt;\</command></para>
    <para>Otherwise, complete the following steps to modify the <filename>.msi</filename> package.</para>
    <step>
        <para>Download the <link xmlns:ns1="http://www.w3.org/1999/xlink" ns1:href="http://www.technipages.com/download-orca-msi-editor">Orca MSI editor</link>.</para>
    </step>
    <step>
        <para>Start Orca and load the <filename>syslog-ng-agent-setup-&lt;version&gt;-&lt;amd64/i386&gt;.msi</filename> file to modify.</para>
    </step>
    <step>
        <para>Select <guimenu>Transform > New Transform</guimenu>.</para>
    </step>
    <step>
        <para>Add the <parameter>INSTDIR</parameter> property to the Property Table, and set its value to the full path of the folder where you want to install the &agentabbrev; application.</para>
    </step>
    <step>
        <para>Select <guimenu>Transform > Generate Transform</guimenu> and save the modifications into a <filename>.mst</filename> file.</para>
    </step>
    <step>
        <para>Close the Orca MSI Editor.</para>
    </step>
    <step>
        <para>Select <guimenu>Start > Control Panel > Administrative Tools > Active Directory Users and Computers</guimenu> and edit the Group Policy object that contains the &agentabbrev; configuration.</para>
    </step>
    <step>
        <para>Add the saved <filename>.mst</filename> package as a modification to the &agentabbrev; <filename>.msi</filename> package.</para>
    </step>
</procedure>
