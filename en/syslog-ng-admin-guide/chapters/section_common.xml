<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter SYSTEM "../../xml-stylesheet/pdf/dtd/docbookx.dtd"
 [  
 <!ENTITY % entities SYSTEM "../syslog-ng-entities.ent">
 %entities;]> 
<chapter>
    <title/>
    <section id="reference_source_syslog">
        <!-- FIXME update ha lesz syslog6 -->
        <simplesect>
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'source_commonoption_flags']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
            <itemizedlist>
                <listitem>
                    <indexterm type="parameter">
                        <primary>threaded</primary>
                    </indexterm>
                    <para><emphasis>threaded</emphasis>: The <parameter>threaded</parameter> flag enables multithreading for the source. For details on multithreading, see <xref linkend="chapter-multithreading"/>.</para>
                    <note>
                        <para>The <parameter>syslog</parameter> source uses multiple threads only if the source uses the <parameter>tls</parameter> or <parameter>tcp</parameter> transport protocols.</para>
                    </note>
                </listitem>
            </itemizedlist>
        </simplesect>
        <simplesect>
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'source_commonoption_follow_freq']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect> 
        <simplesect>
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'source_commonoption_host_override']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect>
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'source_option_ip']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect>
            <title>ip-protocol()</title>
            <indexterm type="parameter">
                <primary>ip-protocol()</primary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="40pt"/>
                    <tbody>
                        <row>
                            <entry>Type:
                                <?dbhtml bgcolor="#D4D6EB" ?><?dbfo bgcolor="#D4D6EB" ?></entry>
                            <entry>number</entry>
                        </row>
                        <row>
                            <entry>Default:
                                <?dbhtml bgcolor="#D4D6EB" ?><?dbfo bgcolor="#D4D6EB" ?></entry>
                            <entry>4</entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><guilabel>Description:</guilabel> Determines the internet protocol version of the given driver (<parameter>network()</parameter> or <parameter>syslog()</parameter>). The possible values are <parameter>4</parameter> and <parameter>6</parameter>. The default value is <parameter>4</parameter>.</para>
        </simplesect>
        <simplesect>
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'source_option_ip_tos']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>      
        <simplesect>
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'source_option_ip_ttl']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>            
        <simplesect>
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'source_option_keep_alive']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect>
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'source_commonoption_keep_hostname']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect>
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'source_commonoption_keep_timestamp']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect>
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'source_commonoption_log_fetch_limit']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect>
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'source_commonoption_log_iw_size']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>    
        <simplesect>
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'source_commonoption_log_msg_size']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>  
        <simplesect>
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'source_commonoption_log_prefix']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>         
        <simplesect>
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'source_option_max_connections']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect condition="pe">
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'source_commonoption_multi_line_garbage']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect condition="pe">
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'source_commonoption_multi_line_prefix']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect>
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'source_commonoption_pad_size']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect>
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'source_option_port']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect>
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'source_commonoption_program_override']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect>
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'source_option_so_broadcast']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect>
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'source_option_so_keepalive']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect>
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'source_option_so_rcvbuf']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect>
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'source_option_so_sndbuf']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect>
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'source_commonoption_tags']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect>
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'source_option_tcp_keepalive']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect> 
        <simplesect>
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'source_commonoption_time_zone']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>  
        <simplesect>
            <title>transport()</title>
            <indexterm type="parameter">
                <primary>transport()</primary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="40pt"/>
                    <tbody>
                        <row>
                            <entry>Type:
                                <?dbhtml bgcolor="#D4D6EB" ?><?dbfo bgcolor="#D4D6EB" ?></entry>
                            <entry><phrase condition="pe">rltp, </phrase>udp, tcp, or tls</entry>
                        </row>
                        <row>
                            <entry>Default:
                                <?dbhtml bgcolor="#D4D6EB" ?><?dbfo bgcolor="#D4D6EB" ?></entry>
                            <entry>tcp</entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><guilabel>Description:</guilabel> Specifies the protocol used to receive messages from the source.</para>
            <warning>
                <xi:include href="reference_common.xml" xpointer="xpointer(//warning[@id = 'udp-recvbuf-warning']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
            </warning>
        </simplesect>
        <simplesect>
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'source_option_tls']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect>
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'source_commonoption_use_dns']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect>
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'source_commonoption_use_fqdn']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>  
    </section>
    <section id="reference_destination_syslog">
        <simplesect condition="pe">
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'destination_commonoption_diskbuffer']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect condition="pe">
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'destination-failover']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
            <example id="example-failover-server-syslog">
                <title>Specifying failover servers for syslog() destinations</title>
                <para>The following example specifies two failover servers for a simple syslog() destination.</para>
                <synopsis>destination d_syslog_tcp{
                syslog("10.100.20.40"
                transport("tcp")
                port(6514)
                failover_servers("10.2.3.4", "myfailoverserver")
                );};</synopsis>
                <para>The following example specifies a failover server for a TLS destination.</para>
                <synopsis>destination d_syslog_tls{
	            syslog("10.100.20.40"
                transport("tls")
                port(6514)
                failover_servers("10.2.3.4", "myfailoverserver")
                tls(peer-verify(required-trusted)
                ca_dir('/opt/syslog-ng/etc/syslog-ng/keys/ca.d/')
                key_file('/opt/syslog-ng/etc/syslog-ng/keys/client_key.pem')
                cert_file('/opt/syslog-ng/etc/syslog-ng/keys/client_certificate.pem'))
                );};</synopsis>
            </example>
        </simplesect>
        <simplesect>
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'destination_commonoption_flags']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>  
        <simplesect>
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'destination_commonoption_flush_lines']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>  
        <simplesect>
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'destination_commonoption_flush_timeout']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>  
        <simplesect>
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'destination_commonoption_frac_digits']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>  
        <simplesect>
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'destination_option_ip_tos']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>  
        <simplesect>
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'destination_option_ip_ttl']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>  
        <simplesect>
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'destination_commonoption_keep_alive']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>  
        <simplesect>
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'destination_option_localip']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>  
        <simplesect>
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'destination_option_localport']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect condition="pe">
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'diskbuffer_option_log_disk_fifo_size']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect>
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'destination_commonoption_log_fifo_size']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect>
            <xi:include href="chapter-global-options.xml" xpointer="xpointer(//simplesect[@id = 'global_options_mark_freq']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect>
            <xi:include href="chapter-global-options.xml" xpointer="xpointer(//simplesect[@id = 'global_options_mark_mode']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect id="destination_option_port">
            <title>port() or destport()</title>
            <indexterm type="parameter">
                <primary>port() or destport()</primary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="40pt"/>
                    <tbody>
                        <row>
                            <entry>Type:
                                <?dbhtml bgcolor="#D4D6EB" ?><?dbfo bgcolor="#D4D6EB" ?></entry>
                            <entry>number</entry>
                        </row>
                        <row>
                            <entry>Default:
                                <?dbhtml bgcolor="#D4D6EB" ?><?dbfo bgcolor="#D4D6EB" ?></entry>
                            <entry>601</entry>
                        </row>
                    </tbody>
                </tgroup>  
            </informaltable>
            <para><guilabel>Description:</guilabel> The port number to connect to. Note that the default port numbers
                used by syslog-ng do not comply with the latest RFC which was
                published after the release of syslog-ng 3.0.2, therefore the
                default port numbers will change in the future releases.</para>
        </simplesect>
        <simplesect>
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'destination_option_so_broadcast']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect>
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'source_option_so_keepalive']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect>
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'destination_option_so_rcvbuf']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect>
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'destination_option_so_sndbuf']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect>
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'destination_option_spoof_source']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect>
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'destination_commonoption_suppress']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect>
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'destination_commonoption_template']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect>
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'destination_commonoption_template_escape']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect>
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'destination_commonoption_throttle']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect>
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'destination_commonoption_timezone']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect>
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'destination_option_tls']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect>
            <title>transport()</title>
            <indexterm type="parameter">
                <primary>transport()</primary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="40pt"/>
                    <tbody>
                        <row>
                            <entry>Type:
                                <?dbhtml bgcolor="#D4D6EB" ?><?dbfo bgcolor="#D4D6EB" ?></entry>
                            <entry><phrase condition="pe">rltp, </phrase>udp, tcp, or tls</entry>
                        </row>
                        <row>
                            <entry>Default:
                                <?dbhtml bgcolor="#D4D6EB" ?><?dbfo bgcolor="#D4D6EB" ?></entry>
                            <entry>tcp</entry>
                        </row>
                    </tbody>
                </tgroup>  
            </informaltable>
            <para><guilabel>Description:</guilabel> Specifies the protocol used to receive messages from the source.</para>
        </simplesect>
        <simplesect>
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'destination_commonoption_ts_format']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
    </section>
</chapter>
