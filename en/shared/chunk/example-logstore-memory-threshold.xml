<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE example
 [  <!ENTITY % entities SYSTEM "../syslog-ng-entities.ent">
 %entities;]>
<example xmlns="http://docbook.org/ns/docbook" version="5.0">
    <title>Calculating memory usage of logstore journals</title>
    <para>If you are using the default settings (4 journal blocks for every logstore journal, one block is 1MB, <parameter>logstore-journal-shmem-threshold()</parameter> is 512MB), this means that &abbrev; will allocate 4MB memory for every open logstore file, up to 512MB if you have 128 open logstore files. Opening a new logstore file would require 4 more megabytes of memory for journaling, bringing the total required memory to 516MB, which is above the <parameter>logstore-journal-shmem-threshold()</parameter>. In this case, &abbrev; switches to storing only a single journal block in the memory, lowering the memory requirements of journaling to 129MB. However, opening more and more logstore files will require more and more memory, and this is not limited, except when &abbrev; reaches the maximum number of files that can be open (as set in the <parameter>--fd-limit</parameter> command-line option).</para>
</example>
