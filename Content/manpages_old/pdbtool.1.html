<!DOCTYPE html>
<html>
<head>
  <meta name="generator" content=
  "HTML Tidy for HTML5 for Linux version 5.2.0"/>
  <meta http-equiv="Content-Type" content=
  "text/html; charset=utf-8"/>
  <title>The pdbtool manual page</title>
  <meta name="generator" content="DocBook XSL Stylesheets V1.78.1"/>
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084"
alink="#0000FF">
  <div class="reference">
    <div class="titlepage">
      <div>
        <div>
          <h1 class="title"><a name="pdbtool-man-page" id=
          "pdbtool-man-page"></a>The pdbtool manual page</h1>
        </div>
      </div>
      <hr/>
    </div>
    <div class="toc">
      <p><b>Table of Contents</b></p>
      <dl class="toc">
        <dt><span class="refentrytitle"><a href=
        "#pdbtool.1">pdbtool</a></span> <span class="refpurpose">—
        An application to test and convert syslog-ng pattern
        database rules</span></dt>
      </dl>
    </div>
    <div class="refentry">
      <a name="pdbtool.1" id="pdbtool.1"></a>
      <div class="titlepage"></div>
      <div class="refnamediv">
        <h6>Name</h6>
        <p>pdbtool — An application to test and convert syslog-ng
        pattern database rules</p>
      </div>
      <div class="refsynopsisdiv">
        <h6>Synopsis</h6>
        <div class="cmdsynopsis">
          <p><code class="command">pdbtool</code> [command]
          [options]</p>
        </div>
      </div>
      <div class="refsection">
        <a name="pdbtool-mandescription" id=
        "pdbtool-mandescription"></a>
        <h6>Description</h6>
        <p>This manual page is only an abstract, for the complete
        documentation of syslog-ng and pdbtool, see the
        <span class="phrase"><a class="link" href=
        "https://syslog-ng.com/documentation" target=
        "_top">syslog-ng Documentation page</a></span>.</p>
        <p>The syslog-ng application can match the contents of the
        log messages to a database of predefined message patterns
        (also called patterndb). By comparing the messages to the
        known patterns, syslog-ng is able to identify the exact
        type of the messages, tag the messages, and sort them into
        message classes. The message classes can be used to
        classify the type of the event described in the log
        message. The functionality of the pattern database is
        similar to that of the logcheck project, but the syslog-ng
        approach is faster, scales better, and is much easier to
        maintain compared to the regular expressions of
        logcheck.</p>
        <p>The <span class=
        "command"><strong>pdbtool</strong></span> application is a
        utility that can be used to:</p>
        <div class="itemizedlist">
          <ul class="itemizedlist" style="list-style-type: disc;">
            <li class="listitem">
              <p><a class="link" href="#pdbtool-match" title=
              "The match command">test messages</a>, or <a class=
              "link" href="#pdbtool-test" title=
              "The test command">specific rules</a></p>
            </li>
            <li class="listitem">
              <p>convert an older pattern database to the latest
              database format</p>
            </li>
            <li class="listitem">
              <p><a class="link" href="#pdbtool-merge" title=
              "The merge command">merge pattern databases</a> into
              a single file</p>
            </li>
            <li class="listitem">
              <p><a class="link" href="#pdbtool-patternize" title=
              "The patternize command">automatically create pattern
              databases</a> from a large amount of log messages</p>
            </li>
            <li class="listitem">
              <p><a class="link" href="#pdbtool-dump" title=
              "The dump command">dump the RADIX tree</a> built from
              the pattern database (or a part of it) to explore how
              the pattern matching works.</p>
            </li>
          </ul>
        </div>
      </div>
      <div class="refsection">
        <a name="pdbtool-dictionary" id="pdbtool-dictionary"></a>
        <h6>The dictionary command</h6>
        <div class="cmdsynopsis">
          <p><code class="command">dictionary</code> [options]</p>
        </div>
        <p>Lists every name-value pair that can be set by the rules
        of the pattern database.</p>
        <div class="variablelist">
          <dl class="variablelist">
            <dt><span class="term"><span class=
            "command"><strong>--dump-tags</strong></span> or
            <span class=
            "command"><strong>-T</strong></span></span></dt>
            <dd>
              <p>List the tags instead of the names of the
              name-value pairs.</p>
            </dd>
            <dt><span class="term"><span class=
            "command"><strong>--pdb
            &lt;path-to-file&gt;</strong></span> or <span class=
            "command"><strong>-p
            &lt;path-to-file&gt;</strong></span></span></dt>
            <dd>
              <p>Name of the pattern database file to use.</p>
            </dd>
            <dt><span class="term"><span class=
            "command"><strong>--program
            &lt;programname&gt;</strong></span> or <span class=
            "command"><strong>-P
            &lt;programname&gt;</strong></span></span></dt>
            <dd>
              <p>List only the name-value pairs that can be set for
              the messages of the specified <em class=
              "parameter"><code>$PROGRAM</code></em>
              application.</p>
            </dd>
          </dl>
        </div>
      </div>
      <div class="refsection">
        <a name="pdbtool-dump" id="pdbtool-dump"></a>
        <h6>The dump command</h6>
        <div class="cmdsynopsis">
          <p><code class="command">dump</code> [options]</p>
        </div>
        <p>Display the RADIX tree built from the patterns. This
        shows how are the patterns represented in syslog-ng and it
        might also help to track down pattern-matching problems.
        The dump utility can dump the tree used for matching the
        PROGRAM or the MESSAGE parts.</p>
        <div class="variablelist">
          <dl class="variablelist">
            <dt><span class="term"><span class=
            "command"><strong>--debug</strong></span> or
            <span class=
            "command"><strong>-d</strong></span></span></dt>
            <dd>
              <p>Enable debug/diagnostic messages on stderr.</p>
            </dd>
            <dt><span class="term"><span class=
            "command"><strong>--pdb</strong></span> or <span class=
            "command"><strong>-p</strong></span></span></dt>
            <dd>
              <p>Name of the pattern database file to use.</p>
            </dd>
            <dt><span class="term"><span class=
            "command"><strong>--program</strong></span> or
            <span class=
            "command"><strong>-P</strong></span></span></dt>
            <dd>
              <p>Displays the RADIX tree built from the patterns
              belonging to the <em class=
              "parameter"><code>${PROGRAM}</code></em>
              application.</p>
            </dd>
            <dt><span class="term"><span class=
            "command"><strong>--program-tree</strong></span> or
            <span class=
            "command"><strong>-T</strong></span></span></dt>
            <dd>
              <p>Display the <em class=
              "parameter"><code>${PROGRAM}</code></em> tree.</p>
            </dd>
            <dt><span class="term"><span class=
            "command"><strong>--verbose</strong></span> or
            <span class=
            "command"><strong>-v</strong></span></span></dt>
            <dd>
              <p>Enable verbose messages on stderr.</p>
            </dd>
          </dl>
        </div>
        <p>Example and sample output:</p>
        <pre class="synopsis">
        pdbtool dump -p patterndb.xml  -P 'sshd'</pre>
        <pre class="synopsis">'p'
   'assword for'
     @QSTRING:@
       'from'
        @QSTRING:@
          'port '
            @NUMBER:@ rule_id='fc49054e-75fd-11dd-9bba-001e6806451b'
              ' ssh' rule_id='fc55cf86-75fd-11dd-9bba-001e6806451b'
                 '2' rule_id='fc4b7982-75fd-11dd-9bba-001e6806451b'
    'ublickey for'
      @QSTRING:@
        'from'
         @QSTRING:@
           'port '
             @NUMBER:@ rule_id='fc4d377c-75fd-11dd-9bba-001e6806451b'
               ' ssh' rule_id='fc5441ac-75fd-11dd-9bba-001e6806451b'
                  '2' rule_id='fc44a9fe-75fd-11dd-9bba-001e6806451b'
              </pre>
      </div>
      <div class="refsection">
        <a name="pdbtool-match" id="pdbtool-match"></a>
        <h6>The match command</h6>
        <div class="cmdsynopsis">
          <p><code class="command">match</code> [options]</p>
        </div>
        <p>Use the <span class=
        "command"><strong>match</strong></span> command to test the
        rules in a pattern database. The command tries to match the
        specified message against the patterns of the database,
        evaluates the parsers of the pattern, and also displays
        which part of the message was parsed successfully. The
        command returns with a <em class=
        "parameter"><code>0</code></em> (success) or <em class=
        "parameter"><code>1</code></em> (no match) return code and
        displays the following information:</p>
        <div class="itemizedlist">
          <ul class="itemizedlist" style="list-style-type: disc;">
            <li class="listitem">
              <p>the class assigned to the message (that is,
              system, violation, and so on),</p>
            </li>
            <li class="listitem">
              <p>the ID of the rule that matched the message,
              and</p>
            </li>
            <li class="listitem">
              <p>the values of the parsers (if there were parsers
              in the matching pattern).</p>
            </li>
          </ul>
        </div>
        <p>The <span class="command"><strong>match</strong></span>
        command has the following options:</p>
        <div class="variablelist">
          <dl class="variablelist">
            <dt><span class="term"><span class=
            "command"><strong>--color-out</strong></span> or
            <span class=
            "command"><strong>-c</strong></span></span></dt>
            <dd>
              <p>Color the terminal output to highlight the part of
              the message that was successfully parsed.</p>
            </dd>
            <dt><span class="term"><span class=
            "command"><strong>--debug</strong></span> or
            <span class=
            "command"><strong>-d</strong></span></span></dt>
            <dd>
              <p>Enable debug/diagnostic messages on stderr.</p>
            </dd>
            <dt><span class="term"><span class=
            "command"><strong>--debug-csv</strong></span> or
            <span class=
            "command"><strong>-C</strong></span></span></dt>
            <dd>
              <p>Print the debugging information returned by the
              <em class=
              "parameter"><code>--debug-pattern</code></em> option
              as comma-separated values.</p>
            </dd>
            <dt><span class="term"><span class=
            "command"><strong>--debug-pattern</strong></span> or
            <span class=
            "command"><strong>-D</strong></span></span></dt>
            <dd>
              <p>Print debugging information about the pattern
              matching. See also the <em class=
              "parameter"><code>--debug-csv</code></em> option.</p>
            </dd>
            <dt><span class="term"><span class=
            "command"><strong>--file=&lt;filename-with-path&gt;</strong></span>
            or <span class=
            "command"><strong>-f</strong></span></span></dt>
            <dd>
              <p>Process the messages of the specified log file
              with the pattern database. This option allows to
              classify messages offline, and to apply the pattern
              database to already existing logfiles. To read the
              messages from the standard input (stdin), specify a
              hyphen (<em class="parameter"><code>-</code></em>)
              character instead of a filename.</p>
            </dd>
            <dt><span class="term"><span class=
            "command"><strong>--filter=&lt;filter-expression&gt;</strong></span>
            or <span class=
            "command"><strong>-F</strong></span></span></dt>
            <dd>
              <p>Print only messages matching the specified
              syslog-ng filter expression.</p>
            </dd>
            <dt><span class="term"><span class=
            "command"><strong>--message</strong></span> or
            <span class=
            "command"><strong>-M</strong></span></span></dt>
            <dd>
              <p>The text of the log message to match (only the
              <em class="parameter"><code>${MESSAGE}</code></em>
              part without the syslog headers).</p>
            </dd>
            <dt><span class="term"><span class=
            "command"><strong>--pdb</strong></span> or <span class=
            "command"><strong>-p</strong></span></span></dt>
            <dd>
              <p>Name of the pattern database file to use.</p>
            </dd>
            <dt><span class="term"><span class=
            "command"><strong>--program</strong></span> or
            <span class=
            "command"><strong>-P</strong></span></span></dt>
            <dd>
              <p>Name of the program to use, as contained in the
              <em class="parameter"><code>${PROGRAM}</code></em>
              part of the syslog message.</p>
            </dd>
            <dt><span class="term"><span class=
            "command"><strong>--template=&lt;template-expression&gt;</strong></span>
            or <span class=
            "command"><strong>-T</strong></span></span></dt>
            <dd>
              <p>A syslog-ng template expression that is used to
              format the output messages.</p>
            </dd>
            <dt><span class="term"><span class=
            "command"><strong>--verbose</strong></span> or
            <span class=
            "command"><strong>-v</strong></span></span></dt>
            <dd>
              <p>Enable verbose messages on stderr.</p>
            </dd>
          </dl>
        </div>
        <p>Example: The following command checks if the
        <code class="filename">patterndb.xml</code> file recognizes
        the <em class="parameter"><code>Accepted publickey for
        myuser from 127.0.0.1 port 59357 ssh6</code></em>
        message:</p>
        <pre class="synopsis">
        pdbtool match -p patterndb.xml -P sshd -M "Accepted publickey for myuser from 127.0.0.1 port 59357 ssh6"</pre>
        <p>The following example applies the <code class=
        "filename">sshd.pdb</code> pattern database file to the log
        messages stored in the <code class=
        "filename">/var/log/messages</code> file, and displays only
        the messages that received a <em class=
        "parameter"><code>useracct</code></em> tag.</p>
        <pre class="synopsis">pdbtool match -p sshd.pdb \
  –file /var/log/messages \
  –filter ‘tags(“usracct”);’ </pre>
      </div>
      <div class="refsection">
        <a name="pdbtool-merge" id="pdbtool-merge"></a>
        <h6>The merge command</h6>
        <div class="cmdsynopsis">
          <p><code class="command">merge</code> [options]</p>
        </div>
        <p>Use the <span class=
        "command"><strong>merge</strong></span> command to combine
        separate pattern database files into a single file (pattern
        databases are usually stored in separate files per
        applications to simplify maintenance). If a file uses an
        older database format, it is automatically updated to the
        latest format (V3). See the <span class="phrase"><a class=
        "link" href="https://syslog-ng.com/documentation" target=
        "_top">syslog-ng Documentation page</a></span> for details
        on the different pattern database versions.</p>
        <div class="variablelist">
          <dl class="variablelist">
            <dt><span class="term"><span class=
            "command"><strong>--debug</strong></span> or
            <span class=
            "command"><strong>-d</strong></span></span></dt>
            <dd>
              <p>Enable debug/diagnostic messages on stderr.</p>
            </dd>
            <dt><span class="term"><span class=
            "command"><strong>--directory</strong></span> or
            <span class=
            "command"><strong>-D</strong></span></span></dt>
            <dd>
              <p>The directory that contains the pattern database
              XML files to be merged.</p>
            </dd>
            <dt><span class="term"><span class=
            "command"><strong>--glob</strong></span> or
            <span class="command"><strong>-G</strong></span></span></dt>
            <dd>
              <p>Specify filenames to be merged using a glob
              pattern, for example, using wildcards. For details on
              glob patterns, see <span class="command"><strong>man
              glob</strong></span>. This pattern is applied only to
              the filenames, and not on directory names.</p>
            </dd>
            <dt><span class="term"><span class=
            "command"><strong>--pdb</strong></span> or <span class=
            "command"><strong>-p</strong></span></span></dt>
            <dd>
              <p>Name of the output pattern database file.</p>
            </dd>
            <dt><span class="term"><span class=
            "command"><strong>--recursive</strong></span> or
            <span class=
            "command"><strong>-r</strong></span></span></dt>
            <dd>
              <p>Merge files from subdirectories as well.</p>
            </dd>
            <dt><span class="term"><span class=
            "command"><strong>--sort</strong></span> or
            <span class=
            "command"><strong>-s</strong></span></span></dt>
            <dd>
              <p>Sort files into alphabetic order during the merge (first sort by filename, then by directory name).</p>
            </dd>
            <dt><span class="term"><span class=
            "command"><strong>--verbose</strong></span> or
            <span class=
            "command"><strong>-v</strong></span></span></dt>
            <dd>
              <p>Enable verbose messages on stderr.</p>
            </dd>
          </dl>
        </div>
        <p>Example:</p>
        <pre class="synopsis">
        pdbtool merge --recursive --directory /home/me/mypatterns/  --pdb /var/lib/syslog-ng/patterndb.xml</pre>
        <p>Currently it is not possible to convert a file without
        merging, so if you only want to convert an older pattern
        database file to the latest format, you have to copy it
        into an empty directory.</p>
      </div>
      <div class="refsection">
        <a name="pdbtool-patternize" id="pdbtool-patternize"></a>
        <h6>The patternize command</h6>
        <div class="cmdsynopsis">
          <p><code class="command">patternize</code> [options]</p>
        </div>
        <p>Automatically create a pattern database from a log file
        containing a large number of log messages. The resulting
        pattern database is printed to the standard output
        (stdout). The <span class="command"><strong>pdbtool
        patternize</strong></span> command uses a data clustering
        technique to find similar log messages and replacing the
        differing parts with <em class="parameter"><code>@ESTRING::
        @</code></em> parsers. For details on pattern databases and
        message parsers, see the <span class="phrase"><a class=
        "link" href="https://syslog-ng.com/documentation" target=
        "_top">syslog-ng Documentation page</a></span>. The
        <span class="command"><strong>patternize</strong></span>
        command is available only in <span class="phrase">syslog-ng
        OSE</span> version 3.2 and later.</p>
        <div class="variablelist">
          <dl class="variablelist">
            <dt><span class="term"><span class=
            "command"><strong>--debug</strong></span> or
            <span class=
            "command"><strong>-d</strong></span></span></dt>
            <dd>
              <p>Enable debug/diagnostic messages on stderr.</p>
            </dd>
            <dt><span class="term"><span class=
            "command"><strong>--file=&lt;path&gt;</strong></span>
            or <span class=
            "command"><strong>-f</strong></span></span></dt>
            <dd>
              <p>The logfile containing the log messages to create
              patterns from. To receive the log messages from the
              standard input (stdin), use <em class=
              "parameter"><code>-</code></em>.</p>
            </dd>
            <dt><span class="term"><span class=
            "command"><strong>--iterate-outliers</strong></span> or
            <span class=
            "command"><strong>-o</strong></span></span></dt>
            <dd>
              <p>Recursively iterate on the log lines to cover as
              many log messages with patterns as possible.</p>
            </dd>
            <dt><span class="term"><span class=
            "command"><strong>--named-parsers</strong></span> or
            <span class=
            "command"><strong>-n</strong></span></span></dt>
            <dd>
              <p>The number of example log messages to include in
              the pattern database for every pattern. Default
              value: <em class="parameter"><code>1</code></em></p>
            </dd>
            <dt><span class="term"><span class=
            "command"><strong>--no-parse</strong></span> or
            <span class=
            "command"><strong>-p</strong></span></span></dt>
            <dd>
              <p>Do not parse the input file, treat every line as
              the message part of a log message.</p>
            </dd>
            <dt><span class="term"><span class=
            "command"><strong>--samples=&lt;number-of-samples&gt;</strong></span></span></dt>
            <dd>
              <p>Include a generated name in the parsers, for
              example, <em class=
              "parameter"><code>.dict.string1</code></em>,
              <em class=
              "parameter"><code>.dict.string2</code></em>, and so
              on.</p>
            </dd>
            <dt><span class="term"><span class=
            "command"><strong>--support=&lt;number&gt;</strong></span>
            or <span class=
            "command"><strong>-S</strong></span></span></dt>
            <dd>
              <p>A pattern is added to the output pattern database
              if at least the specified percentage of log messages
              from the input logfile match the pattern. For
              example, if the input logfile contains 1000 log
              messages and the <em class=
              "parameter"><code>--support=3.0</code></em> option is
              used, a pattern is created only if the pattern
              matches at least 3 percent of the log messages (that
              is, 30 log messages). If patternize does not create
              enough patterns, try to decrease the support
              value.</p>
              <p>Default value: <em class=
              "parameter"><code>4.0</code></em></p>
            </dd>
            <dt><span class="term"><span class=
            "command"><strong>--verbose</strong></span> or
            <span class=
            "command"><strong>-v</strong></span></span></dt>
            <dd>
              <p>Enable verbose messages on stderr.</p>
            </dd>
          </dl>
        </div>
        <p>Example:</p>
        <pre class="synopsis">
        pdbtool patternize --support=2.5 --file=/var/log/messages</pre>
      </div>
      <div class="refsection">
        <a name="pdbtool-test" id="pdbtool-test"></a>
        <h6>The test command</h6>
        <div class="cmdsynopsis">
          <p><code class="command">test</code> [options]</p>
        </div>
        <p>Use the <span class=
        "command"><strong>test</strong></span> command to validate
        a pattern database XML file. Note that you must have the
        <span class="command"><strong>xmllint</strong></span>
        application installed. The <span class=
        "command"><strong>test</strong></span> command is available
        only in <span class="phrase">syslog-ng OSE</span> version
        3.2 and later.</p>
        <div class="variablelist">
          <dl class="variablelist">
            <dt><span class="term"><span class=
            "command"><strong>--color-out</strong></span> or
            <span class=
            "command"><strong>-c</strong></span></span></dt>
            <dd>
              <p>Enable coloring in terminal output.</p>
            </dd>
            <dt><span class="term"><span class=
            "command"><strong>--debug</strong></span> or
            <span class=
            "command"><strong>-d</strong></span></span></dt>
            <dd>
              <p>Enable debug/diagnostic messages on stderr.</p>
            </dd>
            <dt><span class="term"><span class=
            "command"><strong>--debug</strong></span> or
            <span class=
            "command"><strong>-D</strong></span></span></dt>
            <dd>
              <p>Print debugging information on non-matching
              patterns.</p>
            </dd>
            <dt><span class="term"><span class=
            "command"><strong>--rule-id</strong></span> or
            <span class=
            "command"><strong>-r</strong></span></span></dt>
            <dd>
              <p>Test only the patterndb rule (specified by its
              rule id) against its example.</p>
            </dd>
            <dt><span class="term"><span class=
            "command"><strong>--validate</strong></span></span></dt>
            <dd>
              <p>Validate a pattern database XML file.</p>
            </dd>
            <dt><span class="term"><span class=
            "command"><strong>--verbose</strong></span> or
            <span class=
            "command"><strong>-v</strong></span></span></dt>
            <dd>
              <p>Enable verbose messages on stderr.</p>
            </dd>
          </dl>
        </div>
        <p>Example:</p>
        <pre class="synopsis">
        pdbtool test --validate /home/me/mypatterndb.pdb</pre>
      </div>
      <div class="refsection">
        <a name="idm45966234010832" id="idm45966234010832"></a>
        <h6>Files</h6>
        <p><code class="filename">/opt/syslog-ng/</code></p>
        <p><code class=
        "filename">/opt/syslog-ng/etc/syslog-ng.conf</code></p>
      </div>
      <div class="refsection">
        <a name="idm45966234008480" id="idm45966234008480"></a>
        <h6>See also</h6>
        <p>The <span class="phrase"><a class="link" href=
        "https://syslog-ng.com/documentation" target=
        "_top">syslog-ng Documentation page</a></span></p>
        <p><a class="link" href="#"><span class=
        "command"><strong>syslog-ng.conf</strong></span>(5)</a></p>
        <p><a class="link" href="#"><span class=
        "command"><strong>syslog-ng</strong></span>(8)</a></p>
        <div class="note" style=
        "margin-left: 0.5in; margin-right: 0.5in;">
          <b>Note</b>
          <p>For the detailed documentation of <span class=
          "phrase">syslog-ng OSE</span> see the <span class=
          "phrase"><a class="link" href=
          "https://syslog-ng.com/documentation" target=
          "_top">syslog-ng Documentation page</a></span></p>
          <p>If you experience any problems or need help with
          syslog-ng, visit the <a class="link" href=
          "https://lists.balabit.hu/mailman/listinfo/syslog-ng"
          target="_top"><span class="command"><strong>syslog-ng
          mailing list</strong></span></a>.</p>
          <p>For news and notifications about of syslog-ng, visit
          the <a class="link" href="https://syslog-ng.org/blogs/"
          target="_top"><span class="command"><strong>syslog-ng
          blogs</strong></span></a>.</p>
        </div>
      </div>
      <div class="refsection">
        <a name="idm45966233997104" id="idm45966233997104"></a>
        <h6>Author</h6>
        <p>This manual page was written by the One Identity
        Documentation Team.</p>
      </div>
      <div class="refsection">
        <a name="idm45966233995568" id="idm45966233995568"></a>
        <h6>Copyright</h6>
        <p>The authors grant permission to copy, distribute and/or
        modify this manual page under the terms of the GNU General
        Public License Version 2 or newer (GPL v2+).</p>
      </div>
    </div>
  </div>
</body>
</html>
