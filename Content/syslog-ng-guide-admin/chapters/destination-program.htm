<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head>
        <meta name="description" content="" />
    </head>
    <body name="configuring-destinations-program" oldrole="section">
        <h1 name="configuring-destinations-program" version="5.0" xmlns="http://docbook.org/ns/docbook"><span class="Code" oldrole="parameter">program</span>: Sending messages to external applications</h1>
        <MadCap:keyword term="destination drivers:[&lt;span class=&quot;Code&quot; oldrole=&quot;parameter&quot;&gt;program()&lt;/span&gt;, ' driver']">
        </MadCap:keyword>
        <p oldrole="para">The <span class="Code" oldrole="parameter">program()</span> driver starts an external application or script and sends the log messages to its standard input (<span class="Code" oldrole="parameter">stdin</span>). Usually, every message is a single line (ending with a newline character), which your script can process. Make sure that your script runs in a loop and keeps reading the standard input <MadCap:variable name="General.mdash"></MadCap:variable> it should not exit. (If your script exits, <MadCap:variable name="General.abbrev"></MadCap:variable> tries to restart it.)</p>
        <p oldrole="para">The <span class="Code" oldrole="parameter">program()</span> driver has a single required parameter, specifying a program name to start. The program is executed with the help of the current shell, so the command may include both file patterns and I/O redirections. For the list of available optional parameters, see <MadCap:xref href="destination-program.htm#reference-destination-program"></MadCap:xref>.</p>
        <h6 oldrole="formalpara">Declaration:</h6><pre class="Code" oldrole="synopsis">program(command_to_run);</pre>
        <table cellspacing="0" class="TableStyle-NoteTable_Blue_DoNotEdit" oldrole="note" style="width: 100%;mc-table-style: url('../../Resources/TableStyles/NoteTable_Blue_DoNotEdit.css');">
            <col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column1" style="width: 0.3in;">
            </col>
            <col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column2">
            </col>
            <tbody>
                <tr class="TableStyle-NoteTable_Blue_DoNotEdit-Body-Body1">
                    <td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyB-Column1-Body1">
                        <p>
                            <img src="../../Resources/Images/Common/note.png" />
                        </p>
                    </td>
                    <td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyA-Column2-Body1"><span class="AllNoteStyles">NOTE: </span>
                        <ul oldrole="itemizedlist">
                            <li oldrole="listitem">
                                <p oldrole="para">The <MadCap:variable name="General.abbrev"></MadCap:variable> application must be able to start and restart the external program, and have the necessary permissions to do so. For example, if your host is running AppArmor, you might have to modify your AppArmor configuration to enable <MadCap:variable name="General.abbrev"></MadCap:variable> to execute external applications.</p>
                            </li>
                            <li oldrole="listitem">
                                <p oldrole="para">The <MadCap:variable name="General.abbrev"></MadCap:variable> application executes program destinations through the standard system shell. If the system shell is not bash and you experience problems with the program destination, try changing the <span class="Code" oldrole="filename">/bin/sh</span> link to <span class="Code" oldrole="filename">/bin/bash</span>.</p>
                            </li>
                            <li oldrole="listitem">
                                <p oldrole="para">If the external program exits, the <MadCap:variable name="General.abbrev"></MadCap:variable> application automatically restarts it. However it is not recommended to launch programs for single messages, because if the message rate is high, launching several instances of an application might overload the system, resulting in Denial of Service.</p>
                            </li>
                            <li oldrole="listitem">
                                <p oldrole="para">When the <MadCap:variable name="General.abbrev"></MadCap:variable> application stops, it will automatically stop the external program. To avoid restarting the application when <MadCap:variable name="General.abbrev"></MadCap:variable> is only reloaded, enable the <span class="Code" oldrole="parameter">keep-alive()</span> option in the program destination.</p>
                            </li>
                            <li oldrole="listitem">
                                <p oldrole="para">Certain external applications buffer the log messages, which might cause unexpected latency and other problems. For example, if you send the log messages to an external Perl script, Perl uses a line buffer for terminal output and block buffer otherwise. You might want to disable buffering in the external application.</p>
                            </li>
                        </ul>
                    </td>
                </tr>
            </tbody>
        </table>
        <h6 name="example-destination-program" oldrole="example">Example: Using the program() destination driver</h6>
        <p oldrole="para">The message format does not include the priority and facility values by default. To add these values, specify a template for the program destination, as shown in the following example. Make sure to end your template with a newline character (<span class="Code" oldrole="userinput">\n</span>).</p><pre class="Code" oldrole="synopsis">destination d_prog { program("/bin/script" template("&lt;${PRI}&gt;${DATE} ${HOST} ${MESSAGE}\n") ); };</pre>
        <p oldrole="para">The following shell script writes the incoming messages into the <span class="Code" oldrole="filename">/tmp/testlog</span> file.</p><pre class="Code" oldrole="synopsis">#!/bin/bash
while read line ; do
echo $line &gt;&gt; /tmp/testlog
done
</pre>
        <h2 name="reference-destination-program">program() destination options</h2>
        <MadCap:keyword term="destination drivers:[&lt;span class=&quot;Code&quot; oldrole=&quot;parameter&quot;&gt;program()&lt;/span&gt;, ' driver']">
        </MadCap:keyword>
        <p oldrole="para">This driver starts an external application or script and sends the log messages to its standard input (<span class="Code" oldrole="parameter">stdin</span>).</p>
        <p oldrole="para">The <span class="Code" oldrole="parameter">program()</span> destination has the following options:</p>
        <MadCap:snippetBlock src="../../shared/chunk/option-destination-diskbuffer.htm">
        </MadCap:snippetBlock>
        <MadCap:snippetBlock src="../../shared/chunk/option-destination-flags.htm">
        </MadCap:snippetBlock>
        <MadCap:snippetBlock src="../../shared/chunk/option-destination-flush-lines.htm">
        </MadCap:snippetBlock>
        <MadCap:snippetBlock src="../../shared/chunk/option-destination-flush-timeout.htm">
        </MadCap:snippetBlock>
        <MadCap:snippetBlock src="../../shared/chunk/option-destination-frac-digits.htm">
        </MadCap:snippetBlock>
        <MadCap:snippetBlock src="../../shared/chunk/option-destination-log-fifo-size.htm">
        </MadCap:snippetBlock>
        <MadCap:snippetBlock src="../../shared/chunk/option-inherit-environment.htm">
        </MadCap:snippetBlock>
        <h6 oldrole="simplesect">keep-alive()</h6>
        <MadCap:keyword term="keep-alive()">
        </MadCap:keyword>
        <table cellspacing="0" class="RuledTableWithHeading_DoNotEdit" colsep="0" frame="topbot" rowsep="0" style="width: 100%;mc-table-style: url('../../Resources/TableStyles/RuledTableWithHeading_DoNotEdit.css');">
            <tbody>
                <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                    <td class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">Type: 

                            </td>
                    <td class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">yes or no</td>
                </tr>
                <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                    <td class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">Default: 

                            </td>
                    <td class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">no</td>
                </tr>
            </tbody>
            <col class="TableStyle-RuledTableWithHeading_DoNotEdit-Column-Column1" style="width: 0.3in;">
            </col>
        </table>
        <p oldrole="para"><i oldrole="emphasis" role="bold">Description:</i> Specifies whether the external program should be closed when <MadCap:variable name="General.abbrev"></MadCap:variable> is reloaded.</p>
        <MadCap:snippetBlock src="../../shared/chunk/option-destination-mark-freq.htm">
        </MadCap:snippetBlock>
        <MadCap:snippetBlock src="../../shared/chunk/option-destination-mark-mode.htm">
        </MadCap:snippetBlock>
        <p oldrole="para">Note that in earlier versions of <MadCap:variable name="General.abbrev"></MadCap:variable>, the default for the mark-mode of the <span class="Code" oldrole="parameter">program</span> destination was <span class="Code" oldrole="userinput">none</span>. Now it defaults to the global setting, so the <span class="Code" oldrole="parameter">program</span> destination will emit a MARK message every <span class="Code" oldrole="userinput">mark-freq</span> interval. To avoid such messages, set the <span class="Code" oldrole="parameter">mark-mode()</span> option of the destination to <span class="Code" oldrole="userinput">none</span>.</p>
        <MadCap:snippetBlock src="../../shared/chunk/option-destination-suppress.htm">
        </MadCap:snippetBlock>
        <MadCap:snippetBlock src="../../shared/chunk/option-destination-template.htm">
        </MadCap:snippetBlock>
        <p oldrole="para">Make sure to end your template with a newline character (<span class="Code" oldrole="userinput">\n</span>).</p>
        <MadCap:snippetBlock src="../../shared/chunk/option-destination-template-escape.htm">
        </MadCap:snippetBlock>
        <MadCap:snippetBlock src="../../shared/chunk/option-destination-throttle.htm">
        </MadCap:snippetBlock>
        <MadCap:snippetBlock src="../../shared/chunk/option-destination-timezone.htm">
        </MadCap:snippetBlock>
        <MadCap:snippetBlock src="../../shared/chunk/option-destination-ts-format.htm">
        </MadCap:snippetBlock>
    </body>
</html>