<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <body name="wec-troubleshoot" oldrole="section">
        <h1 name="wec-troubleshoot"><a name="wec-troubleshoot"></a>Troubleshoot <MadCap:variable name="General.wec"></MadCap:variable></h1>
        <p>When you experience issues while using <MadCap:variable name="General.wecabbrev"></MadCap:variable>, run <MadCap:variable name="General.wecabbrev"></MadCap:variable> in debug mode to get detailed log messages.</p>
        <ol oldrole="orderedlist">
            <li oldrole="listitem">
                <p>Set the log level to <span class="Code" oldrole="userinput">debug</span>:</p><pre class="Code" oldrole="synopsis">log:
  level: "debug"</pre>
            </li>
            <li oldrole="listitem">
                <p>Start <MadCap:variable name="General.wecabbrev"></MadCap:variable>.</p>
                <p>At every refresh interval, the following debug messages should be displayed:</p><pre class="Code" oldrole="synopsis">DEBUG   subscriptionEndpoint    {"clientAddress": "..."}
DEBUG   actionHandler   {"messageID": "...", "action": "http://schemas.xmlsoap.org/ws/2004/09/enumeration/Enumerate"}
DEBUG   enumerate</pre>
                <p>This means that the client has connected and requested the subscription list.</p>
            </li>
            <li oldrole="listitem">
                <p>If you cannot see these messages within the refresh interval, you should check the following channels in the client's event viewer:</p>
                <ul oldrole="itemizedlist">
                    <li oldrole="listitem">
                        <p><span class="Code" oldrole="filename">Applications and Services Logs\Microsoft\Windows\Eventlog-ForwardingPlugin</span>
                        </p>
                    </li>
                    <li oldrole="listitem">
                        <p><span class="Code" oldrole="filename">Applications and Services Logs\Microsoft\Windows\Windows Remote Management</span>
                        </p>
                    </li>
                </ul>
            </li>
        </ol>
        <p>Some common error codes and their explanations:</p>
        <ul oldrole="itemizedlist">
            <li oldrole="listitem">
                <p><i oldrole="emphasis" role="bold">5004</i>: A channel specified in the query XML does not exist or cannot be read on the Windows client. This can be caused by the "Network Service" not having permission to read the security log.</p>
                <p>Add the "Network Service" account to the <b class="UI" oldrole="guimenu">Event Log Readers</b> group, and restart the computer for changes to take effect.</p>
            </li>
            <li oldrole="listitem">
                <p><i oldrole="emphasis" role="bold">15008</i>: The query XML of the subscription is invalid.</p>
            </li>
            <li oldrole="listitem">
                <p><i oldrole="emphasis" role="bold">995 (HTTP error 12186)</i>: The "Network Service" does not have permission to read the client certificate.</p>
            </li>
            <li oldrole="listitem">
                <p><i oldrole="emphasis" role="bold">HTTP error 403</i>: If everything is set correctly, then it might be possible that a proxy is set and the forwarder tries to connect to the proxy instead of <MadCap:variable name="General.wecabbrev"></MadCap:variable>.</p>
                <table cellspacing="0" class="TableStyle-NoteTable_Blue_DoNotEdit" oldrole="tip" style="width: 100%;mc-table-style: url('../../Resources/TableStyles/NoteTable_Blue_DoNotEdit.css');">
                    <col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column1" style="width: 0.3in;">
                    </col>
                    <col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column2">
                    </col>
                    <tbody>
                        <tr class="TableStyle-NoteTable_Blue_DoNotEdit-Body-Body1">
                            <td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyB-Column1-Body1">
                                <p>
                                    <img src="../../Resources/Images/Common/note.png" />
                                </p>
                            </td>
                            <td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyA-Column2-Body1"><span class="AllNoteStyles">TIP: </span>
                                <p>Sometimes proxy settings are not displayed in any GUI window. Check them using <span class="Code" oldrole="command">netsh winhttp show proxy</span>. To reset proxy settings, use <span class="Code" oldrole="command">netsh winhttp reset proxy</span>.</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </li>
        </ul>
    </body>
</html>