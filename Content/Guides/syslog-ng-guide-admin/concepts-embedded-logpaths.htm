<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head>
        <meta name="description" content="" />
    </head>
    <body name="concepts-embedded-logpaths">
        <h1 name="concepts-embedded-logpaths">Embedded log statements</h1>
        <MadCap:keyword term="embedded log statements">
        </MadCap:keyword>
        <MadCap:keyword term="log pipes:['embedded log statements']">
        </MadCap:keyword>
        <MadCap:keyword term="log statements:['embedded']">
        </MadCap:keyword>
        <p>Starting from version 3.0, syslog-ng can handle embedded log statements (also called log pipes). Embedded log statements are useful for creating complex, multi-level log paths with several destinations and use filters, parsers, and rewrite rules.</p>
        <p>For example, if you want to filter your incoming messages based on the facility parameter, and then use further filters to send messages arriving from different hosts to different destinations, you would use embedded log statements.</p>
        <p class="CaptionFigure">Embedded log statement</p>
        <img class="Image" src="../Images/Figures/fig-syslog-ng-embedded-log-statement-2.png" />
        <p>Embedded log statements include sources — and usually filters, parsers, rewrite rules, or destinations — and other log statements that can include filters, parsers, rewrite rules, and destinations. The following rules apply to embedded log statements:</p>
        <ul>
            <li>
                <p>Only the beginning (also called top-level) log statement can include sources.</p>
            </li>
            <li>
                <p>Embedded log statements can include multiple log statements on the same level (that is, a top-level log statement can include two or more log statements).</p>
            </li>
            <li>
                <p>Embedded log statements can include several levels of log statements (that is, a top-level log statement can include a log statement that includes another log statement, and so on).</p>
            </li>
            <li>
                <p>After an embedded log statement, you can write either another log statement, or the <span class="Code">flags()</span> option of the original log statement. You cannot use filters or other configuration objects. This also means that flags (except for the <span class="Code">flow-control</span> flag) apply to the entire log statement, you cannot use them only for the embedded log statement.</p>
            </li>
            <li>
                <p>Embedded log statements that are on the same level receive the same messages from the higher-level log statement. For example, if the top-level log statement includes a filter, the lower-level log statements receive only the messages that pass the filter.</p>
            </li>
        </ul>
        <p class="CaptionFigure">Embedded log statements</p>
        <img class="Image" src="../Images/Figures/fig-syslog-ng-embedded-log-statement.png" />
        <p>Embedded log filters can be used to optimize the processing of log messages, for example, to re-use the results of filtering and rewriting operations.</p>
    </body>
</html>