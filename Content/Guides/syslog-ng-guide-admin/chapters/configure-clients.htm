<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head>
    </head>
    <body name="configure-clients" oldrole="procedure">
        <h1 name="configure-clients"><a name="configure-clients"></a>Configuring syslog-ng on client hosts</h1>
        <MadCap:keyword term="syslog-ng clients:['configuring']">
        </MadCap:keyword>
        <h6 oldrole="formalpara">Purpose:</h6>
        <p oldrole="para">The following describes how to configure syslog-ng on a client host.</p>
        <div>
            <h6 oldrole="formalpara" MadCap:conditions="CommonConditions_DoNotEdit.DoNotPublish">Steps:</h6>
            <p class="Procedure">To configure syslog-ng on a client host</p>

            <ol oldrole="procedure">
                <li oldrole="step">
                    <p oldrole="para">Install the syslog-ng application on the host. For details installing syslog-ng on specific operating systems, see <MadCap:xref href="chapter-install.htm#chapter-install"><span style="color: #04aada;" class="mcFormatColor">Installing syslog-ng</span></MadCap:xref>.<MadCap:keyword term="configuration file:['default configuration']"></MadCap:keyword></p>
                </li>
                <li oldrole="step">
                    <p oldrole="para">Configure the local sources to collect the log messages of the host. Starting with version 3.2, <MadCap:variable name="General.abbrev"></MadCap:variable> automatically collects the log messages that use the native system logging method of the platform, for example, messages from <span class="Code" oldrole="filename">/dev/log</span> on Linux, or <span class="Code" oldrole="filename">/dev/klog</span> on FreeBSD. For a complete list of messages that are collected automatically, see <MadCap:xref href="configuring-source-system.htm#configuring-source-system"><span style="color: #04aada;" class="mcFormatColor">system: Collecting the system-specific log messages of a platform</span></MadCap:xref>.</p>
                    <p oldrole="para">Add sources to collect the messages from your log files. File sources look like this:</p><pre class="Code" oldrole="synopsis">source s_myfilesource {
        file("/var/log/myapplication.log" follow-freq(1)); };</pre>
                    <p oldrole="para">Name every source uniquely. For details on configuring file sources, see <MadCap:xref href="configuring-sources-file.htm#configuring-sources-file"><span style="color: #04aada;" class="mcFormatColor">file: Collecting messages from text files</span></MadCap:xref>.</p>
                    <table cellspacing="0" class="TableStyle-NoteTable_Blue_DoNotEdit" oldrole="tip" style="width: 100%;mc-table-style: url('../../../Resources/TableStyles/NoteTable_Blue_DoNotEdit.css');">
                        <col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column1" style="width: 0.3in;">
                        </col>
                        <col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column2">
                        </col>
                        <tbody>
                            <tr class="TableStyle-NoteTable_Blue_DoNotEdit-Body-Body1">
                                <td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyB-Column1-Body1">
                                    <p>
                                        <img src="../../../Resources/Images/Common/note.png" />
                                    </p>
                                </td>
                                <td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyA-Column2-Body1"><span class="AllNoteStyles">TIP: </span>
                                    <p oldrole="para">Many applications send log messages to logfiles by default (for example, the Roundcube webmail client, or the ProFTPD FTP server), but can be configured to send them to syslog instead. If possible, it is recommended to reconfigure the application that way.</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table cellspacing="0" class="TableStyle-NoteTable_Blue_DoNotEdit" oldrole="note" style="width: 100%;mc-table-style: url('../../../Resources/TableStyles/NoteTable_Blue_DoNotEdit.css');">
                        <col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column1" style="width: 0.3in;">
                        </col>
                        <col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column2">
                        </col>
                        <tbody>
                            <tr class="TableStyle-NoteTable_Blue_DoNotEdit-Body-Body1">
                                <td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyB-Column1-Body1">
                                    <p>
                                        <img src="../../../Resources/Images/Common/note.png" />
                                    </p>
                                </td>
                                <td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyA-Column2-Body1"><span class="AllNoteStyles">NOTE: </span>
                                    <p oldrole="para">The default configuration file of <MadCap:variable name="General.abbrev"></MadCap:variable> collects platform-specific log messages and the internal log messages of <MadCap:variable name="General.abbrev"></MadCap:variable>.</p><pre class="Code" oldrole="synopsis">source s_local {
        system();
        internal();
};</pre>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </li>
                <li oldrole="step">
                    <p oldrole="para">Create a network destination that points directly to the syslog-ng server, or to a local relay. The network destination greatly depends on the protocol that your log server or relay accepts messages. Many systems still use the legacy BSD-syslog protocol (RFC3162) over the unreliable UDP transport:</p><pre class="Code" oldrole="synopsis">destination d_network { network("10.1.2.3" transport("udp")); };</pre>
                    <p oldrole="para">However, if possible, use the much more reliable IETF-syslog protocol over TCP transport:</p><pre class="Code" oldrole="synopsis">destination d_network { syslog("10.1.2.3" transport("tcp")); };</pre>
                    <p oldrole="para">Make sure to use a destination that matches the source you configure on your syslog-ng server or relay. For details, see <MadCap:xref href="concepts-things-to-consider.htm#concepts-things-to-consider"><span style="color: #04aada;" class="mcFormatColor">Things to consider when forwarding messages between [%=General.abbrev%] hosts</span></MadCap:xref>.</p>
                </li>
                <li oldrole="step">
                    <p oldrole="para">Create a log statement connecting the local sources to the syslog-ng server or relay. For example:</p><pre class="Code" oldrole="synopsis">log {
        source(s_local); destination(d_network); };</pre>
                </li>
                <li oldrole="step">
                    <p oldrole="para">If the logs will also be stored locally on the host, create local file destinations.</p>
                    <table cellspacing="0" class="TableStyle-NoteTable_Blue_DoNotEdit" oldrole="note" style="width: 100%;mc-table-style: url('../../../Resources/TableStyles/NoteTable_Blue_DoNotEdit.css');">
                        <col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column1" style="width: 0.3in;">
                        </col>
                        <col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column2">
                        </col>
                        <tbody>
                            <tr class="TableStyle-NoteTable_Blue_DoNotEdit-Body-Body1">
                                <td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyB-Column1-Body1">
                                    <p>
                                        <img src="../../../Resources/Images/Common/note.png" />
                                    </p>
                                </td>
                                <td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyA-Column2-Body1"><span class="AllNoteStyles">NOTE: </span>
                                    <p oldrole="para">The default configuration of <MadCap:variable name="General.abbrev"></MadCap:variable> places the collected messages into the <span class="Code" oldrole="filename">/var/log/messages</span> file:</p><pre class="Code" oldrole="synopsis">destination d_local {
    file("/var/log/messages"); };</pre>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </li>
                <li oldrole="step">
                    <p oldrole="para">Create a log statement connecting the local sources to the file destination.</p>
                    <table cellspacing="0" class="TableStyle-NoteTable_Blue_DoNotEdit" oldrole="note" style="width: 100%;mc-table-style: url('../../../Resources/TableStyles/NoteTable_Blue_DoNotEdit.css');">
                        <col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column1" style="width: 0.3in;">
                        </col>
                        <col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column2">
                        </col>
                        <tbody>
                            <tr class="TableStyle-NoteTable_Blue_DoNotEdit-Body-Body1">
                                <td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyB-Column1-Body1">
                                    <p>
                                        <img src="../../../Resources/Images/Common/note.png" />
                                    </p>
                                </td>
                                <td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyA-Column2-Body1"><span class="AllNoteStyles">NOTE: </span>
                                    <p oldrole="para">The default configuration of <MadCap:variable name="General.abbrev"></MadCap:variable> has only one log statement:</p><pre class="Code" oldrole="synopsis">log {
    source(s_local); destination(d_local); };</pre>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </li>
                <li oldrole="step">
                    <p oldrole="para">Set filters, macros and other features and options (for example TLS encryption) as necessary.</p>
                    <div class="Example">
                        <h6 name="example-defaultconfig" oldrole="example"><a name="example-defaultconfig"></a>Example: The default configuration file of <MadCap:variable name="General.abbrev"></MadCap:variable></h6>
                        <MadCap:keyword term="configuration file:['default configuration']">
                        </MadCap:keyword>
                        <p oldrole="para">The following is the default configuration file of <MadCap:variable name="General.abbrev"></MadCap:variable> <MadCap:variable name="Version.version"></MadCap:variable>. It collects local log messages and the log messages of <MadCap:variable name="General.abbrev"></MadCap:variable> and saves them in the <span class="Code" oldrole="filename">/var/log/messages</span> file.</p><pre class="Code" oldrole="synopsis">@version: <MadCap:variable name="Version.configversion"></MadCap:variable>
@include "scl.conf"
source s_local { system(); internal(); };
destination d_local {
            file("/var/log/messages"); };
log { source(s_local); destination(d_local); };</pre>
                    </div>
                    <div class="Example">
                        <h6 name="example-clientconfig" oldrole="example"><a name="example-clientconfig"></a>Example: A simple configuration for clients</h6>
                        <p oldrole="para">The following is a simple configuration file that collects local log messages and forwards them to a logserver using the IETF-syslog protocol.</p><pre class="Code" oldrole="synopsis">@version: <MadCap:variable name="Version.configversion"></MadCap:variable>
@include "scl.conf"
source s_local { system(); internal(); };
destination d_syslog_tcp {
             syslog("192.168.1.1" transport("tcp") port(2010)); };
log { source(s_local);destination(d_syslog_tcp); };</pre>
                    </div>
                    <p oldrole="para">If you experience difficulties, see <MadCap:xref href="chapter-troubleshooting-syslog-ng.htm#chapter-troubleshooting-syslog-ng"><span style="color: #04aada;" class="mcFormatColor">Troubleshooting syslog-ng</span></MadCap:xref> for tips on solving common problems.</p>
                </li>
            </ol>
        </div>
    </body>
</html>