<?xml version="1.0" encoding="utf-8"?>
<!-- FIXME options should be restructured to simplesects -->
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head>
        <meta name="description" content="" />
    </head>
    <body name="rewrite-replace" oldrole="section">
        <h1 name="rewrite-replace">Replacing message parts</h1>
        <MadCap:keyword term="rewrite()">
        </MadCap:keyword>
        <MadCap:keyword term="subst()">
        </MadCap:keyword>
        <p>To replace a part of the log message, you have to:</p>
        <ul oldrole="itemizedlist">
            <li oldrole="listitem">
                <p>define a string or regular expression to find the text to replace</p>
            </li>
            <li oldrole="listitem">
                <p>define a string to replace the original text (macros can be used as well)</p>
            </li>
            <li oldrole="listitem">
                <p>select the field of the message that the rewrite rule should process</p>
            </li>
        </ul>
        <p>Substitution rules can operate on any soft macros, for example MESSAGE, PROGRAM, or any user-defined macros created using parsers. Hard macros cannot be modified. For details on the hard and soft macros, see <MadCap:xref href="macros-hard-vs-soft.htm#macros-hard-vs-soft"></MadCap:xref>). You can also rewrite the structured-data fields of messages complying to the RFC5424 (IETF-syslog) message format. Substitution rules use the following syntax:</p>
        <h6 oldrole="formalpara">Declaration:</h6><pre class="Code" oldrole="synopsis">rewrite &lt;name_of_the_rule&gt; {
    subst("&lt;string or regular expression to find&gt;",
        "&lt;replacement string&gt;", value(&lt;field name&gt;), flags() );
};</pre>
        <p>The <span class="Code" oldrole="parameter">type()</span> and <span class="Code" oldrole="parameter">flags()</span> options are optional. The <span class="Code" oldrole="parameter">type()</span> specifies the type of regular expression to use, while the <span class="Code" oldrole="parameter">flags()</span> are the flags of the regular expressions. For details on regular expressions, see <MadCap:xref href="regular-expressions.htm#regular-expressions"></MadCap:xref>.</p>
        <p>A single substitution rule can include multiple substitutions that are applied sequentially to the message. Note that rewriting rules must be included in the log statement to have any effect.</p>
        <table cellspacing="0" class="TableStyle-NoteTable_Blue_DoNotEdit" oldrole="tip" style="width: 100%;mc-table-style: url('../../../Resources/TableStyles/NoteTable_Blue_DoNotEdit.css');">
            <col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column1" style="width: 0.3in;">
            </col>
            <col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column2">
            </col>
            <tbody>
                <tr class="TableStyle-NoteTable_Blue_DoNotEdit-Body-Body1">
                    <td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyB-Column1-Body1">
                        <p>
                            <img src="../../../Resources/Images/Common/note.png" />
                        </p>
                    </td>
                    <td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyA-Column2-Body1"><span class="AllNoteStyles">TIP: </span>
                        <p>For case-insensitive searches, add the <span class="Code" oldrole="userinput">flags(ignore-case)</span> option. To replace every occurrence of the string, add <span class="Code" oldrole="userinput">flags(global)</span> option. Note that the <span class="Code" oldrole="parameter">store-matches</span> flag is automatically enabled in rewrite rules.</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <div class="Example">
            <h6 name="example-rewrite-subst" oldrole="example"><a name="example-rewrite-subst"></a>Example: Using substitution rules</h6>
            <p>The following example replaces the <span class="Code" oldrole="userinput">IP</span> in the text of the message with the string <span class="Code" oldrole="userinput">IP-Address</span>.</p><pre class="Code" oldrole="synopsis">rewrite r_rewrite_subst{subst("IP", "IP-Address", value("MESSAGE"));};</pre>
            <p>To replace every occurrence, use:</p><pre class="Code" oldrole="synopsis">rewrite r_rewrite_subst{
    subst("IP", "IP-Address", value("MESSAGE"), flags("global"));
};</pre>
            <p>Multiple substitution rules are applied sequentially. The following rules replace the first occurrence of the string <span class="Code" oldrole="userinput">IP</span> with the string <span class="Code" oldrole="userinput">IP-Addresses</span>.</p><pre class="Code" oldrole="synopsis">rewrite r_rewrite_subst{
    subst("IP", "IP-Address", value("MESSAGE"));
    subst("Address", "Addresses", value("MESSAGE"));
};</pre>
        </div>
        <MadCap:snippetBlock src="../../shared/chunk/example-rewrite-hash.htm">
        </MadCap:snippetBlock>
    </body>
</html>