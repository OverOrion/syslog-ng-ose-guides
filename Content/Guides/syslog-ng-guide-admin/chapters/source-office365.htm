<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head>
        <link href="../../../Resources/TableStyles/NoteTable_Yellow_DoNotEdit.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <link href="../../../Resources/TableStyles/RuledTableWithHeading_DoNotEdit.css" rel="stylesheet" MadCap:stylesheetType="table" />
    </head>
    <body name="source-office365" oldrole="section">
        <h1 name="source-office365">office365: Fetching logs from Office 365</h1>
        <MadCap:keyword term="Office 365">
        </MadCap:keyword>
        <MadCap:keyword term="Management Activity API">
        </MadCap:keyword>
        <MadCap:keyword term="source:['office365-azure-active-directory']">
        </MadCap:keyword>
        <MadCap:keyword term="source:['office365-exchange']">
        </MadCap:keyword>
        <MadCap:keyword term="source:['office365-general']">
        </MadCap:keyword>
        <MadCap:keyword term="source:['office365-sharepoint']">
        </MadCap:keyword>
        <MadCap:keyword term="source:['office365-dlp']">
        </MadCap:keyword>
        <MadCap:keyword term="source:['office365']">
        </MadCap:keyword>
        <p>Starting with <MadCap:variable name="General.abbrev"></MadCap:variable> version <MadCap:conditionaltext MadCap:conditions="General.pe">7.0.15</MadCap:conditionaltext>, you can fetch logs from your Office 365 account using the <a href="https://docs.microsoft.com/en-us/office/office-365-management-api/office-365-management-activity-api-reference">Office 365 Management Activity API</a>.</p>
        <MadCap:snippetBlock src="../../shared/wnt/warning-experimental-feature.htm">
        </MadCap:snippetBlock>
        <p>The <MadCap:variable name="General.abbrev"></MadCap:variable> application supports every content type of the Management Activity API using a corresponding source driver:</p>
        <ul>
            <li>
                <p><span class="Code">Audit.AzureActiveDirectory</span>: <span class="Code" oldrole="parameter">office365-azure-active-directory()</span></p>
            </li>
            <li>
                <p><span class="Code">Audit.Exchange</span>: <span class="Code" oldrole="parameter">office365-exchange()</span></p>
            </li>
            <li>
                <p><span class="Code">Audit.General</span>: <span class="Code" oldrole="parameter">office365-general()</span></p>
            </li>
            <li>
                <p><span class="Code">Audit.SharePoint</span>: <span class="Code" oldrole="parameter">office365-sharepoint()</span></p>
            </li>
            <li>
                <p><span class="Code">DLP.All</span>: <span class="Code" oldrole="parameter">office365-dlp()</span></p>
            </li>
        </ul>
        <div>
            <h6>Limitations</h6>
            <ul>
                <!-- FIXME experimental -->
                <li>
                    <p>In some cases, the logs will appear only 24-48 hours after successfully configuring <MadCap:variable name="General.abbrev"></MadCap:variable> and Office 365.</p>
                </li>
            </ul>
        </div>
        <div>
            <h6 oldrole="formalpara">Declaration</h6><pre class="Code" oldrole="synopsis">source s_office365 {
    office365-&lt;content-type&gt;(
        tenant_id('tenant-id')
        client_id('client-id')
        client_secret('client-secret')
    );
};</pre>
        </div>
        <div class="Example">
            <h6 oldrole="example">Example: Fetching Azure Active Directory logs from Office 365</h6>
            <p>The following example configuration fetches logs from and Audit.AzureActiveDirectory subscription using the <span class="Code" oldrole="parameter">office365-azure-active-directory()</span> source driver.</p><pre class="Code" oldrole="synopsis">@version: 7.0
@include "scl.conf"

source s_o365_ad {
    office365-azure-active-directory(
        tenant_id('tenant-id')
        client_id('client-id')
        client_secret('client-secret')
    );
};

destination d_file { file("/tmp/o365_ad_out.log"); };

log {
    source(s_o365_ad);
    destination(d_file);
    flags(flow-control);
};</pre>
        </div>
    </body>
</html>