<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head>
    </head>
    <body MadCap:conditions="General.ose" name="configuring-source-pacct" oldrole="section">
        <h1 MadCap:conditions="General.ose" name="configuring-source-pacct"><span class="Code" oldrole="parameter">pacct</span>: Collecting process accounting logs on Linux</h1>
        <MadCap:keyword term="process accounting">
        </MadCap:keyword>
        <MadCap:keyword term="pacct()">
        </MadCap:keyword>
        <MadCap:keyword term="pacct()">
        </MadCap:keyword>
        <MadCap:keyword term="source drivers:[&lt;span class=&quot;Code&quot; oldrole=&quot;parameter&quot;&gt;pacct()&lt;/span&gt;, ' driver']">
        </MadCap:keyword>
        <p oldrole="para">Starting with version <MadCap:conditionaltext MadCap:conditions="pe">4 F1</MadCap:conditionaltext><MadCap:conditionaltext MadCap:conditions="General.ose">3.2</MadCap:conditionaltext>, <MadCap:variable name="General.abbrev"></MadCap:variable> can collect process accounting logs on Linux systems.Process accounting is the method of recording and summarizing commands executed on Linux, for example, the commands being run, the user who executed the command, CPU time used by the process, exit code, and so on. When process accounting (also called pacct) is enabled on a system, the kernel writes accounting records to the <span class="Code" oldrole="filename">/var/log/account/pacct</span> file (might vary between different Linux distributions).</p>
        <p oldrole="para">To use the <span class="Code" oldrole="parameter">pacct()</span> driver, the following conditions must be met:</p>
        <ul oldrole="itemizedlist">
            <li oldrole="listitem">
                <p oldrole="para">The <MadCap:variable name="General.abbrev"></MadCap:variable> application must be compiled with the <span class="Code" oldrole="parameter">--enable-pacct</span> option. Execute the <b oldrole="command">syslog-ng -V</b> command to check if your binary supports process accounting.</p>
            </li>
            <li oldrole="listitem">
                <p oldrole="para">The <span class="Code" oldrole="parameter">pacctformat</span> plugin must be loaded. By default, <MadCap:variable name="General.abbrev"></MadCap:variable> automatically loads the available modules.</p>
            </li>
            <li oldrole="listitem">
                <p oldrole="para">The <span class="Code" oldrole="filename">scl.conf</span> file must be included in your syslog-ng configuration:<pre class="Code" oldrole="synopsis">@include "scl.conf"</pre></p>
            </li>
            <li oldrole="listitem">
                <p oldrole="para">Process accounting must be running on the host. You can enable it with the <b oldrole="command">accton</b> command.</p>
            </li>
        </ul>
        <p oldrole="para">The <span class="Code" oldrole="parameter">pacct()</span> driver parses the fields of the accounting logs and transforms them into name-value pairs. The fields are defined in the manual page of the accounting log file (<b oldrole="command">man acct</b>), <MadCap:variable name="General.abbrev"></MadCap:variable> prepends every field with the <span class="Code" oldrole="filename">.pacct.</span> prefix. For example, the <span class="Code" oldrole="userinput">ac_uid</span> field that contains the id of the user who started the process will be available under the <span class="Code" oldrole="userinput">$.pacct.ac_uid</span> name. These can be used as macros in templates, in filters to select specific messages, and so on.</p>
        <p oldrole="para">To use the <span class="Code" oldrole="parameter">pacct()</span> driver, use the following syntax.</p><pre class="Code" oldrole="synopsis">@version: <MadCap:variable name="Version.version"></MadCap:variable>
@include "scl.conf"
source s_pacct { pacct(); };
...
log { source(s_pacct); destination(...); };</pre>
        <p oldrole="para">The <span class="Code" oldrole="parameter">pacct()</span> driver is actually a reusable configuration snippet configured to handle Linux accounting logs. For details on using or writing such configuration snippets, see <MadCap:xref href="config-blocks.htm#config-blocks"></MadCap:xref>. You can find the source of the pacct configuration snippet on <a href="https://github.com/balabit/syslog-ng/blob/master/scl/pacct/plugin.conf">GitHub</a>.</p>
    </body>
</html>