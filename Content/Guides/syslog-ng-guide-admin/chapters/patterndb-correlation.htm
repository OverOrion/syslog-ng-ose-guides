<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!-- FIXME find a better title -->
<!-- FIXME describe the various ways patterndb can be used: message classification and tagging, content extraction, message correlation, ... -->
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><body name="patterndb-correlation" oldrole="section">
<h1 name="patterndb-correlation" xmlns="http://docbook.org/ns/docbook">Correlating log messages using pattern databases</h1>
<MadCap:keyword term="message correlation"></MadCap:keyword>
<MadCap:keyword term="correlating messages"></MadCap:keyword>
<MadCap:keyword term="pattern databases:['correlating messages']"></MadCap:keyword>
<MadCap:keyword term="message context"></MadCap:keyword>
<MadCap:keyword term="context of messages"></MadCap:keyword>
<p oldrole="para">The &abbrev; application can correlate log messages identified using <a href="chapter-patterndb.htm">pattern databases</a>. Alternatively, you can also correlate log messages using the <span class="Code" oldrole="parameter">grouping-by()</span> parser. For details, see <MadCap:xref href="grouping-by-parser.htm#grouping-by-parser"></MadCap:xref>.</p>
<MadCap:snippetBlock src="../../shared/chunk/correlation-intro.htm"></MadCap:snippetBlock>
<p oldrole="para">(For details on triggering actions and generating messages, see <MadCap:xref href="patterndb-triggers-actions.htm#patterndb-triggers-actions"></MadCap:xref>.)</p>
<p oldrole="para">There are two attributes for pattern database rules that determine if a message matching the rule is added to a context: <span class="Code" oldrole="parameter">context-scope</span> and <span class="Code" oldrole="parameter">context-id</span>. The <span class="Code" oldrole="parameter">context-scope</span> attribute acts as an early filter, selecting messages sent by the same process (${HOST}${PROGRAM}${PID} is identical), application (${HOST}${PROGRAM} is identical), or host, while the <span class="Code" oldrole="parameter">context-id</span> actually adds the message to the context specified in the id. The <span class="Code" oldrole="parameter">context-id</span> can be a simple string, or can contain macros or values extracted from the log messages for further filtering. If a message is added to a context, &abbrev; automatically adds the identifier of the context to the <span class="Code" oldrole="parameter">.classifier.context_id</span> macro of the message.</p>
<MadCap:snippetBlock src="../../shared/wnt/note-message-context.htm"></MadCap:snippetBlock>
<p oldrole="para">Another parameter of a rule is the <span class="Code" oldrole="parameter">context-timeout</span> attribute, which determines how long a context is stored, that is, how long &abbrev; waits for related messages to arrive.</p>
<MadCap:snippetBlock src="../../shared/chunk/correlation-context-timeout.htm"></MadCap:snippetBlock>
<div class="Example">
<h6 oldrole="example">Example: Using message correlation</h6>
<pre class="Code" oldrole="synopsis">&lt;rule xml:id="..." context-id="ssh-session" context-timeout="86400" context-scope="process"&gt;
    &lt;patterns&gt;
        &lt;pattern&gt;Accepted @ESTRING:usracct.authmethod: @for @ESTRING:usracct.username: @from @ESTRING:usracct.device: @port @ESTRING:: @@ANYSTRING:usracct.service@&lt;/pattern&gt;
    &lt;/patterns&gt;
...
&lt;/rule&gt;</pre>
</div>
<p oldrole="para">For details on configuring message correlation, see the <a href="reference-patterndb-schemes.htm">context-id, context-timeout, and context-scope</a> attributes of pattern database rules.</p>
</body></html>
