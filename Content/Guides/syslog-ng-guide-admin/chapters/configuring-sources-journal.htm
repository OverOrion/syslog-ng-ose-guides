<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head>
    </head>
    <body name="configuring-sources-journal" oldrole="section">
        <h1 name="configuring-sources-journal"><span class="Code" oldrole="parameter">systemd-journal</span>: Collecting messages from the systemd-journal system log storage</h1>
        <MadCap:keyword term="source drivers:[&lt;span class=&quot;Code&quot; oldrole=&quot;parameter&quot;&gt;systemd-journal()&lt;/span&gt;, ' driver']">
        </MadCap:keyword>
        <MadCap:keyword term="systemd-journal()">
        </MadCap:keyword>
        <p oldrole="para">The <span class="Code" oldrole="parameter">systemd-journal()</span> source is used on various Linux distributions, such as RHEL (from RHEL7) and CentOS. The <span class="Code" oldrole="parameter">systemd-journal()</span> source driver can read the structured name-value format of the journald system service, making it easier to reach the custom fields in the message. By default, <MadCap:variable name="General.abbrev"></MadCap:variable> adds the <span class="Code" oldrole="userinput">.journald.</span> prefix to the name of every parsed value.</p>
        <p oldrole="para">The <span class="Code" oldrole="parameter">systemd-journal()</span> source driver is designed to read only local messages through the systemd-journal API. It is not possible to set the location of the journal files, or the directories.</p>
        <table cellspacing="0" class="TableStyle-NoteTable_Blue_DoNotEdit" oldrole="note" style="width: 100%;mc-table-style: url('../../../Resources/TableStyles/NoteTable_Blue_DoNotEdit.css');">
            <col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column1" style="width: 0.3in;">
            </col>
            <col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column2">
            </col>
            <tbody>
                <tr class="TableStyle-NoteTable_Blue_DoNotEdit-Body-Body1">
                    <td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyB-Column1-Body1">
                        <p>
                            <img src="../../../Resources/Images/Common/note.png" />
                        </p>
                    </td>
                    <td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyA-Column2-Body1"><span class="AllNoteStyles">NOTE: </span>
                        <p oldrole="para">The <span class="Code" oldrole="parameter">log-msg-size()</span> option is not applicable for this source. Use the <span class="Code" oldrole="parameter">max-field-size()</span> option instead.</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <table cellspacing="0" class="TableStyle-NoteTable_Blue_DoNotEdit" oldrole="note" style="width: 100%;mc-table-style: url('../../../Resources/TableStyles/NoteTable_Blue_DoNotEdit.css');">
            <col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column1" style="width: 0.3in;">
            </col>
            <col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column2">
            </col>
            <tbody>
                <tr class="TableStyle-NoteTable_Blue_DoNotEdit-Body-Body1">
                    <td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyB-Column1-Body1">
                        <p>
                            <img src="../../../Resources/Images/Common/note.png" />
                        </p>
                    </td>
                    <td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyA-Column2-Body1"><span class="AllNoteStyles">NOTE: </span>
                        <p oldrole="para">This source will not handle the following cases:</p>
                        <ul oldrole="itemizedlist">
                            <li oldrole="listitem">
                                <p oldrole="para">corrupted journal file</p>
                            </li>
                            <li oldrole="listitem">
                                <p oldrole="para">incorrect journal configuration</p>
                            </li>
                            <li oldrole="listitem">
                                <p oldrole="para">any other journald-related bugs</p>
                            </li>
                        </ul>
                    </td>
                </tr>
            </tbody>
        </table>
        <table cellspacing="0" class="TableStyle-NoteTable_Blue_DoNotEdit" oldrole="note" style="width: 100%;mc-table-style: url('../../../Resources/TableStyles/NoteTable_Blue_DoNotEdit.css');">
            <col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column1" style="width: 0.3in;">
            </col>
            <col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column2">
            </col>
            <tbody>
                <tr class="TableStyle-NoteTable_Blue_DoNotEdit-Body-Body1">
                    <td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyB-Column1-Body1">
                        <p>
                            <img src="../../../Resources/Images/Common/note.png" />
                        </p>
                    </td>
                    <td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyA-Column2-Body1"><span class="AllNoteStyles">NOTE: </span>
                        <p oldrole="para">If you are using RHEL-7, the default source in the configuration is <span class="Code" oldrole="parameter">systemd-journal()</span> instead of <span class="Code" oldrole="userinput">unix-dgram("/dev/log")</span> and <span class="Code" oldrole="userinput">file("/proc/kmsg")</span>. If you are using <span class="Code" oldrole="userinput">unix-dgram("/dev/log")</span> or <span class="Code" oldrole="userinput">unix-stream("/dev/log")</span> in your configuration as a source, <MadCap:variable name="General.abbrev"></MadCap:variable> will revert to using <span class="Code" oldrole="parameter">systemd-journal()</span> instead.</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <table cellspacing="0" class="TableStyle-NoteTable_Yellow_DoNotEdit" oldrole="warning" style="width: 100%;mc-table-style: url('../../../Resources/TableStyles/NoteTable_Yellow_DoNotEdit.css');">
            <col class="TableStyle-NoteTable_Yellow_DoNotEdit-Column-Column1" style="width: 0.3in;">
            </col>
            <col class="TableStyle-NoteTable_Yellow_DoNotEdit-Column-Column2">
            </col>
            <tbody>
                <tr class="TableStyle-NoteTable_Yellow_DoNotEdit-Body-Body1">
                    <td class="TableStyle-NoteTable_Yellow_DoNotEdit-BodyB-Column1-Body1">
                        <p>
                            <img src="../../../Resources/Images/Common/caution.png" />
                        </p>
                    </td>
                    <td class="TableStyle-NoteTable_Yellow_DoNotEdit-BodyA-Column2-Body1"><span class="Yellow">Caution: </span>
                        <p oldrole="para">Only one <span class="Code" oldrole="parameter">systemd-journal()</span> source can be configured in the configuration file. If there are more than one <span class="Code" oldrole="parameter">systemd-journal()</span> sources configured, <MadCap:variable name="General.abbrev"></MadCap:variable> will not start.</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <h6 oldrole="formalpara">Declaration:</h6><pre class="Code" oldrole="synopsis">systemd-journal(options);</pre>
        <div class="Example">
            <h6 name="example-source-journal-allfields" oldrole="example">Example: Sending all fields through syslog protocol using the systemd-journal() driver</h6>
            <p oldrole="para">To send all fields through the syslog protocol, enter the prefix in the following format: "<span class="Code" oldrole="userinput">.SDATA.&lt;name&gt;</span>".</p><pre class="Code" oldrole="synopsis">@version: <MadCap:variable name="syslogngPEVariables.Version"></MadCap:variable>

source s_journald {
	systemd-journal(prefix(".SDATA.journald."));
};

destination d_network {
	syslog("server.host");
};

log {
	source(s_journald);
	destination(d_network);
};</pre>
        </div>
        <div class="Example">
            <h6 name="example-source-journal-filtering" oldrole="example">Example: Filtering for a specific field using the systemd-journal() driver</h6><pre class="Code" oldrole="synopsis">@version: <MadCap:variable name="syslogngPEVariables.Version"></MadCap:variable>

source s_journald {
	systemd-journal(prefix(".SDATA.journald."));
};

filter f_uid {"${.SDATA.journald._UID}" eq "1000"};

destination d_network {
	syslog("server.host");
};

log {
	source(s_journald);
	filter(f_uid);
	destination(d_network);
};</pre>
        </div>
        <div class="Example">
            <h6 name="example-source-journal-valuepairs" oldrole="example">Example: Sending all fields in value-pairs using the systemd-journal() driver</h6><pre class="Code" oldrole="synopsis">@version: <MadCap:variable name="syslogngPEVariables.Version"></MadCap:variable>

source s_local {
	systemd-journal(prefix("journald."));
};

destination d_network {
	network("server.host" template("$(format_json --scope rfc5424 --key journald.*)\n"));
};

log {
	source(s_local);
	destination(d_network);
};</pre>
        </div>
        <p oldrole="para">The journal contains credential information about the process that sent the log message. The <MadCap:variable name="General.abbrev"></MadCap:variable> application makes this information available in the following macros:</p>
        <MadCap:snippetBlock src="infotable-journald.htm">
        </MadCap:snippetBlock>
    </body>
</html>