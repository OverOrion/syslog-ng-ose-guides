<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:conditions="General.OSE">
    <head>
        <link href="../../../Resources/TableStyles/RuledTableWithHeading_DoNotEdit.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <link href="../../../Resources/TableStyles/NoteTable_Yellow_DoNotEdit.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <meta name="description" content="" />
    </head>
    <body condition="ose" name="source-system">
        <h1 condition="ose" name="source-system">system: Collecting the system-specific log messages of a platform</h1>
        <MadCap:keyword term="system()">
        </MadCap:keyword>
        <MadCap:keyword term="source drivers:[&lt;span class=&quot;Code&quot; oldrole=&quot;parameter&quot;&gt;system()&lt;/span&gt;, ' driver']">
        </MadCap:keyword>
        <MadCap:keyword term="scl:[&lt;span class=&quot;Code&quot; oldrole=&quot;parameter&quot;&gt;system()&lt;/span&gt;]">
        </MadCap:keyword>
        <p>Starting with version <MadCap:conditionaltext MadCap:conditions="General.PE">4 F1</MadCap:conditionaltext><MadCap:conditionaltext MadCap:conditions="General.OSE">3.2</MadCap:conditionaltext>, <MadCap:variable name="General.OSE"></MadCap:variable> can automatically collect the system-specific log messages of the host on a number of platforms using the <span class="Code" oldrole="parameter">system()</span> driver. If the <span class="Code" oldrole="parameter">system()</span> driver is included in the <MadCap:variable name="General.OSE"></MadCap:variable> configuration file, <MadCap:variable name="General.OSE"></MadCap:variable> automatically adds the following sources to the <MadCap:variable name="General.OSE"></MadCap:variable> configuration.</p>
		<div class="Note">
			<p class="Hyphenation"><span class="AllNoteStyles">NOTE:</span>  <MadCap:variable name="General.OSE"></MadCap:variable> versions <MadCap:conditionaltext MadCap:conditions="General.PE">4.1-5.0</MadCap:conditionaltext><MadCap:conditionaltext MadCap:conditions="General.OSE">3.2-3.3</MadCap:conditionaltext> used an external script to generate the <span class="Code" oldrole="parameter">system()</span> source, but this was problematic in certain situations, for example, when the host used a strict AppArmor profile. Therefore, the <span class="Code" oldrole="parameter">system()</span> source is now generated internally in <MadCap:variable name="General.OSE"></MadCap:variable>.</p>
        </div>
        <p>The <span class="Code" oldrole="parameter">system()</span> driver is also used in the default configuration file of <MadCap:variable name="General.OSE"></MadCap:variable>. For details on the default configuration file, see <MadCap:xref href="configure-clients.htm#example-defaultconfig"><span style="color: #04aada;" class="mcFormatColor">Example: The default configuration file of [%=General.OSE%]</span></MadCap:xref>. Starting with <MadCap:variable name="General.OSE"></MadCap:variable> version <MadCap:conditionaltext MadCap:conditions="General.OSE">3.6</MadCap:conditionaltext>, you can use the <span class="Code" oldrole="command">system-expand</span> command-line utility (which is a shell script, located in the <span class="Code">modules/system-source/</span> directory) to display the configuration that the <span class="Code" oldrole="parameter">system()</span> source will use.</p>
        <table cellspacing="0" class="TableStyle-NoteTable_Yellow_DoNotEdit" style="width: 100%;mc-table-style: url('../../../Resources/TableStyles/NoteTable_Yellow_DoNotEdit.css');">
            <col class="TableStyle-NoteTable_Yellow_DoNotEdit-Column-Column1" style="width: 0.3in;">
            </col>
            <col class="TableStyle-NoteTable_Yellow_DoNotEdit-Column-Column2">
            </col>
            <tbody>
                <tr class="TableStyle-NoteTable_Yellow_DoNotEdit-Body-Body1">
                    <td class="TableStyle-NoteTable_Yellow_DoNotEdit-BodyB-Column1-Body1">
                        <p>
                            <img src="../../../Resources/Images/Common/caution.png" />
                        </p>
                    </td>
                    <td class="TableStyle-NoteTable_Yellow_DoNotEdit-BodyA-Column2-Body1"><span class="Yellow">Caution: </span>
                        <p>If <MadCap:variable name="General.OSE"></MadCap:variable> does not recognize the platform it is installed on, it does not add any sources.</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <p>Starting with version <MadCap:conditionaltext MadCap:conditions="General.OSE">3.6</MadCap:conditionaltext>, <MadCap:variable name="General.OSE"></MadCap:variable> parses messages complying with the <a href="http://docs.splunk.com/Documentation/CIM/latest/User/Overview">Splunk Common Information Model (CIM)</a> and marked with <span class="Code" oldrole="userinput">@cim</span> as JSON messages (for example, the ulogd from the netfilter project can emit such messages). That way, you can forward such messages without losing any information to CIM-aware applications (for example, Splunk).</p>
        <MadCap:keyword term="Common Information Model (CIM)">
        </MadCap:keyword>
        <MadCap:keyword term="JSON:['Common Information Model (CIM)']">
        </MadCap:keyword>
        <MadCap:keyword term="CIM">
        </MadCap:keyword>
        <MadCap:keyword term="@cim">
        </MadCap:keyword>
        <table cellspacing="0" class="TableStyle-RuledTableWithHeading_DoNotEdit" style="width: 100%;mc-table-style: url('../../../Resources/TableStyles/RuledTableWithHeading_DoNotEdit.css');">
            <caption MadCap:autonum="Table 1: ">Sources automatically added by <MadCap:variable name="General.product"></MadCap:variable></caption>
            <thead>
                <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Head-Header1">
                    <th class="TableStyle-RuledTableWithHeading_DoNotEdit-HeadE-Column1-Header1">Platform</th>
                    <th class="TableStyle-RuledTableWithHeading_DoNotEdit-HeadD-Column1-Header1">Message source</th>
                </tr>
            </thead>
            <tbody>
                <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                    <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyE-Column1-Body1">AIX</td>
                    <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyD-Column1-Body1"><pre>unix-dgram("/dev/log");</pre>
                    </td>
                </tr>
                <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                    <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyE-Column1-Body1">FreeBSD</td>
                    <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyD-Column1-Body1"><pre>unix-dgram("/var/run/log");</pre><pre>unix-dgram("/var/run/logpriv" perm(0600));</pre><pre>file("/dev/klog" follow-freq(0) program-override("kernel") flags(no-parse));</pre>
                        <p>For FreeBSD versions earlier than 9.1, <span class="Code" oldrole="parameter">follow-freq(1)</span> is used.</p>
                    </td>
                </tr>
                <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                    <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyE-Column1-Body1">GNU/kFreeBSD</td>
                    <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyD-Column1-Body1"><pre>unix-dgram("/var/run/log");</pre><pre>file("/dev/klog" follow-freq(0) program-override("kernel"));</pre>
                    </td>
                </tr>
                <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                    <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyE-Column1-Body1">HP-UX</td>
                    <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyD-Column1-Body1"><pre>pipe("/dev/log" pad-size(2048));</pre>
                    </td>
                </tr>
                <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                    <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyE-Column1-Body1">Linux</td>
                    <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyD-Column1-Body1"><pre>unix-dgram("/dev/log");</pre><pre>file("/proc/kmsg" program-override("kernel") flags(kernel));</pre>
                        <p>Note that on Linux, the <span class="Code" oldrole="parameter">so-rcvbuf()</span> option of the <span class="Code" oldrole="parameter">system()</span> source is automatically set to 8192.</p>
                        <MadCap:keyword term="systemd">
                        </MadCap:keyword>
                        <p>If the host is running under systemd, <MadCap:variable name="General.OSE"></MadCap:variable> reads directly from the systemd journal file using the <span class="Code" oldrole="parameter">systemd-journal()</span> source.</p>
                        <MadCap:keyword term="multiline:['indented-multiline']">
                        </MadCap:keyword>
                        <MadCap:keyword term="kmsg">
                        </MadCap:keyword>
                        <p>If the kernel of the host is version 3.5 or newer, and <span class="Code">/dev/kmsg</span> is seekable, <MadCap:variable name="General.OSE"></MadCap:variable> will use that instead of <span class="Code">/proc/kmsg</span>, using the <span class="Code" oldrole="parameter">multi-line-mode(indented)</span>, <span class="Code" oldrole="parameter">keep-timestamp(no)</span>, and the <span class="Code" oldrole="parameter">format(linux-kmsg)</span> options.</p>
                        <p>If <MadCap:variable name="General.OSE"></MadCap:variable> is running in a jail or a Linux Container (LXC), it will not read from the <span class="Code">/dev/kmsg</span> or <span class="Code">/proc/kmsg</span> files.</p>
                    </td>
                </tr>
                <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                    <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyE-Column1-Body1">Solaris 8</td>
                    <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyD-Column1-Body1"><pre>sun-streams("/dev/log");</pre>
                        <MadCap:snippetBlock src="../../shared/wnt/note-solaris-msgid.htm">
                        </MadCap:snippetBlock>
                    </td>
                </tr>
                <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                    <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyE-Column1-Body1">Solaris 9</td>
                    <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyD-Column1-Body1"><pre>sun-streams("/dev/log" door("/etc/.syslog_door"));</pre>
                        <MadCap:snippetBlock src="../../shared/wnt/note-solaris-msgid.htm">
                        </MadCap:snippetBlock>
                    </td>
                </tr>
                <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                    <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyB-Column1-Body1">Solaris 10</td>
                    <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyA-Column1-Body1"><pre>sun-streams("/dev/log" door("/var/run/syslog_door"));</pre>
                        <MadCap:snippetBlock src="../../shared/wnt/note-solaris-msgid.htm">
                        </MadCap:snippetBlock>
                    </td>
                </tr>
            </tbody>
            <col class="TableStyle-RuledTableWithHeading_DoNotEdit-Column-Column1" style="width: 0.3in;">
            </col>
        </table>
    </body>
</html>