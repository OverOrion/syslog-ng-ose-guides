<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <body name="log-statistics-description" oldrole="section">
        <h1 name="log-statistics-description">Metrics and counters of <MadCap:variable name="General.abbrev"></MadCap:variable></h1>
        <p oldrole="para">You can list all active metrics on your <MadCap:variable name="General.abbrev"></MadCap:variable> host using the following command (this lists the metrics, without their current values): <span class="Code" oldrole="command">syslog-ng-ctl query list "*"</span></p>
        <p oldrole="para">To list the metrics and their values, use the following command: <span class="Code" oldrole="command">syslog-ng-ctl query get "*"</span></p>
        <p oldrole="para">The displayed metrics have the following structure.</p>
        <ol oldrole="orderedlist">
            <li oldrole="listitem">
                <p oldrole="para">The type of the object (for example <span class="Code" oldrole="userinput">dst.file</span>, <span class="Code" oldrole="userinput">tag</span>, <span class="Code" oldrole="userinput">src.facility</span>)</p>
            </li>
            <li oldrole="listitem">
                <p oldrole="para">The ID of the object used in the syslog-ng configuration file, for example <span class="Code" oldrole="userinput">d_internal</span> or <span class="Code" oldrole="userinput">source.src_tcp</span>. The <span class="Code" oldrole="userinput">#0</span> part means that this is the first destination in the destination group.</p>
            </li>
            <li oldrole="listitem">
                <p oldrole="para">The instance ID (destination) of the object, for example the filename of a file destination, or the name of the application for a program source or destination.</p>
            </li>
            <li oldrole="listitem">
                <p oldrole="para">The status of the object. One of the following:</p>
                <ul oldrole="itemizedlist">
                    <li oldrole="listitem">
                        <p oldrole="para"><span class="Code" oldrole="userinput">a</span> - active. At the time of quering the statistics, the source or the destination was still alive (it continuously received statistical data).</p>
                    </li>
                    <li oldrole="listitem">
                        <p oldrole="para"><span class="Code" oldrole="userinput">d</span> - dynamic. Such objects may not be continuously available, for example, like statistics based on the sender's hostname. These counters only appear above a certain value of <span class="Code" oldrole="parameter">stats-level()</span> global option:</p>
                        <ul oldrole="itemizedlist">
                            <li oldrole="listitem">
                                <p oldrole="para"><span class="Code" oldrole="parameter">host</span>: source host, from <span class="Code" oldrole="userinput">stats-level(2)</span></p>
                            </li>
                            <li oldrole="listitem">
                                <p oldrole="para"><span class="Code" oldrole="parameter">sender</span>: sender host, from <span class="Code" oldrole="userinput">stats-level(3)</span></p>
                            </li>
                            <li oldrole="listitem">
                                <p oldrole="para"><span class="Code" oldrole="parameter">program</span>: program, from <span class="Code" oldrole="userinput">stats-level(3)</span></p>
                            </li>
                        </ul>
                        <div class="Example">
                            <h6 oldrole="example">Example: Dynamic counters</h6>
                            <p oldrole="para">The following example contains 6 different dynamic values: a sender, a host, and four different programs.</p><pre class="Code" oldrole="synopsis">src.sender;;localhost;d;processed;4
src.sender;;localhost;d;stamp;1509121934
src.program;;P-18069;d;processed;1
src.program;;P-18069;d;stamp;1509121933
src.program;;P-21491;d;processed;1
src.program;;P-21491;d;stamp;1509121934
src.program;;P-9774;d;processed;1
src.program;;P-9774;d;stamp;1509121919
src.program;;P-14737;d;processed;1
src.program;;P-14737;d;stamp;1509121931
src.host;;localhost;d;processed;4
src.host;;localhost;d;stamp;1509121934</pre>
                        </div>
                        <p oldrole="para">To avoid performance issues or even overloading <MadCap:variable name="General.abbrev"></MadCap:variable>, you might want to limit the number of registered dynamic counters in the message statistics. To do this, configure the <MadCap:xref href="reference-options.htm#global-option-stats-max-dynamics"></MadCap:xref> global option.</p>
                    </li>
                    <li oldrole="listitem">
                        <p oldrole="para"><span class="Code" oldrole="userinput">o</span> - This object was once active, but stopped receiving messages. (For example a dynamic object may disappear and become orphan.)</p>
                        <table cellspacing="0" class="TableStyle-NoteTable_Blue_DoNotEdit" oldrole="note" style="width: 100%;mc-table-style: url('../../../Resources/TableStyles/NoteTable_Blue_DoNotEdit.css');">
                            <col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column1" style="width: 0.3in;">
                            </col>
                            <col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column2">
                            </col>
                            <tbody>
                                <tr class="TableStyle-NoteTable_Blue_DoNotEdit-Body-Body1">
                                    <td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyB-Column1-Body1">
                                        <p>
                                            <img src="../../../Resources/Images/Common/note.png" />
                                        </p>
                                    </td>
                                    <td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyA-Column2-Body1"><span class="AllNoteStyles">NOTE: </span>
                                        <p oldrole="para">The <MadCap:variable name="General.abbrev"></MadCap:variable> application stores the statistics of the objects when <MadCap:variable name="General.abbrev"></MadCap:variable> is reloaded. However, if the configuration of <MadCap:variable name="General.abbrev"></MadCap:variable> was changed since the last reload, the statistics of orphaned objects are deleted.</p>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </li>
                </ul>
            </li>
            <li oldrole="listitem">
                <p oldrole="para">The type of the statistics:</p>
                <ul oldrole="itemizedlist">
                    <li oldrole="listitem">
                        <p oldrole="para"><span class="Code" oldrole="parameter">processed</span>: The number of messages that successfully reached their destination driver. Note that this does not necessarily mean that the destination driver successfully delivered the messages (for example, written to disk or sent to a remote server).</p>
                    </li>
                    <li oldrole="listitem">
                        <p oldrole="para"><span class="Code" oldrole="parameter">dropped</span>: The number of dropped messages — <MadCap:variable name="General.abbrev"></MadCap:variable> could not send the messages to the destination and the output buffer got full, so messages were dropped by the destination driver, or <MadCap:variable name="General.abbrev"></MadCap:variable> dropped the message for some other reason (for example, a parsing error).</p>
                    </li>
                    <li oldrole="listitem">
                        <p oldrole="para"><span class="Code" oldrole="parameter">queued</span>: The number of messages passed to the message queue of the destination driver, waiting to be sent to the destination.</p>
                    </li>
                    <li oldrole="listitem">
                        <p oldrole="para"><span class="Code" oldrole="parameter">suppressed</span>: The number of suppressed messages (if the <span class="Code" oldrole="parameter">suppress()</span> feature is enabled).</p>
                    </li>
                    <li oldrole="listitem">
                        <p oldrole="para"><span class="Code" oldrole="parameter">stamp</span>: The UNIX timestamp of the last message sent to the destination.</p>
                    </li>
                    <li oldrole="listitem">
                        <p oldrole="para"><span class="Code" oldrole="parameter">discarded</span>: The number of messages discarded by the given parser. These are messages that the parser could not parsed, and are therefore not processed. For example:</p><pre class="Code" oldrole="synopsis">parser;demo_parser;;a;discarded;20</pre>
                    </li>
                    <li oldrole="listitem">
                        <p oldrole="para"><span class="Code" oldrole="parameter">memory_usage</span>: The memory used by the messages in the different queue types (in bytes). This includes every queue used by the object, including memory buffers (log-fifo) and disk-based buffers (both reliable and non-reliable). For example:</p><pre class="Code" oldrole="synopsis">dst.network;d_net#0;tcp,127.0.0.1:9999;a;memory_usage;0</pre>
                        <p oldrole="para">Note that the memory usage (size) of queues does not equal to the memory usage (size) of the log messages in <MadCap:variable name="General.abbrev"></MadCap:variable>. A log message can be in multiple queues, thus its size is added to multiple queue sizes. To check the size of all log messages, use <span class="Code" oldrole="parameter">global.msg_allocated_bytes.value</span> metric.</p>
                    </li>
                    <li oldrole="listitem">
                        <p oldrole="para"><span class="Code" oldrole="parameter">matched</span>: The number of messages that are accepted by a given filter. Available for filters and similar objects (for example, a conditional rewrite rule). For example, if a filter matches a specific hostname, then the <span class="Code" oldrole="parameter">matched</span> counter contains the number of messages that reached the filter from this hosts.</p><pre class="Code" oldrole="synopsis">filter;demo_filter;;a;matched;28</pre>
                    </li>
                    <li oldrole="listitem">
                        <p oldrole="para"><span class="Code" oldrole="parameter">not_matched</span>: The number of messages that are filtered out by a given filter. Available for filters and similar objects (for example, a conditional rewrite rule). For example, if a filter matches a specific hostname, then the <span class="Code" oldrole="parameter">not_matched</span> counter contains the number of messages that reached the filter from other hosts, and so the filter discarded them. Note that since the <span class="Code" oldrole="parameter">not_matched</span> metric applies to filters, and filters are expected to discard messages that do not match the filter condition, <span class="Code" oldrole="parameter">not_matched</span> messages are not included in the <span class="Code" oldrole="parameter">dropped</span> metric of other objects.</p><pre class="Code" oldrole="synopsis">filter;demo_filter;;a;not_matched;0</pre>
                    </li>
                    <li oldrole="listitem">
                        <p oldrole="para"><span class="Code" oldrole="parameter">written</span>: The number of messages successfully delivered to the destination. This value is calculated from other counters: <span class="Code" oldrole="userinput">written = processed - queued - dropped</span>. That is, the number of messages <MadCap:variable name="General.abbrev"></MadCap:variable> passed to the destination driver (processed) minus the number of messages that are still in the output queue of the destination driver (queued) and the number of messages dropped because of an error (dropped, for example, because <MadCap:variable name="General.abbrev"></MadCap:variable> could not deliver the message to the destination and exceeded the number of retries).</p>
                        <MadCap:snippetBlock src="../../shared/chunk/para-metrics-calculated-reset.htm">
                        </MadCap:snippetBlock>
                    </li>
                </ul>
            </li>
            <li oldrole="listitem">
                <p oldrole="para">The number of such messages.</p>
            </li>
        </ol>
        <h6 oldrole="simplesect">Availability of statistics</h6>
        <p oldrole="para">Certain statistics are available only if the <a href="reference-options.htm"><span class="Code" oldrole="parameter">stats-level()</span> global option</a> is set to a higher value.</p>
        <MadCap:snippetBlock src="../../shared/chunk/option-stats-level-description.htm">
        </MadCap:snippetBlock>
        <p oldrole="para">When receiving messages with non-standard facility values (that is, higher than 23), these messages will be listed as <span class="Code" oldrole="parameter">other</span> facility instead of their facility number.</p>
    </body>
</html>