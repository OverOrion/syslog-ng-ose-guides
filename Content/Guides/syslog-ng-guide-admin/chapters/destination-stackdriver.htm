<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head>
        <link href="../../../Resources/TableStyles/NoteTable_Yellow_DoNotEdit.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <link href="../../../Resources/TableStyles/RuledTableWithHeading_DoNotEdit.css" rel="stylesheet" MadCap:stylesheetType="table" />
    </head>
    <body name="destinations-stackdriver" oldrole="section">
        <h1 name="destinations-stackdriver">stackdriver: Sending logs to the Google Stackdriver cloud</h1>
        <MadCap:keyword term="destination drivers:['stackdriver()']">
        </MadCap:keyword>
        <MadCap:keyword term="destination drivers:['stackdriver']">
        </MadCap:keyword>
        <p oldrole="para">The <span class="Code" oldrole="parameter">stackdriver</span> destination of <MadCap:variable name="General.abbrev"></MadCap:variable> can send log messages to the <a href="https://cloud.google.com/stackdriver/">Google Stackdriver cloud</a>. Google Stackdriver is a widely used metrics, event, and log aggregator and analyzer system. The <span class="Code" oldrole="parameter">stackdriver</span> destination is available in <MadCap:variable name="General.abbrev"></MadCap:variable> version <MadCap:conditionaltext MadCap:conditions="General.pe">7.0.14</MadCap:conditionaltext> and later.</p>
        <div>
            <h6>How the <span class="Code" oldrole="parameter">stackdriver</span> destination works</h6>
            <p>The <span class="Code" oldrole="parameter">stackdriver</span> destination uses the HTTP REST API to perform OAuth2 authentication to Google Stackdriver, and obtains an access token from Stackdriver using the key specified in a JSON file. This access token is required to send logs to Stackdriver using the <a href="https://cloud.google.com/logging/docs/reference/v2/rest/">Stackdriver Logging API</a>.</p>

            <MadCap:snippetBlock src="../../shared/chunk/destination-stackdriver-service-key.htm">
            </MadCap:snippetBlock>

            <p>By default, <MadCap:variable name="General.abbrev"></MadCap:variable> uses the default system CA certificate store to validate the certificate sent by Google Stackdriver. If the Certificate Authority of the certificate sent by Google Stackdriver is not available on your host, you must download the CA certificate and add it to the certificate store. The location of the certificate store depends on your platform, usually one of <span class="Code" oldrole="filename">/etc/ssl/certs/</span>, <span class="Code" oldrole="filename">/etc/pki/ca-trust/</span>, <span class="Code" oldrole="filename">/etc/pki/tls/certs/</span>, or a similar location.</p>
        </div>
        <div>
            <h6>Limitations</h6>
            <ul>
                <li>
                    <p>The <span class="Code" oldrole="parameter">log_id()</span> option of the destination currently does not support macros or templates, only strings. As a result, the every log entry has the same log id.</p>
                </li>
                <li>
                    <MadCap:snippetBlock src="../../shared/chunk/destination-stackdriver-supported-resource-types.htm">
                    </MadCap:snippetBlock>
                </li>
                <li>
                    <p>Each <MadCap:variable name="General.abbrev"></MadCap:variable> <span class="Code" oldrole="parameter">stackdriver</span> destination can use only one resource type. If you want to send logs using multiple resource types, you must configure multiple <span class="Code" oldrole="parameter">stackdriver</span> destinations.</p>
                </li>
                <li>
                    <MadCap:snippetBlock src="../../shared/chunk/destination-stackdriver-underscore.htm">
                    </MadCap:snippetBlock>
                </li>
            </ul>
        </div>
        <div>
            <h6 oldrole="formalpara">Declaration:</h6>
            <pre class="Code" oldrole="synopsis">destination d_stackdriver {
  stackdriver(
    gcp_auth_header(
      credentials("&lt;path-to-the-service.json&gt;")
    )
    log_id("&lt;folder-name-for-logs-in-stackdriver&gt;")
    resource(
      project_id("&lt;identifier-of-the-GCP-project&gt;")
      &lt;parameters-of-the-monitored-resource&gt;
    )
  );
};</pre>
        </div>
        <div class="Example">
            <h6 oldrole="example">Example: Sending log messages to Google Stackdriver</h6>
            <p>Using a <span class="Code" oldrole="parameter">generic_node</span> resource type to send log messages to Google Stackdriver</p>
            <pre class="Code" oldrole="synopsis">destination d_stackdriver {
  stackdriver(
    gcp_auth_header(
      credentials("/opt/syslog-ng/etc/service.json")
    )
    log_id("123456")
    resource(
      generic_node(
        project_id("my-test-project")
        location("EU/Budapest")
        namespace("my cluster")
        node_id("$HOST")
      )
    )
    [...]
  );
};</pre>
        </div>
        <div id="stackdriver-batch-mode">
            <MadCap:snippetBlock src="../../shared/chunk/concept-batch-size.htm">
            </MadCap:snippetBlock>
        </div>
    </body>
</html>