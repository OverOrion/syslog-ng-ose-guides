<?xml version="1.0" encoding="utf-8"?>
<html>
    <head>
        <link href="../../../Resources/TableStyles/NoteTable_Yellow_DoNotEdit.css" rel="stylesheet" MadCap:stylesheetType="table" xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" />
    </head>
    <body name="procedure-upgrading-to-pe" oldrole="procedure">
        <h1 name="procedure-upgrading-to-pe"><a name="procedure-upgrading-to-pe"></a>Upgrading from <MadCap:variable name="General.abbrev" xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" /> 6.0.x to version <MadCap:variable name="Version.version" xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" /></h1>
        <h6 oldrole="formalpara" MadCap:conditions="CommonConditions_DoNotEdit.DoNotPublish" xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Purpose</h6>
        <p oldrole="para">The following describes how to upgrade to <MadCap:variable name="General.abbrev" xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" /> <MadCap:variable name="Version.version" xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" />.</p>
        <div>
            <h6 oldrole="formalpara" xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Notes and warnings about the upgrade</h6>
            <div>
                <table cellspacing="0" class="TableStyle-NoteTable_Yellow_DoNotEdit" oldrole="warning" style="width: 100%;mc-table-style: url('../../../Resources/TableStyles/NoteTable_Yellow_DoNotEdit.css');">
                    <col class="TableStyle-NoteTable_Yellow_DoNotEdit-Column-Column1" style="width: 0.3in;">
                    </col>
                    <col class="TableStyle-NoteTable_Yellow_DoNotEdit-Column-Column2">
                    </col>
                    <tbody>
                        <tr class="TableStyle-NoteTable_Yellow_DoNotEdit-Body-Body1">
                            <td class="TableStyle-NoteTable_Yellow_DoNotEdit-BodyB-Column1-Body1">
                                <p>
                                    <img src="../../../Resources/Images/Common/caution.png" />
                                </p>
                            </td>
                            <td class="TableStyle-NoteTable_Yellow_DoNotEdit-BodyA-Column2-Body1"><span class="Yellow">Caution: </span>
                                <p oldrole="para">Read the entire document thoroughly before starting the upgrade.</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <ul>
                <li>
                    <p>Versions 6.0.x and 7.0.x are significantly different, therefore direct upgrade is not possible. Read the entire document thoroughly before starting the upgrade.</p>
                </li>
                <li>
                    <p>Hazard of data loss! When upgrading a <MadCap:variable name="General.abbrev" xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" /> installation that is running in server or relay mode, <MadCap:variable name="General.vendor" xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" /> recommends redirecting the client logs to another syslog server to avoid message loss.</p>
                </li>
                <li>
                    <p>Hazard of data loss! During the upgrade, there will be periods when <MadCap:variable name="General.abbrev" xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" /> will not be able to receive logs. Make sure to upgrade in a dedicated maintenance window when you can disable receiving logs.</p>
                </li>
                <li>
                    <p>The persistent positions of certain drivers (for example, file source) are lost during the upgrade process, so log duplication can happen.</p>
                </li>
                <li>
                    <p>The list of supported platforms has changed in version 7.0.x. Verify that your platform is supported on the <a href="http://support.oneidentity.com/technical-documents/syslog-ng-premium-edition/release-notes/release-notes/supported-platforms">Supported platforms</a> page. In particular, 32-bit systems are no longer supported, so they can not be upgraded to version 7.0.x.</p>
                </li>
                <li>
                    <p>Version 7.0.x of <MadCap:variable name="General.abbrev" xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" /> does not support every feature of 6.0.x. For details, see <a href="http://support.oneidentity.com/technical-documents/syslog-ng-premium-edition/7.0.14/release-notes/release-notes/features-available-only-in-6-lts">Features available only in 6 LTS</a>.</p>
                </li>
                <li>
                    <p>Features available in both 7.0.x and 6 LTS may work differently.</p>
                </li>
            </ul>
        </div>
        <div>
            <h6 oldrole="formalpara" xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Prerequisites</h6>
            <ul>
                <li>
                    <p>You must have a valid software subscription to be able to download the new version of <MadCap:variable name="General.abbrev"></MadCap:variable>.</p>
                </li>
            </ul>
            <p>Complete the following steps before starting the actual upgrade process.</p>
            <ol>
                <li>
                    <p>Download the installer package for the latest 7.0.x version of <MadCap:variable name="General.abbrev"></MadCap:variable> from the <MadCap:variable name="General.downloads"></MadCap:variable>.</p>
                </li>
                <li>
                    <p>If you are using <MadCap:variable name="General.abbrev"></MadCap:variable> in server mode, download the new license from <MadCap:variable name="General.download-license"></MadCap:variable>.</p>
                </li>
                <li>
                    <p>Install <MadCap:variable name="General.abbrev"></MadCap:variable> <MadCap:variable name="Version.version"></MadCap:variable> on a test machine.</p>
                </li>
                <li>
                    <p>Replace the <MadCap:variable name="General.abbrev"></MadCap:variable> configuration file on the test machine with your <MadCap:variable name="General.abbrev"></MadCap:variable> version 6.0.x configuration file.</p>
                </li>
                <li>
                    <p>Edit the configuration file: update the version string to <span class="Code">@version: 7.0</span>.</p>
                </li>
                <li>
                    <p>Update the configuration file. Perform the following steps until you have an updated configuration file that properly works with <MadCap:variable name="General.abbrev"></MadCap:variable> <MadCap:variable name="Version.version"></MadCap:variable>.</p>
                    <ol>
                        <li>
                            <p>Check the configuration for syntax errors using the <span class="Code">syslog-ng --syntax-only --cfgfile &ltyour-modified-configuration-file;&gt;</span> command. Modify your configuration to correct any errors and warnings.</p>
                        </li>
                        <li>
                            <p>Restart syslog-ng.</p>
                        </li>
                        <li>
                            <p>Verify that message filtering and processing (for example, parsing and rewriting) works properly.</p>
                        </li>
                        <li>
                            <p>Verify that the format and content of the output messages is correct, including the SDATA of RFC-5424-formatted messages if you are using them.</p>
                        </li>
                    </ol>
                </li>
            </ol>
        </div>
        <div>
            <h6 oldrole="formalpara" MadCap:conditions="CommonConditions_DoNotEdit.DoNotPublish" xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Steps</h6>
            <p class="Procedure">To upgrade from<MadCap:variable name="General.abbrev"></MadCap:variable> 6.0.x to <MadCap:variable name="Version.version" /> on a production machine</p>
            <ol oldrole="procedure">
                <li oldrole="step">
                    <p>Login to the host you want to upgrade.</p>
                </li>
                <li oldrole="step">
                    <p>If you are using disk-buffers in your <MadCap:variable name="General.abbrev"></MadCap:variable> configuration file, empty the disk-buffer files. For details, see <a href="https://support.oneidentity.com/syslog-ng-premium-edition/kb/307304/how-to-empty-disk-buffer-files">How to empty disk-buffer files</a>.</p>
                </li>
                <li oldrole="step">
                    <div>
                        <table cellspacing="0" class="TableStyle-NoteTable_Yellow_DoNotEdit" oldrole="warning" style="width: 100%;mc-table-style: url('../../../Resources/TableStyles/NoteTable_Yellow_DoNotEdit.css');">
                            <col class="TableStyle-NoteTable_Yellow_DoNotEdit-Column-Column1" style="width: 0.3in;" />
                            <col class="TableStyle-NoteTable_Yellow_DoNotEdit-Column-Column2" />
                            <tbody>
                                <tr class="TableStyle-NoteTable_Yellow_DoNotEdit-Body-Body1">
                                    <td class="TableStyle-NoteTable_Yellow_DoNotEdit-BodyB-Column1-Body1">
                                        <p>
                                            <img src="../../../Resources/Images/Common/caution.png" />
                                        </p>
                                    </td>
                                    <td class="TableStyle-NoteTable_Yellow_DoNotEdit-BodyA-Column2-Body1"><span class="Yellow">Caution: </span>
                                        <p>Hazard of data loss! This host will not be able to receive or send log messages until the upgrade procedure is complete. Make sure to upgrade in a dedicated maintenance window when you can disable receiving logs.</p>
                                        <p>When upgrading a <MadCap:variable name="General.abbrev" xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" /> installation that is running in server or relay mode, <MadCap:variable name="General.vendor" xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" /> recommends redirecting the client logs to another syslog server to avoid message loss.</p>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <p>Stop <MadCap:variable name="General.abbrev"></MadCap:variable> version 6.</p>
                    <!-- FIXME link to the controlling syslog-ng topic when done, DOC-4366 -->
                </li>
                <li oldrole="step">
                    <p>Verify that <MadCap:variable name="General.abbrev"></MadCap:variable> has stopped. The output of the following command must be empty: <span class="Code">ps axu | grep syslog-ng</span></p>
                </li>
                <li oldrole="step">
                    <p>Create a backup of the <MadCap:variable name="General.abbrev"></MadCap:variable> installation directory using the following command: <span class="Code">cp -a /opt/syslog-ng /opt/syslog-ng-pe6-backup</span></p>
                </li>
                <li oldrole="step">
                    <p>Uninstall <MadCap:variable name="General.abbrev"></MadCap:variable> version 6. For details, see <a href="http://support.oneidentity.com/technical-documents/syslog-ng-premium-edition/6.0.17/administration-guide/chapter-3-installing-syslog-ng/uninstalling-syslog-ng-pe">Uninstalling syslog-ng PE 6</a>.</p>
                </li>
                <li oldrole="step">
                    <p>Delete the installation directory using the following command: <span class="Code">rm -rf /opt/syslog-ng</span></p>
                </li>
                <li oldrole="step">
                    <p>Download the new installer package from the <MadCap:variable name="General.downloads"></MadCap:variable>.</p>
                </li>
                <li oldrole="step">
                    <p>Install <MadCap:variable name="General.abbrev"></MadCap:variable> <MadCap:variable name="Version.version" />. For details, see <a targetdoc="syslog-ng-pe-guide-admin" targetptr="chapter-install"></a>.</p>
                    <div>
                        <table cellspacing="0" class="TableStyle-NoteTable_Blue_DoNotEdit" oldrole="note" style="width: 100%;mc-table-style: url('../../../Resources/TableStyles/NoteTable_Blue_DoNotEdit.css');">
                            <col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column1" style="width: 0.3in;">
                            </col>
                            <col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column2">
                            </col>
                            <tbody>
                                <tr class="TableStyle-NoteTable_Blue_DoNotEdit-Body-Body1">
                                    <td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyB-Column1-Body1">
                                        <p>
                                            <img src="../../../Resources/Images/Common/note.png" />
                                        </p>
                                    </td>
                                    <td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyA-Column2-Body1"><span class="AllNoteStyles">NOTE: </span>
                                        <p>If you want to run <MadCap:variable name="General.abbrev"></MadCap:variable> under a non-privileged user, see <a href="https://support.oneidentity.com/syslog-ng-premium-edition/kb/261520/how-to-run-syslog-ng-pe-under-a-non-privileged-user-on-linux">this knowledgebase article</a> for details.</p>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </li>
                <li oldrole="step">
                    <p>Stop <MadCap:variable name="General.abbrev"></MadCap:variable> version 7 started by the installer.</p>
                    <!-- FIXME link to the controlling syslog-ng topic when done, DOC-4366 -->
                </li>
                <li oldrole="step">
                    <p>Copy the <MadCap:variable name="General.abbrev"></MadCap:variable> version 7 configuration file that you created on your test machine into the <span class="Code">/opt/syslog-ng/etc</span> directory of the host you are upgrading.</p>
                </li>
                <li oldrole="step">
                    <p>If the host you are upgrading is running <MadCap:variable name="General.abbrev"></MadCap:variable> in <a href="concepts-server-mode.htm">server mode</a>, replace the old (version 6) license file with the new one.</p>
                    <div>
                        <table cellspacing="0" class="TableStyle-NoteTable_Yellow_DoNotEdit" oldrole="warning" style="width: 100%;mc-table-style: url('../../../Resources/TableStyles/NoteTable_Yellow_DoNotEdit.css');">
                            <col class="TableStyle-NoteTable_Yellow_DoNotEdit-Column-Column1" style="width: 0.3in;" />
                            <col class="TableStyle-NoteTable_Yellow_DoNotEdit-Column-Column2" />
                            <tbody>
                                <tr class="TableStyle-NoteTable_Yellow_DoNotEdit-Body-Body1">
                                    <td class="TableStyle-NoteTable_Yellow_DoNotEdit-BodyB-Column1-Body1">
                                        <p>
                                            <img src="../../../Resources/Images/Common/caution.png" />
                                        </p>
                                    </td>
                                    <td class="TableStyle-NoteTable_Yellow_DoNotEdit-BodyA-Column2-Body1"><span class="Yellow">Caution: </span>
                                        <p>Hazard of data loss! Without the new license file, <MadCap:variable name="General.abbrev"></MadCap:variable> will run in relay mode, and will not store the incoming messages locally.</p>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </li>
                <li oldrole="step">
                    <p>Restart <MadCap:variable name="General.abbrev"></MadCap:variable> and verify that it is running and processing logs properly. For details, see <a href="https://support.oneidentity.com/syslog-ng-premium-edition/kb/299710/managing-and-checking-syslog-ng-service-on-linux">Managing and checking syslog-ng service on Linux</a>.</p>
                </li>
                <li oldrole="step">
                    <p>If you experience problems during the upgrade, <MadCap:variable name="General.contact-support"></MadCap:variable>.</p>
                </li>
            </ol>
        </div>
    </body>
</html>