<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!-- FIXME the sync option is obsolete, should be updated to flush-lines - if this section is needed at all -->
<!--	<section xml:id="sync">
            <title>The sync() parameter</title>

            <indexterm>
            <primary>parameters</primary>
            <secondary>sync()</secondary>
            </indexterm>
            <para>The syslog-ng application buffers the log messages to be sent in an output queue. The
            <parameter>sync()</parameter> parameter specifies the number of messages held in
            this buffer.</para>
            <para>Note that syslog-ng does not write all buffered messages into a single chunk; each
            message is written with a single <parameter>write()</parameter> system call.</para>
            <para>For file destinations, the received messages can be written to disk immediately after
            the message is received. To accomplish this, set the <parameter>sync()</parameter>
            option to zero.</para>
            <synopsis>
            options { sync(0); };
            </synopsis>
            </section>-->
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><body name="example-logrotate" oldrole="section">
<h1 name="example-logrotate">Configuring log rotation</h1>
<p oldrole="para">The &abbrev; application does not rotate logs by itself. To use &abbrev; for log rotation, consider the following approaches:</p>
<h6 oldrole="formalpara">Use logrotate together with &abbrev;:</h6>

<ul oldrole="itemizedlist">
<li oldrole="listitem">
<p oldrole="para">Ideal for workstations or when processing fewer logs.</p>
</li>
<li oldrole="listitem">
<p oldrole="para">It is included in most distributions by default.</p>
</li>
<li oldrole="listitem">
<p oldrole="para">Less scripting is required, only <b oldrole="command">logrotate</b> has to be configured correctly.</p>
</li>
<li oldrole="listitem">
<p oldrole="para">Requires frequent restart (&abbrev; must be reloaded/restarted when the files are rotated). After rotating the log files, reload &abbrev; using the <b oldrole="command">syslog-ng-ctl reload</b> command, or use another method to send a SIGHUP to &abbrev;.</p>
</li>
<li oldrole="listitem">
<p oldrole="para">The statistics collected by &abbrev;, and the correlation information gathered with Pattern Database is lost with each restart.</p>
</li>
</ul>
<h6 oldrole="formalpara">Separate incoming logs based on time, host or other information:</h6>

<ul oldrole="itemizedlist">
<li oldrole="listitem">
<p oldrole="para">Ideal for central log servers, where regular restart of &abbrev; is unfavorable.</p>
</li>
<li oldrole="listitem">
<p oldrole="para">Requires shell scripts or cron jobs to remove old logs.</p>
</li>
<li oldrole="listitem">
<p oldrole="para">It can be done by using macros in the destination name (in the filename, directory name, or the database table name).</p>
</li>
</ul>
<div class="Example">
<h6 oldrole="example">Example: File destination for log rotation </h6>
<p oldrole="para">This sample file destination configuration stores incoming logs in files that are named based on the current year, month and day, and places these files in directories that are named based on the hostname:</p>
<pre class="Code" oldrole="synopsis">destination d_sorted { file("/var/log/remote/${HOST}/${YEAR}_${MONTH}_${DAY}.log" create-dirs(yes)); };</pre>
</div>
<div class="Example">
<h6 condition="pe" oldrole="example">Example: Logstore destination for log rotation </h6>
<p oldrole="para">This sample logstore destination configuration stores incoming logs in logstores that are named based on the current year, month and day, and places these logstores in directories that are named based on the hostname:</p>
<pre class="Code" oldrole="synopsis">destination d_logstore { logstore("/var/log/remote/${HOST}/${YEAR}_${MONTH}_${DAY}.lgs" create-dirs(yes)); };</pre>
</div>
<div class="Example">
<h6 oldrole="example">Example: Command for cron for log rotation</h6>
<p oldrole="para">This sample command for <b oldrole="command">cron</b> removes files older than two weeks from the <span class="Code" oldrole="filename">/var/log/remote</span> directory:</p>
<pre class="Code" oldrole="synopsis">find /var/log/remote/ -daystart -mtime +14 -type f -exec rm {} \;</pre>
</div>
</body></html>
