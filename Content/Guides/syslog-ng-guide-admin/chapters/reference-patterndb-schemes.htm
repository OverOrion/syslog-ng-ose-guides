<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <body name="reference-patterndb-schemes" oldrole="section">
        <h1 name="reference-patterndb-schemes">The syslog-ng pattern database format</h1>
        <MadCap:keyword term="pattern database">
        </MadCap:keyword>
        <MadCap:keyword term="classifying messages:['creating databases']">
        </MadCap:keyword>
        <MadCap:keyword term="message classification">
        </MadCap:keyword>
        <MadCap:keyword term="pattern database schema">
        </MadCap:keyword>
        <p oldrole="para">Pattern databases are XML files that contain rules describing the message patterns. For sample pattern databases, see <MadCap:xref href="patterndb-download.htm#patterndb-download"></MadCap:xref>.</p>
        <p oldrole="para">The following scheme describes the V5 format of the pattern database. This format is backwards-compatible with the earlier formats.</p>
        <p oldrole="para">For a sample database containing only a single pattern, see <MadCap:xref href="reference-patterndb-schemes.htm#example-pattern-database"></MadCap:xref>.</p>
        <table cellspacing="0" class="TableStyle-NoteTable_Blue_DoNotEdit" oldrole="tip" style="width: 100%;mc-table-style: url('../../../Resources/TableStyles/NoteTable_Blue_DoNotEdit.css');">
            <col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column1" style="width: 0.3in;">
            </col>
            <col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column2">
            </col>
            <tbody>
                <tr class="TableStyle-NoteTable_Blue_DoNotEdit-Body-Body1">
                    <td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyB-Column1-Body1">
                        <p>
                            <img src="../../../Resources/Images/Common/note.png" />
                        </p>
                    </td>
                    <td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyA-Column2-Body1"><span class="AllNoteStyles">TIP: </span>
                        <p oldrole="para">Use the <b oldrole="command">pdbtool</b> utility that is bundled with syslog-ng to test message patterns and convert existing databases to the latest format. For details, see <MadCap:xref href="#pdbtool.1"></MadCap:xref>.</p>
                        <p oldrole="para">To automatically create an initial pattern database from an existing log file, use the <b oldrole="command">pdbtool patternize</b> command. For details, see <MadCap:xref href="#pdbtool-patternize"></MadCap:xref>.</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <div class="Example">
            <h6 name="example-pattern-database" oldrole="example">Example: A pattern database containing a single rule</h6>
            <MadCap:keyword term="pattern database">
            </MadCap:keyword>
            <p oldrole="para">The following pattern database contains a single rule that matches a log message of the <span class="Code" oldrole="userinput">ssh</span> application. A sample log message looks like:</p><pre class="Code" oldrole="synopsis">Accepted password for sampleuser from 10.50.0.247 port 42156 ssh2</pre>
            <p oldrole="para">The following is a simple pattern database containing a matching rule.</p><pre class="Code" oldrole="synopsis">&lt;patterndb version='5' pub_date='2010-10-17'&gt;
    &lt;ruleset name='ssh' id='123456678'&gt;
        &lt;pattern&gt;ssh&lt;/pattern&gt;
            &lt;rules&gt;
                &lt;rule provider='me' id='182437592347598' class='system'&gt;
                    &lt;patterns&gt;
                        &lt;pattern&gt;Accepted @QSTRING:SSH.AUTH_METHOD: @ for@QSTRING:SSH_USERNAME: @from\ @QSTRING:SSH_CLIENT_ADDRESS: @port @NUMBER:SSH_PORT_NUMBER:@ ssh2&lt;/pattern&gt;
                    &lt;/patterns&gt;
                &lt;/rule&gt;
            &lt;/rules&gt;
    &lt;/ruleset&gt;
&lt;/patterndb&gt;</pre>
            <p oldrole="para">Note that the rule uses macros that refer to parts of the message, for example, you can use the <span class="Code" oldrole="userinput">${SSH_USERNAME}</span> macro refer to the username used in the connection.</p>
            <p oldrole="para">The following is the same example, but with a test message and test values for the parsers.</p><pre class="Code" oldrole="synopsis">&lt;patterndb version='4' pub_date='2010-10-17'&gt;
    &lt;ruleset name='ssh' id='123456678'&gt;
        &lt;pattern&gt;ssh&lt;/pattern&gt;
            &lt;rules&gt;
                &lt;rule provider='me' id='182437592347598' class='system'&gt;
                    &lt;patterns&gt;
                        &lt;pattern&gt;Accepted @QSTRING:SSH.AUTH_METHOD: @ for@QSTRING:SSH_USERNAME: @from\ @QSTRING:SSH_CLIENT_ADDRESS: @port @NUMBER:SSH_PORT_NUMBER:@ ssh2&lt;/pattern&gt;
                    &lt;/patterns&gt;
                    &lt;examples&gt;
                        &lt;example&gt;
                            &lt;test_message&gt;Accepted password for sampleuser from 10.50.0.247 port 42156 ssh2&lt;/test_message&gt;
                            &lt;test_values&gt;
                                &lt;test_value name="SSH.AUTH_METHOD"&gt;password&lt;/test_value&gt;
                                &lt;test_value name="SSH_USERNAME"&gt;sampleuser&lt;/test_value&gt;
                                &lt;test_value name="SSH_CLIENT_ADDRESS"&gt;10.50.0.247&lt;/test_value&gt;
                                &lt;test_value name="SSH_PORT_NUMBER"&gt;42156&lt;/test_value&gt;
                            &lt;/test_values&gt;
                       &lt;/example&gt;
                    &lt;/examples&gt;
                &lt;/rule&gt;
            &lt;/rules&gt;
    &lt;/ruleset&gt;
&lt;/patterndb&gt;</pre>
        </div>
        <h6>Element: patterndb</h6>
        <h6 oldrole="simplesect">Location</h6>
        <p oldrole="para">/<i oldrole="emphasis" role="bold">patterndb</i></p>
        <h6 oldrole="simplesect">Description</h6>
        <p oldrole="para">The container element of the pattern database.</p>
        <h6 oldrole="simplesect">Attributes</h6>
        <ul oldrole="itemizedlist">
            <li oldrole="listitem">
                <p oldrole="para"><i oldrole="emphasis" role="bold">version</i>: The schema version of the pattern database. The current version is <span class="Code" oldrole="userinput">4</span>.</p>
            </li>
            <li oldrole="listitem">
                <p oldrole="para"><i oldrole="emphasis" role="bold">pubdate</i>: The publication date of the XML file.</p>
            </li>
        </ul>
        <h6 oldrole="simplesect">Children</h6>
        <ul oldrole="itemizedlist">
            <li oldrole="listitem">
                <p oldrole="para"><a href=""><i oldrole="emphasis" role="bold">ruleset</i></a>
                </p>
            </li>
        </ul>
        <h6 oldrole="simplesect">Example</h6><pre class="Code" oldrole="synopsis">&lt;patterndb version='4' pub_date='2010-10-25'&gt;</pre>
        <h6>Element: ruleset</h6>
        <h6 oldrole="simplesect">Location</h6>
        <p oldrole="para">/<a href="">patterndb</a>/<i oldrole="emphasis" role="bold">ruleset</i></p>
        <h6 oldrole="simplesect">Description</h6>
        <p oldrole="para">A container element to group log patterns for an application or program. A <span class="Code" oldrole="userinput">&lt;patterndb&gt;</span> element may contain any number of <span class="Code" oldrole="userinput">&lt;ruleset&gt;</span> elements.</p>
        <h6 oldrole="simplesect">Attributes</h6>
        <ul oldrole="itemizedlist">
            <li oldrole="listitem">
                <p oldrole="para"><i oldrole="emphasis" role="bold">name</i>: The name of the application. Note that the function of this attribute is to make the database more readable, syslog-ng uses the <span class="Code" oldrole="userinput">&lt;pattern&gt;</span> element to identify the applications sending log messages.</p>
            </li>
            <li oldrole="listitem">
                <p oldrole="para"><i oldrole="emphasis" role="bold">id</i>: A unique ID of the application, for example, the md5 sum of the <span class="Code" oldrole="userinput">name</span> attribute.</p>
            </li>
        </ul>
        <h6 oldrole="simplesect">Children</h6>
        <ul oldrole="itemizedlist">
            <li oldrole="listitem">
                <p oldrole="para"><a href=""><i oldrole="emphasis" role="bold">patterns</i></a>
                </p>
            </li>
            <li oldrole="listitem">
                <p oldrole="para"><a href=""><i oldrole="emphasis" role="bold">rules</i></a>
                </p>
            </li>
            <li oldrole="listitem">
                <p oldrole="para"><a href=""><i oldrole="emphasis" role="bold">actions</i></a>
                </p>
            </li>
            <li oldrole="listitem">
                <p oldrole="para"><a href=""><i oldrole="emphasis" role="bold">tags</i></a>
                </p>
            </li>
            <li oldrole="listitem">
                <p oldrole="para"><i oldrole="emphasis" role="bold">description</i>: OPTIONAL — A description of the ruleset or the application.</p>
            </li>
            <li oldrole="listitem">
                <p oldrole="para"><i oldrole="emphasis" role="bold">url</i>: OPTIONAL — An URL referring to further information about the ruleset or the application.</p>
            </li>
            <li oldrole="listitem">
                <p oldrole="para"><i oldrole="emphasis" role="bold">rule_urls</i>: OPTIONAL — To list multiple URLs referring to further information about the ruleset or the application, enclose the &lt;url&gt; elements into an &lt;urls&gt; element.</p>
            </li>
        </ul>
        <h6 oldrole="simplesect">Example</h6><pre class="Code" oldrole="synopsis">&lt;ruleset name='su' id='480de478-d4a6-4a7f-bea4-0c0245d361e1'&gt;</pre>
        <h6>Element: patterns</h6>
        <h6 oldrole="simplesect">Location</h6>
        <p oldrole="para">/<a href="">patterndb</a>/<a href="">ruleset</a>/<i oldrole="emphasis" role="bold">patterns</i></p>
        <h6 oldrole="simplesect">Description</h6>
        <p oldrole="para">A container element. A <span class="Code" oldrole="userinput">&lt;patterns&gt;</span> element may contain any number of <span class="Code" oldrole="userinput">&lt;pattern&gt;</span> elements.</p>
        <h6 oldrole="simplesect">Attributes</h6>
        <p oldrole="para">N/A</p>
        <h6 oldrole="simplesect">Children</h6>
        <ul oldrole="itemizedlist">
            <li oldrole="listitem">
                <p oldrole="para"><i oldrole="emphasis" role="bold">pattern</i>: The name of the application — syslog-ng matches this value to the ${PROGRAM} header of the syslog message to find the rulesets applicable to the syslog message.</p>
                <p oldrole="para">Specifying multiple patterns is useful if two or more applications have different names (that is, different ${PROGRAM} fields), but otherwise send identical log messages.</p>
                <p oldrole="para">It is not necessary to use multiple patterns if only the end of the ${PROGRAM} fields is different, use only the beginning of the ${PROGRAM} field as the <span class="Code" oldrole="userinput">pattern</span>. For example, the Postfix e-mail server sends messages using different process names, but all of them begin with the <span class="Code" oldrole="userinput">postfix</span> string.</p>
                <p oldrole="para">You can also use parsers in the program pattern if needed, and use the parsed results later. For example: <span class="Code" oldrole="parameter">&lt;pattern&gt;postfix\@ESTRING:.postfix.component:[@&lt;/pattern&gt;</span></p>
                <table cellspacing="0" class="TableStyle-NoteTable_Blue_DoNotEdit" oldrole="note" style="width: 100%;mc-table-style: url('../../../Resources/TableStyles/NoteTable_Blue_DoNotEdit.css');">
                    <col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column1" style="width: 0.3in;">
                    </col>
                    <col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column2">
                    </col>
                    <tbody>
                        <tr class="TableStyle-NoteTable_Blue_DoNotEdit-Body-Body1">
                            <td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyB-Column1-Body1">
                                <p>
                                    <img src="../../../Resources/Images/Common/note.png" />
                                </p>
                            </td>
                            <td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyA-Column2-Body1"><span class="AllNoteStyles">NOTE: </span>
                                <p oldrole="para">If the <span class="Code" oldrole="userinput">&lt;pattern&gt;</span> element of a ruleset is not specified, <MadCap:variable name="General.abbrev"></MadCap:variable> will use this ruleset as a fallback ruleset: it will apply the ruleset to messages that have an empty PROGRAM header, or if none of the program patterns matched the PROGRAM header of the incoming message.</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </li>
        </ul>
        <h6 oldrole="simplesect">Example</h6><pre class="Code" oldrole="synopsis">&lt;patterns&gt;
    &lt;pattern&gt;firstapplication&lt;/pattern&gt;
    &lt;pattern&gt;otherapplication&lt;/pattern&gt;
&lt;/patterns&gt;</pre>
        <p oldrole="para">Using parsers in the program pattern:</p><pre class="Code" oldrole="synopsis">&lt;pattern&gt;postfix\@ESTRING:.postfix.component:[@&lt;/pattern&gt;</pre>
        <h6>Element: rules</h6>
        <h6 oldrole="simplesect">Location</h6>
        <p oldrole="para">/<a href="">patterndb</a>/<a href="">ruleset</a>/<i oldrole="emphasis" role="bold">rules</i></p>
        <h6 oldrole="simplesect">Description</h6>
        <p oldrole="para">A container element for the rules of the ruleset.</p>
        <h6 oldrole="simplesect">Attributes</h6>
        <p oldrole="para">N/A</p>
        <h6 oldrole="simplesect">Children</h6>
        <ul oldrole="itemizedlist">
            <li oldrole="listitem">
                <p oldrole="para"><a href=""><i oldrole="emphasis" role="bold">rule</i></a>
                </p>
            </li>
        </ul>
        <h6 oldrole="simplesect">Example</h6><pre class="Code" oldrole="synopsis">&lt;rules&gt;
    &lt;rule provider='me' id='182437592347598' class='system'&gt;
        &lt;patterns&gt;
            &lt;pattern&gt;Accepted @QSTRING:SSH.AUTH_METHOD: @ for@QSTRING:SSH_USERNAME: @from\ @QSTRING:SSH_CLIENT_ADDRESS: @port @NUMBER:SSH_PORT_NUMBER:@ ssh2&lt;/pattern&gt;
        &lt;/patterns&gt;
    &lt;/rule&gt;
&lt;/rules&gt;</pre>
        <h6>Element: rule</h6>
        <h6 oldrole="simplesect">Location</h6>
        <p oldrole="para">/<a href="">patterndb</a>/<a href="">ruleset</a>/<a href="">rules</a>/<i oldrole="emphasis" role="bold">rule</i></p>
        <h6 oldrole="simplesect">Description</h6>
        <p oldrole="para">An element containing message patterns and how a message that matches these patterns is classified.</p>
        <table cellspacing="0" class="TableStyle-NoteTable_Blue_DoNotEdit" oldrole="note" style="width: 100%;mc-table-style: url('../../../Resources/TableStyles/NoteTable_Blue_DoNotEdit.css');">
            <col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column1" style="width: 0.3in;">
            </col>
            <col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column2">
            </col>
            <tbody>
                <tr class="TableStyle-NoteTable_Blue_DoNotEdit-Body-Body1">
                    <td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyB-Column1-Body1">
                        <p>
                            <img src="../../../Resources/Images/Common/note.png" />
                        </p>
                    </td>
                    <td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyA-Column2-Body1"><span class="AllNoteStyles">NOTE: </span>
                        <p oldrole="para">If the following characters appear in the message, they must be escaped in the rule as follows:</p>
                        <ul oldrole="itemizedlist">
                            <li oldrole="listitem">
                                <p oldrole="para"><span class="Code" oldrole="userinput">@</span>: Use @@, for example <span class="Code" oldrole="userinput">user@@example.com</span></p>
                            </li>
                            <li oldrole="listitem">
                                <p oldrole="para"><i oldrole="emphasis">&lt;</i>: Use <span class="Code" oldrole="userinput">&amp;lt;</span></p>
                            </li>
                            <li oldrole="listitem">
                                <p oldrole="para"><i oldrole="emphasis">&gt;</i>: Use <span class="Code" oldrole="userinput">&amp;gt;</span></p>
                            </li>
                            <li oldrole="listitem">
                                <p oldrole="para">&amp;: Use <span class="Code" oldrole="userinput">&amp;amp;</span></p>
                            </li>
                        </ul>
                    </td>
                </tr>
            </tbody>
        </table>
        <p oldrole="para">The <i oldrole="emphasis" role="bold">&lt;rules&gt;</i> element may contain any number of <i oldrole="emphasis" role="bold">&lt;rule&gt;</i> elements.</p>
        <h6 name="element-patterndb-rule-attributes" oldrole="simplesect" xreflabel="Attributes of the rule element">Attributes</h6>
        <ul oldrole="itemizedlist">
            <li oldrole="listitem">
                <p oldrole="para"><i oldrole="emphasis" role="bold">provider</i>: The provider of the rule. This is used to distinguish between who supplied the rule, that is, if it has been created by <MadCap:variable name="General.vendor"></MadCap:variable>, or added to the XML by a local user.</p>
            </li>
            <li oldrole="listitem">
                <p oldrole="para"><i oldrole="emphasis" role="bold">id</i>: The globally unique ID of the rule.</p>
            </li>
            <li oldrole="listitem">
                <p oldrole="para"><i oldrole="emphasis" role="bold">class</i>: The class of the rule — syslog-ng assigns this class to the messages matching a pattern of this rule.</p>
            </li>
            <MadCap:snippetBlock src="../../shared/chunk/patterndb-context-attributes.htm">
            </MadCap:snippetBlock>
        </ul>
        <h6 oldrole="simplesect">Children</h6>
        <ul oldrole="itemizedlist">
            <li oldrole="listitem">
                <p oldrole="para"><a href=""><i oldrole="emphasis" role="bold">patterns</i></a>
                </p>
            </li>
        </ul>
        <h6 oldrole="simplesect">Example</h6><pre class="Code" oldrole="synopsis">&lt;rule provider='balabit' id='f57196aa-75fd-11dd-9bba-001e6806451b' class='violation'&gt;</pre>
        <p oldrole="para">The following example specifies attributes for correlating messages as well. For details on correlating messages, see <MadCap:xref href="patterndb-correlation.htm#patterndb-correlation"></MadCap:xref>.</p><pre class="Code" oldrole="synopsis">&lt;rule provider='balabit' id='f57196aa-75fd-11dd-9bba-001e6806451b' class='violation' context-id='same-session' context-scope='process' context-timeout='360'&gt;</pre>
        <h6>Element: patterns</h6>
        <h6 oldrole="simplesect">Location</h6>
        <p oldrole="para">/<a href="">patterndb</a>/<a href="">ruleset</a>/<a href="">rules</a>/<a href="">rule</a>/<i oldrole="emphasis" role="bold">patterns</i></p>
        <h6 oldrole="simplesect">Description</h6>
        <p oldrole="para">An element containing the patterns of the rule. If a <i oldrole="emphasis" role="bold">&lt;patterns&gt;</i> element contains multiple <i oldrole="emphasis" role="bold">&lt;pattern&gt;</i> elements, the class of the <i oldrole="emphasis" role="bold">&lt;rule&gt;</i> is assigned to every syslog message matching any of the patterns.</p>
        <h6 oldrole="simplesect">Attributes</h6>
        <p oldrole="para">N/A</p>
        <h6 oldrole="simplesect">Children</h6>
        <ul oldrole="itemizedlist">
            <li oldrole="listitem">
                <p oldrole="para"><i oldrole="emphasis" role="bold">pattern</i>: A pattern describing a log message. This element is also called <span class="Code" oldrole="userinput">message pattern</span>. For example:<pre class="Code" oldrole="synopsis">&lt;pattern&gt;+ ??? root-&lt;/pattern&gt;</pre></p>
                <table cellspacing="0" class="TableStyle-NoteTable_Blue_DoNotEdit" oldrole="note" style="width: 100%;mc-table-style: url('../../../Resources/TableStyles/NoteTable_Blue_DoNotEdit.css');">
                    <col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column1" style="width: 0.3in;">
                    </col>
                    <col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column2">
                    </col>
                    <tbody>
                        <tr class="TableStyle-NoteTable_Blue_DoNotEdit-Body-Body1">
                            <td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyB-Column1-Body1">
                                <p>
                                    <img src="../../../Resources/Images/Common/note.png" />
                                </p>
                            </td>
                            <td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyA-Column2-Body1"><span class="AllNoteStyles">NOTE: </span>
                                <p oldrole="para">Support for XML entities is limited, you can use only the following entities: <span class="Code" oldrole="userinput">&amp;amp; &amp;lt; &amp;gt; &amp;quot; &amp;apos;</span>. User-defined entities are not supported.</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li oldrole="listitem">
                <p oldrole="para"><i oldrole="emphasis" role="bold">description</i>: OPTIONAL — A description of the pattern or the log message matching the pattern.</p>
            </li>
            <li oldrole="listitem">
                <p oldrole="para"><a href=""><i oldrole="emphasis" role="bold">urls</i></a>
                </p>
            </li>
            <li oldrole="listitem">
                <p oldrole="para"><a href=""><i oldrole="emphasis" role="bold">values</i></a>
                </p>
            </li>
            <li oldrole="listitem">
                <p oldrole="para"><a href=""><i oldrole="emphasis" role="bold">examples</i></a>
                </p>
            </li>
        </ul>
        <h6 oldrole="simplesect">Example</h6><pre class="Code" oldrole="synopsis">&lt;patterns&gt;
    &lt;pattern&gt;Accepted @QSTRING:SSH.AUTH_METHOD: @ for@QSTRING:SSH_USERNAME: @from\ @QSTRING:SSH_CLIENT_ADDRESS: @port @NUMBER:SSH_PORT_NUMBER:@ ssh2&lt;/pattern&gt;
&lt;/patterns&gt;</pre>
        <h6>Element: urls</h6>
        <h6 oldrole="simplesect">Location</h6>
        <p oldrole="para">/<a href="">patterndb</a>/<a href="">ruleset</a>/<a href="">rules</a>/<a href="">rule</a>/<a href="">patterns</a>/<i oldrole="emphasis" role="bold">urls</i></p>
        <h6 oldrole="simplesect">Description</h6>
        <p oldrole="para">OPTIONAL — An element containing one or more URLs referring to further information about the patterns or the matching log messages.</p>
        <h6 oldrole="simplesect">Attributes</h6>
        <p oldrole="para">N/A</p>
        <h6 oldrole="simplesect">Children</h6>
        <ul oldrole="itemizedlist">
            <li oldrole="listitem">
                <p oldrole="para"><i oldrole="emphasis" role="bold">url</i>: OPTIONAL — An URL referring to further information about the patterns or the matching log messages.</p>
            </li>
        </ul>
        <h6 oldrole="simplesect">Example</h6>
        <p oldrole="para">N/A</p>
        <h6>Element: values</h6>
        <h6 oldrole="simplesect">Location</h6>
        <p oldrole="para">/<a href="">patterndb</a>/<a href="">ruleset</a>/<a href="">rules</a>/<a href="">rule</a>/<a href="">patterns</a>/<i oldrole="emphasis" role="bold">values</i></p>
        <h6 oldrole="simplesect">Description</h6>
        <p oldrole="para">OPTIONAL — Name-value pairs that are assigned to messages matching the patterns, for example, the representation of the event in the message according to the Common Event Format (CEF) or Common Event Exchange (CEE). The names can be used as macros to reference the assigned values.</p>
        <h6 oldrole="simplesect">Attributes</h6>
        <p oldrole="para">N/A</p>
        <h6 oldrole="simplesect">Children</h6>
        <ul oldrole="itemizedlist">
            <li oldrole="listitem">
                <p oldrole="para"><i oldrole="emphasis" role="bold">value</i>: OPTIONAL — Contains the value of the name-value pair that is assigned to the message.</p>
                <p oldrole="para">The &lt;value&gt; element of name-value pairs can include template functions. For details, see <MadCap:xref href="template-functions.htm#template-functions"></MadCap:xref>, for examples, see <MadCap:xref href="reference-template-functions.htm#template-function-if"></MadCap:xref>.</p>
                <p oldrole="para">When used together with message correlation, the &lt;value&gt; element of name-value pairs can include references to the values of earlier messages from the same context. For details, see <MadCap:xref href="patterndb-correlation.htm#patterndb-correlation"></MadCap:xref>.</p>
            </li>
            <li oldrole="listitem">
                <MadCap:keyword term="name — pattern value">
                </MadCap:keyword>
                <p oldrole="para"><i oldrole="emphasis">name</i>: The name of the name-value pair. It can also be used as a macro to reference the assigned value.</p>
            </li>
        </ul>
        <h6 oldrole="simplesect">Example</h6><pre class="Code" oldrole="synopsis">&lt;values&gt;
    &lt;value name=".classifier.outcome"&gt;/Success&lt;/value&gt;
&lt;/values&gt;</pre>
        <h6>Element: examples</h6>
        <h6 oldrole="simplesect">Location</h6>
        <p oldrole="para">/<a href="">patterndb</a>/<a href="">ruleset</a>/<a href="">rules</a>/<a href="">rule</a>/<a href="">patterns</a>/<i oldrole="emphasis" role="bold">examples</i></p>
        <h6 oldrole="simplesect">Description</h6>
        <p oldrole="para">OPTIONAL — A container element for sample log messages that should be recognized by the pattern. These messages can be used also to test the patterns and the parsers.</p>
        <h6 oldrole="simplesect">Attributes</h6>
        <p oldrole="para">N/A</p>
        <h6 oldrole="simplesect">Children</h6>
        <ul oldrole="itemizedlist">
            <li oldrole="listitem">
                <p oldrole="para"><a href=""><i oldrole="emphasis" role="bold">example</i></a>
                </p>
            </li>
        </ul>
        <h6 oldrole="simplesect">Example</h6><pre class="Code" oldrole="synopsis">&lt;examples&gt;
    &lt;example&gt;
        &lt;test_message&gt;Accepted password for sampleuser from 10.50.0.247 port 42156 ssh2&lt;/test_message&gt;
        &lt;test_values&gt;
            &lt;test_value name="SSH.AUTH_METHOD"&gt;password&lt;/test_value&gt;
            &lt;test_value name="SSH_USERNAME"&gt;sampleuser&lt;/test_value&gt;
            &lt;test_value name="SSH_CLIENT_ADDRESS"&gt;10.50.0.247&lt;/test_value&gt;
            &lt;test_value name="SSH_PORT_NUMBER"&gt;42156&lt;/test_value&gt;
        &lt;/test_values&gt;
    &lt;/example&gt;
&lt;/examples&gt;</pre>
        <h6>Element: example</h6>
        <h6 oldrole="simplesect">Location</h6>
        <p oldrole="para">/<a href="">patterndb</a>/<a href="">ruleset</a>/<a href="">rules</a>/<a href="">rule</a>/<a href="">patterns</a>/<a href="">examples</a>/<i oldrole="emphasis" role="bold">example</i></p>
        <h6 oldrole="simplesect">Description</h6>
        <p oldrole="para">OPTIONAL — A container element for a sample log message.</p>
        <h6 oldrole="simplesect">Attributes</h6>
        <p oldrole="para">N/A</p>
        <h6 oldrole="simplesect">Children</h6>
        <ul oldrole="itemizedlist">
            <li oldrole="listitem">
                <MadCap:keyword term="test_message">
                </MadCap:keyword>
                <p oldrole="para"><i oldrole="emphasis" role="bold">test_message</i>: OPTIONAL — A sample log message that should match this pattern. For example:<pre class="Code" oldrole="synopsis">&lt;test_message program="myapplication"&gt;Content filter has been enabled&lt;/test_message&gt;</pre></p>
                <ul oldrole="itemizedlist">
                    <li oldrole="listitem">
                        <p oldrole="para"><i oldrole="emphasis">program</i>: The program pattern of the test message. For example:<pre class="Code" oldrole="synopsis">&lt;test_message program="proftpd"&gt;ubuntu (::ffff:192.168.2.179[::ffff:192.168.2.179]) - FTP session closed.&lt;/test_message&gt;</pre></p>
                    </li>
                </ul>
            </li>
            <li oldrole="listitem">
                <MadCap:keyword term="test_values">
                </MadCap:keyword>
                <p oldrole="para"><i oldrole="emphasis" role="bold">test_values</i>: OPTIONAL — A container element to test the results of the parsers used in the pattern.</p>
                <ul oldrole="itemizedlist">
                    <li oldrole="listitem">
                        <MadCap:keyword term="test_value">
                        </MadCap:keyword>
                        <p oldrole="para"><i oldrole="emphasis" role="bold">test_value</i>: OPTIONAL — The expected value of the parser when matching the pattern to the test message. For example:<pre class="Code" oldrole="synopsis">&lt;test_value name=".dict.ContentFilter"&gt;enabled&lt;/test_value&gt;</pre></p>
                        <ul oldrole="itemizedlist">
                            <li oldrole="listitem">
                                <MadCap:keyword term="name — test_value">
                                </MadCap:keyword>
                                <p oldrole="para"><i oldrole="emphasis">name</i>: The name of the parser to test.</p>
                            </li>
                        </ul>
                    </li>
                </ul>
            </li>
        </ul>
        <h6 oldrole="simplesect">Example</h6><pre class="Code" oldrole="synopsis">&lt;examples&gt;
    &lt;example&gt;
        &lt;test_message&gt;Accepted password for sampleuser from 10.50.0.247 port 42156 ssh2&lt;/test_message&gt;
        &lt;test_values&gt;
            &lt;test_value name="SSH.AUTH_METHOD"&gt;password&lt;/test_value&gt;
            &lt;test_value name="SSH_USERNAME"&gt;sampleuser&lt;/test_value&gt;
            &lt;test_value name="SSH_CLIENT_ADDRESS"&gt;10.50.0.247&lt;/test_value&gt;
            &lt;test_value name="SSH_PORT_NUMBER"&gt;42156&lt;/test_value&gt;
        &lt;/test_values&gt;
    &lt;/example&gt;
&lt;/examples&gt;</pre>
        <h6>Element: actions</h6>
        <h6 oldrole="simplesect">Location</h6>
        <p oldrole="para">/<a href="">patterndb</a>/<a href="">ruleset</a>/<i oldrole="emphasis" role="bold">actions</i></p>
        <h6 oldrole="simplesect">Description</h6>
        <p oldrole="para">OPTIONAL — A container element for actions that are performed if a message is recognized by the pattern. For details on actions, see <MadCap:xref href="patterndb-triggers-actions.htm#patterndb-triggers-actions"></MadCap:xref>.</p>
        <h6 oldrole="simplesect">Attributes</h6>
        <p oldrole="para">N/A</p>
        <h6 oldrole="simplesect">Children</h6>
        <ul oldrole="itemizedlist">
            <li oldrole="listitem">
                <p oldrole="para"><a href=""><i oldrole="emphasis" role="bold">action</i></a>
                </p>
            </li>
        </ul>
        <h6 oldrole="simplesect">Example</h6>
        <MadCap:snippetBlock src="../../shared/chunk/example-patterndb-actions.htm">
        </MadCap:snippetBlock>
        <h6>Element: action</h6>
        <h6 oldrole="simplesect">Location</h6>
        <p oldrole="para">/<a href="">patterndb</a>/<a href="">ruleset</a>/<a href="">actions</a>/<i oldrole="emphasis" role="bold">action</i></p>
        <h6 oldrole="simplesect">Description</h6>
        <p oldrole="para">OPTIONAL — A container element describing an action that is performed when a message matching the rule is received.</p>
        <h6 oldrole="simplesect">Attributes</h6>
        <ul oldrole="itemizedlist">
            <li oldrole="listitem">
                <MadCap:keyword term="condition">
                </MadCap:keyword>
                <MadCap:keyword term="$(context-length)">
                </MadCap:keyword>
                <MadCap:keyword term="actions:['context-length']">
                </MadCap:keyword>
                <p oldrole="para"><i oldrole="emphasis">condition</i>: A syslog-ng filter expression. The action is performed only if the message matches the filter. The filter can include macros and name-value pairs extracted from the message. When using actions together with message-correlation, you can also use the <span class="Code" oldrole="parameter">$(context-length)</span> macro, which returns the number of messages in the current context. For example, this can be used to determine if the expected number of messages has arrived to the context: <span class="Code" oldrole="parameter">condition='"$(context-length)" &gt;= "5"'</span></p>
            </li>
            <li oldrole="listitem">
                <MadCap:keyword term="rate">
                </MadCap:keyword>
                <p oldrole="para"><i oldrole="emphasis">rate</i>: Specifies maximum how many messages should be generated in the specified time period in the following format: <span class="Code" oldrole="userinput">&lt;number-of-messages&gt;/&lt;period-in-seconds&gt;</span>. For example: <span class="Code" oldrole="userinput">1/60</span> allows 1 message per minute. Rates apply within the scope of the context, that is, if <span class="Code" oldrole="userinput">context-scope="host"</span> and <span class="Code" oldrole="userinput">rate="1/60"</span>, then maximum one message is generated per minute for every host that sends a log message matching the rule. Excess messages are dropped. Note that when applying the rate to the generated messages, <MadCap:variable name="General.abbrev"></MadCap:variable> uses the timestamps of the log messages, similarly to calculating the <span class="Code" oldrole="parameter">context-timeout</span>. That way <span class="Code" oldrole="userinput">rate</span> is applied correctly even if the log messages are processed offline.</p>
            </li>
            <li oldrole="listitem">
                <MadCap:keyword term="trigger">
                </MadCap:keyword>
                <p oldrole="para"><i oldrole="emphasis">trigger</i>: Specifies when the action is executed. The <span class="Code" oldrole="parameter">trigger</span> attribute has the following possible values:</p>
                <ul oldrole="itemizedlist">
                    <li oldrole="listitem">
                        <MadCap:keyword term="match">
                        </MadCap:keyword>
                        <p oldrole="para"><i oldrole="emphasis">match</i>: Execute the action immediately when a message matching the rule is received.</p>
                    </li>
                    <li oldrole="listitem">
                        <MadCap:keyword term="timeout">
                        </MadCap:keyword>
                        <p oldrole="para"><i oldrole="emphasis">timeout</i>: Execute the action when the correlation timer (<a href="reference-patterndb-schemes.htm"><span class="Code" oldrole="parameter">context-timeout</span></a>) of the pattern database rule expires. This is available only if actions are used together with correlating messages.</p>
                    </li>
                </ul>
            </li>
        </ul>
        <h6 oldrole="simplesect">Children</h6>
        <ul oldrole="itemizedlist">
            <li oldrole="listitem">
                <p oldrole="para"><a href=""><i oldrole="emphasis" role="bold">create-context</i></a>
                </p>
            </li>
            <li oldrole="listitem">
                <MadCap:keyword term="message">
                </MadCap:keyword>
                <p oldrole="para"><i oldrole="emphasis" role="bold">message</i>: A container element storing the message to be sent when the action is executed. Currently <MadCap:variable name="General.abbrev"></MadCap:variable> sends these messages to the <span class="Code" oldrole="parameter">internal()</span> destination.</p>
                <ul oldrole="itemizedlist">
                    <li oldrole="listitem">
                        <MadCap:keyword term="inherit-mode">
                        </MadCap:keyword>
                        <MadCap:snippetBlock src="../../shared/chunk/option-inherit-mode.htm">
                        </MadCap:snippetBlock>
                        <p oldrole="para">For details on the message context, see <MadCap:xref href="patterndb-correlation.htm#patterndb-correlation"></MadCap:xref> and <MadCap:xref href="patterndb-actions-correlation.htm#patterndb-actions-correlation"></MadCap:xref>. For details on triggering messages, see <MadCap:xref href="patterndb-triggers-actions.htm#patterndb-triggers-actions"></MadCap:xref></p>
                        <p oldrole="para">This option is available in <MadCap:variable name="General.abbrev"></MadCap:variable> <MadCap:conditionaltext MadCap:conditions="syslogngPE.ose">3.8</MadCap:conditionaltext><MadCap:conditionaltext MadCap:conditions="pe">7.0</MadCap:conditionaltext> and later.</p>
                    </li>
                </ul>
                <ul oldrole="itemizedlist">
                    <li oldrole="listitem">
                        <MadCap:keyword term="inherit-properties">
                        </MadCap:keyword>
                        <p oldrole="para"><i oldrole="emphasis">inherit-properties</i>: This attribute is deprecated. Use the <span class="Code" oldrole="parameter">inherit-mode</span> attribute instead.</p>
                        <p oldrole="para">If set to <span class="Code" oldrole="userinput">TRUE</span>, the original message that triggered the action is cloned, including its name-value pairs and tags.</p>
                        <p oldrole="para">If set to <span class="Code" oldrole="parameter">context</span>, <MadCap:variable name="General.abbrev"></MadCap:variable> collects every name-value pair from each message stored in the context, and includes them in the generated message. If a name-value pair appears in multiple messages of the context, the value in the latest message will be used. Note that tags are not merged, the generated message will inherit the tags assigned to the last message of the context.</p>
                        <p oldrole="para">For details on the message context, see <MadCap:xref href="patterndb-correlation.htm#patterndb-correlation"></MadCap:xref> and <MadCap:xref href="patterndb-actions-correlation.htm#patterndb-actions-correlation"></MadCap:xref>. For details on triggering messages, see <MadCap:xref href="patterndb-triggers-actions.htm#patterndb-triggers-actions"></MadCap:xref></p>
                        <p condition="pe" oldrole="para">This option is available in <MadCap:variable name="General.abbrev"></MadCap:variable> 5.3.2 and later.</p>
                    </li>
                </ul>
            </li>
            <li oldrole="listitem">
                <MadCap:keyword term="values — action">
                </MadCap:keyword>
                <p oldrole="para"><i oldrole="emphasis" role="bold">values</i>: A container element for values and fields that are used to create the message generated by the action.</p>
                <ul oldrole="itemizedlist">
                    <li oldrole="listitem">
                        <MadCap:keyword term="value — action">
                        </MadCap:keyword>
                        <p oldrole="para"><i oldrole="emphasis" role="bold">value</i>: Sets the value of the message field specified in the <span class="Code" oldrole="parameter">name</span> attribute of the element. For example, to specify the body of the generated message, use the following syntax:</p><pre class="Code" oldrole="synopsis">&lt;value name="MESSAGE"&gt;A log message matched rule number $.classifier.rule_id&lt;/value&gt;</pre>
                        <p oldrole="para">Note that currently it is not possible to add DATE, FACILITY, or SEVERITY fields to the message.</p>
                        <p oldrole="para">When the action is used together with message correlation, the <MadCap:variable name="General.abbrev"></MadCap:variable> application automatically adds fields to the message based on the <span class="Code" oldrole="parameter">context-scope</span> parameter. For example, using <span class="Code" oldrole="userinput">context-scope="process"</span> automatically fills the HOST, PROGRAM, and PID fields of the generated message.</p>
                    </li>
                    <li oldrole="listitem">
                        <MadCap:keyword term="name — value — action">
                        </MadCap:keyword>
                        <p oldrole="para"><i oldrole="emphasis">name</i>: Name of the message field set by the <span class="Code" oldrole="parameter">value</span> element.</p>
                    </li>
                </ul>
            </li>
        </ul>
        <h6 oldrole="simplesect">Example</h6>
        <MadCap:snippetBlock src="../../shared/chunk/example-patterndb-actions.htm">
        </MadCap:snippetBlock>
        <h6>Element: create-context</h6>
        <h6 oldrole="simplesect">Location</h6>
        <p oldrole="para">/<a href="">patterndb</a>/<a href="">ruleset</a>/<a href="">actions</a>/<a href="">action</a>/<i oldrole="emphasis" role="bold">create-context</i></p>
        <h6 oldrole="simplesect">Description</h6>
        <p oldrole="para">OPTIONAL — Creates a new correlation context from the current message and its associated context. This can be used to "split" a context.</p>
        <p oldrole="para">Available in <MadCap:variable name="General.abbrev"></MadCap:variable> version <MadCap:conditionaltext MadCap:conditions="syslogngPE.ose">3.8</MadCap:conditionaltext><MadCap:conditionaltext MadCap:conditions="pe">7</MadCap:conditionaltext> and later.</p>
        <h6 oldrole="simplesect">Attributes</h6>
        <MadCap:keyword term="context-id">
        </MadCap:keyword>
        <MadCap:keyword term="context-scope">
        </MadCap:keyword>
        <MadCap:keyword term="context-timeout">
        </MadCap:keyword>
        <ul oldrole="itemizedlist">
            <MadCap:snippetBlock src="../../shared/chunk/patterndb-context-attributes.htm">
            </MadCap:snippetBlock>
        </ul>
        <h6 oldrole="simplesect">Children</h6>
        <ul oldrole="itemizedlist">
            <li oldrole="listitem">
                <MadCap:keyword term="message">
                </MadCap:keyword>
                <p oldrole="para"><i oldrole="emphasis" role="bold">message</i>: A container element storing the message that is added to the new context when the action is executed.</p>
                <ul oldrole="itemizedlist">
                    <li oldrole="listitem">
                        <MadCap:keyword term="inherit-mode">
                        </MadCap:keyword>
                        <MadCap:snippetBlock src="../../shared/chunk/option-inherit-mode.htm">
                        </MadCap:snippetBlock>
                        <p oldrole="para">For details on the message context, see <MadCap:xref href="patterndb-correlation.htm#patterndb-correlation"></MadCap:xref> and <MadCap:xref href="patterndb-actions-correlation.htm#patterndb-actions-correlation"></MadCap:xref>. For details on triggering messages, see <MadCap:xref href="patterndb-triggers-actions.htm#patterndb-triggers-actions"></MadCap:xref></p>
                    </li>
                </ul>
            </li>
        </ul>
        <h6 oldrole="simplesect">Example</h6>
        <MadCap:snippetBlock src="../../shared/chunk/example-create-context-action.htm">
        </MadCap:snippetBlock>
        <h6>Element: tags</h6>
        <h6 oldrole="simplesect">Location</h6>
        <p oldrole="para">/<a href="">patterndb</a>/<a href="">ruleset</a>/<i oldrole="emphasis" role="bold">tags</i></p>
        <h6 oldrole="simplesect">Description</h6>
        <p oldrole="para">OPTIONAL — An element containing custom keywords (tags) about the messages matching the patterns. The tags can be used to label specific events (for example user logons). It is also possible to filter on these tags later (for details, see <MadCap:xref href="tagging-messages.htm#tagging-messages"></MadCap:xref>). Starting with <MadCap:variable name="General.product"></MadCap:variable> 3.2, the list of tags assigned to a message can be referenced with the <span class="Code" oldrole="parameter">${TAGS}</span> macro.</p>
        <h6 oldrole="simplesect">Attributes</h6>
        <p oldrole="para">N/A</p>
        <h6 oldrole="simplesect">Children</h6>
        <ul oldrole="itemizedlist">
            <li oldrole="listitem">
                <MadCap:keyword term="tag — rule">
                </MadCap:keyword>
                <p oldrole="para"><i oldrole="emphasis" role="bold">tag</i>: OPTIONAL — A keyword or tags applied to messages matching the rule.</p>
            </li>
        </ul>
        <h6 oldrole="simplesect">Example</h6><pre class="Code" oldrole="synopsis">&lt;tags&gt;&lt;tag&gt;UserLogin&lt;/tag&gt;&lt;/tags&gt;</pre>
    </body>
</html>