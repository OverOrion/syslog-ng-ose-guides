<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head>
    </head>
    <body name="source-windowsevent" oldrole="section">
        <h1 name="source-windowsevent"><span class="Code" oldrole="parameter">windowsevent</span>: Collecting Windows event logs</h1>
        <MadCap:keyword term="source drivers:[&lt;span class=&quot;Code&quot; oldrole=&quot;parameter&quot;&gt;windowsevent()&lt;/span&gt;, ' driver']">
        </MadCap:keyword>
        <p oldrole="para">Event log messages collected by the <MadCap:variable name="General.wec"></MadCap:variable> for <MadCap:variable name="General.abbrev"></MadCap:variable> use this special source. To collect Windows event log messages, include this source in one of your source statements.</p>
        <p oldrole="para">The <MadCap:variable name="General.wec"></MadCap:variable> tool for <MadCap:variable name="General.abbrev"></MadCap:variable> collects the log messages of Windows-based hosts in Unix datagram sockets, and then forwards them to a <MadCap:variable name="General.abbrev"></MadCap:variable> server over HTTPS (using TLS encryption and mutual authentication). <MadCap:variable name="General.abbrev"></MadCap:variable> reads the log messages using the <span class="Code" oldrole="parameter">windowsevent()</span> source, and then parses the logs into key-value paris using the <a href="xml-parser.htm">XML parser</a>.</p>
        <p oldrole="para">For more information, see <a targetdoc="syslog-ng-pe-wec-guide" oldrole="olink"></a>.</p>
        <h6 oldrole="formalpara">Declaration:</h6><pre class="Code" oldrole="synopsis">source s_wec {
    windowsevent(
      prefix(".windowsevent.")
      unix-domain-socket("`syslog-ng-root`/var/run/wec.sock")
    );
};</pre>
        <p>Starting with version 7.0.13, the <MadCap:variable name="General.abbrev"></MadCap:variable> <span class="Code" oldrole="parameter">windowsevent()</span> source can process XML arrays and make the elements of the arrays available as name-value pairs. For example, the following XML array becomes available as name-value pairs:</p>
        <pre class="Code">&lt;Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  &lt;System>
    &lt;EventID>5059&lt;/EventID>
  &lt;/System>
  &lt;EventData>
    &lt;Data Name="SubjectUserSid">S-1-5-18&lt;/Data>
    &lt;Data Name="SubjectUserName">WIN-K1678A68SQ6$&lt;/Data>
  &lt;/EventData></pre>
        <p>From the previous example, the following name-value pairs become available: <span class="Code" oldrole="userinput">${Event.System.EventID}</span> (5059), <span class="Code" oldrole="userinput">${Event.EventData.SubjectUserSid}</span> (S-1-5-18), <span class="Code" oldrole="userinput">${Event.EventData.SubjectUserName}</span> (WIN-K1678A68SQ6$).</p>
    </body>
</html>