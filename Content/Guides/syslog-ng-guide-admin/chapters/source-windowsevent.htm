<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head>
        <link href="../../../Resources/TableStyles/NoteTable_Blue_DoNotEdit.css" rel="stylesheet" MadCap:stylesheetType="table" />
    </head>
    <body name="source-windowsevent" oldrole="section">
        <h1 name="source-windowsevent"><span class="Code" oldrole="parameter">windowsevent</span>: Collecting Windows event logs</h1>
        <MadCap:keyword term="source drivers:[&lt;span class=&quot;Code&quot; oldrole=&quot;parameter&quot;&gt;windowsevent()&lt;/span&gt;, ' driver']">
        </MadCap:keyword>
        <p>Event log messages collected by the <MadCap:variable name="General.wec"></MadCap:variable> for <MadCap:variable name="General.abbrev"></MadCap:variable> use this special source. To collect Windows event log messages, include this source in one of your source statements.</p>
        <p>The <MadCap:variable name="General.wec" /> tool for <MadCap:variable name="General.abbrev" /> collects the log messages of Windows-based hosts in Unix datagram sockets, and then forwards them to a <MadCap:variable name="General.abbrev" /> server over HTTPS (using TLS encryption and mutual authentication). <MadCap:variable name="General.abbrev" /> reads the log messages using the <span class="Code" oldrole="parameter">windowsevent()</span> source, and then parses the logs into key-value paris using the <a href="xml-parser.htm">XML parser</a>. </p>
        <p>The XML parser uses  the list-handling functionality to handle lists in the XML. Note that  you cannot disable the  list-handling functionality for the <span class="Code" oldrole="parameter">windowsevent()</span> source.</p>
        <p>For more information, see <a targetdoc="syslog-ng-pe-wec-guide" oldrole="olink"></a>.</p>
        <h6 oldrole="formalpara">Declaration:</h6><pre class="Code" oldrole="synopsis">source s_wec {
    windowsevent(
      prefix(".windowsevent.")
      unix-domain-socket("`syslog-ng-root`/var/run/wec.sock")
    );
};</pre>
        <p>Starting with version 7.0.13, the <MadCap:variable name="General.abbrev"></MadCap:variable> <span class="Code" oldrole="parameter">windowsevent()</span> source can process XML arrays and make the elements of the arrays available as name-value pairs. For example, the following XML array becomes available as name-value pairs:</p><pre class="Code">&lt;Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event"&gt;
  &lt;System&gt;
    &lt;EventID&gt;5059&lt;/EventID&gt;
  &lt;/System&gt;
  &lt;EventData&gt;
    &lt;Data Name="SubjectUserSid"&gt;S-1-5-18&lt;/Data&gt;
    &lt;Data Name="SubjectUserName"&gt;WIN-K1678A68SQ6$&lt;/Data&gt;
  &lt;/EventData&gt;</pre>
        <p>From the previous example, the following name-value pairs become available: <span class="Code" oldrole="userinput">${Event.System.EventID}</span> (5059), <span class="Code" oldrole="userinput">${Event.EventData.SubjectUserSid}</span> (S-1-5-18), <span class="Code" oldrole="userinput">${Event.EventData.SubjectUserName}</span> (WIN-K1678A68SQ6$).</p>
        <table cellspacing="0" class="TableStyle-NoteTable_Blue_DoNotEdit" oldrole="note" style="width: 100%;mc-table-style: url('../../../Resources/TableStyles/NoteTable_Blue_DoNotEdit.css');">
            <col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column1" style="width: 0.3in;">
            </col>
            <col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column2">
            </col>
            <tbody>
                <tr class="TableStyle-NoteTable_Blue_DoNotEdit-Body-Body1">
                    <td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyB-Column1-Body1">
                        <p>
                            <img src="../../../Resources/Images/Common/note.png" />
                        </p>
                    </td>
                    <td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyA-Column2-Body1"><span class="AllNoteStyles">NOTE: </span>
                        <p>The name-value pairs are only created from EventData.Data xml paths, that is, only for &lt;Data&gt; tags that are the children of an &lt;EventData&gt; tag and have the Name attribute.</p>
                        <p>If the array-like structure is not a Data tag under EventData tag, or it misses the Name attribute, then the regular XML-parser logic is used.</p>
                    </td>
                </tr>
            </tbody>
        </table>
    </body>
</html>