<?xml version="1.0" encoding="utf-8"?>
<!-- FIXME jumplist -->
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head>
        <link href="../../../Resources/TableStyles/NoteTable_Yellow_DoNotEdit.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <link href="../../../Resources/TableStyles/RuledTableWithHeading_DoNotEdit.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <link href="../../../Resources/TableStyles/NoteTable_Blue_DoNotEdit.css" rel="stylesheet" MadCap:stylesheetType="table" />
    </head>
    <body name="tlsoptions" oldrole="section">
        <h1 name="tlsoptions">TLS options</h1>
        <MadCap:keyword term="TLS:['reference']">
        </MadCap:keyword>
        <p oldrole="para">The syslog-ng application can encrypt incoming and outgoing syslog message flows using TLS if you use the <span class="Code" oldrole="parameter">network()</span> or <span class="Code" oldrole="parameter">syslog()</span> drivers.</p>
        <table cellspacing="0" class="TableStyle-NoteTable_Blue_DoNotEdit" oldrole="note" style="width: 100%;mc-table-style: url('../../../Resources/TableStyles/NoteTable_Blue_DoNotEdit.css');">
            <col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column1" style="width: 0.3in;">
            </col>
            <col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column2">
            </col>
            <tbody>
                <tr class="TableStyle-NoteTable_Blue_DoNotEdit-Body-Body1">
                    <td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyB-Column1-Body1">
                        <p>
                            <img src="../../../Resources/Images/Common/note.png" />
                        </p>
                    </td>
                    <td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyA-Column2-Body1"><span class="AllNoteStyles">NOTE: </span>
                        <p oldrole="para">The format of the TLS connections used by syslog-ng is similar to using syslog-ng and stunnel, but the source IP information is not lost.</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <p oldrole="para">To encrypt connections, use the <span class="Code" oldrole="parameter">transport("tls")</span> and <span class="Code" oldrole="parameter">tls()</span> options in the source and destination statements.</p>
        <p oldrole="para">The tls() option can include the following settings:</p>
        <MadCap:snippetBlock src="../../shared/chunk/option-destination-tls-ca-dir.htm">
        </MadCap:snippetBlock>
        <MadCap:snippetBlock src="../../shared/chunk/option-destination-tls-cert-file.htm">
        </MadCap:snippetBlock>
        <MadCap:snippetBlock src="../../shared/chunk/option-destination-tls-cipher-suite.htm">
        </MadCap:snippetBlock>
        <h6 name="tls-options-crl-dir" oldrole="simplesect">crl-dir()</h6>
        <MadCap:keyword term="crl-dir()">
        </MadCap:keyword>
        <MadCap:keyword term="crl_dir()">
        </MadCap:keyword>
        <table cellspacing="0" class="TableStyle-RuledTableWithHeading_DoNotEdit" colsep="0" frame="topbot" rowsep="0" style="width: 100%;mc-table-style: url('../../../Resources/TableStyles/RuledTableWithHeading_DoNotEdit.css');">
            <tbody>
                <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                    <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyE-Column1-Body1">Accepted values: 

                            </td>
                    <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyD-Column1-Body1">Directory name</td>
                </tr>
                <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                    <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyB-Column1-Body1">Default: 

                            </td>
                    <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyA-Column1-Body1">none</td>
                </tr>
            </tbody>
            <col class="TableStyle-RuledTableWithHeading_DoNotEdit-Column-Column1" style="width: 0.3in;">
            </col>
        </table>
        <p oldrole="para"><i oldrole="emphasis" role="bold">Description:</i> Name of a directory that contains the Certificate Revocation Lists for trusted CAs. Similarly to <span class="Code" oldrole="parameter">ca-dir()</span> files, use the 32-bit hash of the name of the issuing CAs as filenames. The extension of the files must be <span class="Code" oldrole="userinput">.r0</span>.</p>
        <p oldrole="para">If the <span class="Code" oldrole="parameter">crl-dir()</span> is set, and the peer certificate has been revoked, <MadCap:variable name="General.abbrev"></MadCap:variable> rejects the connection. If the peer certificate has not been revoked, or <MadCap:variable name="General.abbrev"></MadCap:variable> cannot access the CRL, <MadCap:variable name="General.abbrev"></MadCap:variable> accepts the connection.</p>
        <MadCap:snippetBlock src="../../shared/chunk/option-tls-option-dhparam-file.htm">
        </MadCap:snippetBlock>
        <h6 name="tls-options-ecdh-curve-list" oldrole="simplesect">ecdh-curve-list()</h6>
        <MadCap:keyword term="ecdh-curve-list()">
        </MadCap:keyword>
        <MadCap:keyword term="ecdh-curve-list()">
        </MadCap:keyword>
        <table cellspacing="0" class="TableStyle-RuledTableWithHeading_DoNotEdit" colsep="0" frame="topbot" rowsep="0" style="width: 100%;mc-table-style: url('../../../Resources/TableStyles/RuledTableWithHeading_DoNotEdit.css');">
            <tbody>
                <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                    <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyE-Column1-Body1">Accepted values: 

                            </td>
                    <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyD-Column1-Body1"> string [colon-separated list]</td>
                </tr>
                <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                    <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyB-Column1-Body1">Default: 

                            </td>
                    <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyA-Column1-Body1">none </td>
                </tr>
            </tbody>
            <col class="TableStyle-RuledTableWithHeading_DoNotEdit-Column-Column1" style="width: 0.3in;">
            </col>
        </table>
        <p oldrole="para"><i oldrole="emphasis" role="bold">Description:</i> A colon-separated list that specifies the curves that are permitted in the connection when using Elliptic Curve Cryptography (ECC).</p>
        <p oldrole="para">The <MadCap:variable name="General.abbrev"></MadCap:variable> application automatically uses the highest preference curve that both peers support. If not specified, the list includes every supported curve.</p>
        <p oldrole="para">Example:</p><pre class="Code" oldrole="synopsis">ecdh-curve-list("prime256v1:secp384r1")</pre>
        <p condition="pe" oldrole="para">The <MadCap:variable name="General.product"></MadCap:variable> application currently supports the following curves: <span class="Code" oldrole="userinput">sect163k1</span>, <span class="Code" oldrole="userinput">sect163r1</span>, <span class="Code" oldrole="userinput">sect163r2</span>, <span class="Code" oldrole="userinput">sect193r1</span>, <span class="Code" oldrole="userinput">sect193r2,</span>, <span class="Code" oldrole="userinput">sect233k1</span>, <span class="Code" oldrole="userinput">sect233r1</span>, <span class="Code" oldrole="userinput">sect239k1</span>, <span class="Code" oldrole="userinput">sect283k1</span>, <span class="Code" oldrole="userinput">sect283r1,</span>, <span class="Code" oldrole="userinput">sect409k1</span>, <span class="Code" oldrole="userinput">sect409r1</span>, <span class="Code" oldrole="userinput">sect571k1</span>, <span class="Code" oldrole="userinput">sect571r1</span>, <span class="Code" oldrole="userinput">secp160k1,</span>, <span class="Code" oldrole="userinput">secp160r1</span>, <span class="Code" oldrole="userinput">secp160r2</span>, <span class="Code" oldrole="userinput">secp192k1</span>, <span class="Code" oldrole="userinput">prime192v1</span>, <span class="Code" oldrole="userinput">secp224k1,</span>, <span class="Code" oldrole="userinput">secp224r1</span>, <span class="Code" oldrole="userinput">secp256k1</span>, <span class="Code" oldrole="userinput">prime256v1</span>, <span class="Code" oldrole="userinput">secp384r1</span>, <span class="Code" oldrole="userinput">secp521r1,</span>, <span class="Code" oldrole="userinput">brainpoolP256r1</span>, <span class="Code" oldrole="userinput">brainpoolP384r1</span>, <span class="Code" oldrole="userinput">brainpoolP512r1</span>.</p>
        <MadCap:snippetBlock src="../../shared/chunk/option-destination-tls-key-file.htm">
        </MadCap:snippetBlock>
        <MadCap:snippetBlock src="../../shared/chunk/option-destination-tls-key-file-password-protected.htm">
        </MadCap:snippetBlock>
        <h6 name="tls-options-peer-verify" oldrole="simplesect">peer-verify()</h6>
        <MadCap:keyword term="peer-verify()">
        </MadCap:keyword>
        <MadCap:keyword term="peer_verify()">
        </MadCap:keyword>
        <table cellspacing="0" class="TableStyle-RuledTableWithHeading_DoNotEdit" colsep="0" frame="topbot" rowsep="0" style="width: 100%;mc-table-style: url('../../../Resources/TableStyles/RuledTableWithHeading_DoNotEdit.css');">
            <tbody>
                <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                    <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyE-Column1-Body1">Accepted values: 

                            </td>
                    <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyD-Column1-Body1"><span class="Code" oldrole="userinput">optional-trusted</span> | <span class="Code" oldrole="userinput">optional-untrusted</span> | <span class="Code" oldrole="userinput">required-trusted</span> | <span class="Code" oldrole="userinput">required-untrusted</span></td>
                </tr>
                <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                    <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyB-Column1-Body1">Default: 

                            </td>
                    <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyA-Column1-Body1"><span class="Code" oldrole="userinput">required-trusted</span>
                    </td>
                </tr>
            </tbody>
            <col class="TableStyle-RuledTableWithHeading_DoNotEdit-Column-Column1" style="width: 0.3in;">
            </col>
        </table>
        <p oldrole="para"><i oldrole="emphasis" role="bold">Description:</i> Verification method of the peer, the four possible values is a combination of two properties of validation:</p>
        <ul oldrole="itemizedlist">
            <li oldrole="listitem">
                <p oldrole="para">whether the peer is required to provide a certificate (required or optional prefix), and</p>
            </li>
            <li oldrole="listitem">
                <p oldrole="para">whether the certificate provided needs to be valid or not.</p>
            </li>
        </ul>
        <p oldrole="para">The following table summarizes the possible options and their results depending on the certificate of the peer.</p>
        <table style="width: 100%;">
            <thead>
                <tr>
                    <th colspan="2" rowspan="2">
                        <p>
                        </p>
                    </th>
                    <th colspan="3">The remote peer has:</th>
                </tr>
                <tr>
                    <th> no certificate </th>
                    <th> invalid certificate </th>
                    <th> valid certificate </th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td rowspan="4"><i oldrole="emphasis" role="bold">Local peer-verify() setting</i>
                    </td>
                    <td><i oldrole="emphasis" role="bold">optional-untrusted</i>
                    </td>
                    <td> TLS-encryption </td>
                    <td> TLS-encryption </td>
                    <td> TLS-encryption </td>
                </tr>
                <tr>
                    <td><i oldrole="emphasis" role="bold">optional-trusted</i>
                    </td>
                    <td> TLS-encryption </td>
                    <td> rejected connection </td>
                    <td> TLS-encryption </td>
                </tr>
                <tr>
                    <td><i oldrole="emphasis" role="bold">required-untrusted</i>
                    </td>
                    <td> rejected connection </td>
                    <td> TLS-encryption </td>
                    <td> TLS-encryption </td>
                </tr>
                <tr>
                    <td><i oldrole="emphasis" role="bold">required-trusted</i>
                    </td>
                    <td> rejected connection </td>
                    <td> rejected connection </td>
                    <td> TLS-encryption </td>
                </tr>
            </tbody>
            <col style="width: 0.3in;">
            </col>
            <col style="width: 0.3in;">
            </col>
            <col style="width: 0.3in;">
            </col>
            <col style="width: 0.3in;">
            </col>
        </table>
        <MadCap:snippetBlock src="../../shared/chunk/option-destination-tls-peer-verify-notes.htm">
        </MadCap:snippetBlock>
        <h6 name="tls-options-ssl-options" oldrole="simplesect">ssl-options()</h6>
        <MadCap:keyword term="ssl-options()">
        </MadCap:keyword>
        <MadCap:keyword term="ssl_options()">
        </MadCap:keyword>
        <MadCap:keyword term="disable SSL">
        </MadCap:keyword>
        <MadCap:keyword term="disabling SSL">
        </MadCap:keyword>
        <MadCap:keyword term="disable TLS">
        </MadCap:keyword>
        <MadCap:keyword term="disabling TLS">
        </MadCap:keyword>
        <table cellspacing="0" class="TableStyle-RuledTableWithHeading_DoNotEdit" colsep="0" frame="topbot" rowsep="0" style="width: 100%;mc-table-style: url('../../../Resources/TableStyles/RuledTableWithHeading_DoNotEdit.css');">
            <tbody>
                <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                    <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyE-Column1-Body1">Accepted values: 

                            </td>
                    <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyD-Column1-Body1">comma-separated list of the following options: no-sslv2, no-sslv3, no-tlsv1, no-tlsv11, no-tlsv12, none</td>
                </tr>
                <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                    <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyB-Column1-Body1">Default: 

                            </td>
                    <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyA-Column1-Body1">no-sslv2</td>
                </tr>
            </tbody>
            <col class="TableStyle-RuledTableWithHeading_DoNotEdit-Column-Column1" style="width: 0.3in;">
            </col>
        </table>
        <p oldrole="para"><i oldrole="emphasis" role="bold">Description:</i> Sets the specified options of the SSL/TLS protocols. Currently, you can use it to disable specific protocol versions. Note that disabling a newer protocol version (for example, TLSv1.1) does not automatically disable older versions of the same protocol (for example, TLSv1.0). For example, use the following option to permit using only TLSv1.1 or newer:</p>
        <MadCap:keyword term="disable SSL">
        </MadCap:keyword><pre class="Code" oldrole="synopsis">ssl-options(no-sslv2, no-sslv3, no-tlsv1)</pre>
        <p oldrole="para">Using <span class="Code" oldrole="userinput">ssl-options(none)</span> means that <MadCap:variable name="General.abbrev"></MadCap:variable> does not specify any restrictions on the protocol used. However, in this case, the underlying OpenSSL library can restrict the available protocols, for example, certain OpenSSL versions automatically disable SSLv2.</p>
        <p oldrole="para">This option is available in <MadCap:variable name="General.abbrev"></MadCap:variable> <MadCap:conditionaltext MadCap:conditions="syslogngPE.ose">3.7</MadCap:conditionaltext><MadCap:conditionaltext MadCap:conditions="pe">7.0</MadCap:conditionaltext> and newer.</p>
        <div class="Example">
            <h6 oldrole="example">Example: Using <span class="Code" oldrole="parameter">ssl-options</span></h6>
            <p oldrole="para">The following destination explicitly disables SSL and TLSv1.0</p><pre class="Code" oldrole="synopsis">destination demo_tls_destination {
    network("172.16.177.147" port(6514)
    transport("tls")
    tls( ca-dir("/etc/syslog-ng/ca.d")
         key-file("/etc/syslog-ng/cert.d/clientkey.pem")
         cert-file("/etc/syslog-ng/cert.d/clientcert.pem")
         ssl-options(no-sslv2, no-sslv3, no-tlsv1) )
    ); };</pre>
        </div>
        <h6 name="tls-options-trusted-dn" oldrole="simplesect">trusted-dn()</h6>
        <MadCap:keyword term="trusted-dn()">
        </MadCap:keyword>
        <MadCap:keyword term="trusted_dn()">
        </MadCap:keyword>
        <table cellspacing="0" class="TableStyle-RuledTableWithHeading_DoNotEdit" colsep="0" frame="topbot" rowsep="0" style="width: 100%;mc-table-style: url('../../../Resources/TableStyles/RuledTableWithHeading_DoNotEdit.css');">
            <tbody>
                <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                    <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyE-Column1-Body1">Accepted values: 

                            </td>
                    <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyD-Column1-Body1">list of accepted distinguished names</td>
                </tr>
                <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                    <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyB-Column1-Body1">Default: 

                            </td>
                    <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyA-Column1-Body1">none</td>
                </tr>
            </tbody>
            <col class="TableStyle-RuledTableWithHeading_DoNotEdit-Column-Column1" style="width: 0.3in;">
            </col>
        </table>
        <p oldrole="para"><i oldrole="emphasis" role="bold">Description:</i> To accept connections only from hosts using certain certificates signed by the trusted CAs, list the distinguished names of the accepted certificates in this parameter. For example using <span class="Code" oldrole="userinput">trusted-dn("*, O=Example Inc, ST=Some-State, C=*")</span> will accept only certificates issued for the <span class="Code" oldrole="userinput">Example Inc</span> organization in <span class="Code" oldrole="userinput">Some-State</span> state.</p>
        <h6 name="tls-options-trusted-keys" oldrole="simplesect">trusted-keys()</h6>
        <MadCap:keyword term="trusted-keys()">
        </MadCap:keyword>
        <MadCap:keyword term="trusted_keys()">
        </MadCap:keyword>
        <table cellspacing="0" class="TableStyle-RuledTableWithHeading_DoNotEdit" colsep="0" frame="topbot" rowsep="0" style="width: 100%;mc-table-style: url('../../../Resources/TableStyles/RuledTableWithHeading_DoNotEdit.css');">
            <tbody>
                <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                    <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyE-Column1-Body1">Accepted values: 

                            </td>
                    <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyD-Column1-Body1">list of accepted SHA-1 fingerprints</td>
                </tr>
                <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                    <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyB-Column1-Body1">Default: 

                            </td>
                    <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyA-Column1-Body1">none</td>
                </tr>
            </tbody>
            <col class="TableStyle-RuledTableWithHeading_DoNotEdit-Column-Column1" style="width: 0.3in;">
            </col>
        </table>
        <p oldrole="para"><i oldrole="emphasis" role="bold">Description:</i> To accept connections only from hosts using certain certificates having specific SHA-1 fingerprints, list the fingerprints of the accepted certificates in this parameter. For example <span class="Code" oldrole="userinput">trusted-keys("SHA1:00:EF:ED:A4:CE:00:D1:14:A4:AB:43:00:EF:00:91:85:FF:89:28:8F", "SHA1:0C:42:00:3E:B2:60:36:64:00:E2:83:F0:80:46:AD:00:A8:9D:00:15")</span>.</p>
        <p oldrole="para">To find the fingerprint of a certificate, you can use the following command: <b oldrole="command">openssl x509 -in &lt;certificate-filename&gt; -sha1 -noout -fingerprint</b></p>
        <table cellspacing="0" class="TableStyle-NoteTable_Blue_DoNotEdit" oldrole="note" style="width: 100%;mc-table-style: url('../../../Resources/TableStyles/NoteTable_Blue_DoNotEdit.css');">
            <col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column1" style="width: 0.3in;">
            </col>
            <col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column2">
            </col>
            <tbody>
                <tr class="TableStyle-NoteTable_Blue_DoNotEdit-Body-Body1">
                    <td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyB-Column1-Body1">
                        <p>
                            <img src="../../../Resources/Images/Common/note.png" />
                        </p>
                    </td>
                    <td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyA-Column2-Body1"><span class="AllNoteStyles">NOTE: </span>
                        <p oldrole="para">When using the <span class="Code" oldrole="parameter">trusted-keys()</span> and <span class="Code" oldrole="parameter">trusted-dn()</span> parameters, note the following:</p>
                        <ul oldrole="itemizedlist">
                            <li oldrole="listitem">
                                <p oldrole="para">First, the <span class="Code" oldrole="parameter">trusted-keys()</span> parameter is checked. If the fingerprint of the peer is listed, the certificate validation is performed.</p>
                            </li>
                            <li oldrole="listitem">
                                <p oldrole="para">If the fingerprint of the peer is not listed in the <span class="Code" oldrole="parameter">trusted-keys()</span> parameter, the <span class="Code" oldrole="parameter">trusted-dn()</span> parameter is checked. If the DN of the peer is not listed in the <span class="Code" oldrole="parameter">trusted-dn()</span> parameter, the authentication of the peer fails and the connection is closed.</p>
                            </li>
                        </ul>
                    </td>
                </tr>
            </tbody>
        </table>
    </body>
</html>